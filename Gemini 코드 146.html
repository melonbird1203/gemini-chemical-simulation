<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°€ìƒ ì‹¤í—˜: ê¸ˆì†ì˜ ì´ì˜¨í™” ê²½í–¥ê³¼ ì‚°í™” í™˜ì›</title>
    <style>
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #50e3c2;
            --bg-color: #f4f7f6;
            --text-color: #333;
            --card-bg: #ffffff;
            --cu-color: #b87333; /* êµ¬ë¦¬ìƒ‰ */
            --ag-color: #e0e0e0; /* ì€ìƒ‰ */
            --zn-color: #9aa5b1; /* ì•„ì—°ìƒ‰ */
            --sol-blue: rgba(0, 119, 190, 0.6); /* êµ¬ë¦¬ ìš©ì•¡ */
            --sol-clear: rgba(220, 240, 255, 0.2); /* íˆ¬ëª… ìš©ì•¡ */
        }

        body {
            font-family: 'Pretendard', 'Malgun Gothic', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 { color: var(--primary-color); text-align: center; }
        .subtitle { text-align: center; color: #666; font-size: 0.9em; margin-bottom: 20px; }

        /* ë ˆì´ì•„ì›ƒ */
        .lab-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            max-width: 1000px;
            width: 100%;
            justify-content: center;
        }

        .control-panel, .result-panel, .micro-view {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            flex: 1;
            min-width: 300px;
        }

        /* ì‹¤í—˜ ì¥ì¹˜ (ë¹„ì»¤) */
        .experiment-stage {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 300px;
            position: relative;
            background: #eef2f5;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .beaker {
            width: 150px;
            height: 200px;
            border-bottom: 4px solid #aaa;
            border-left: 4px solid #aaa;
            border-right: 4px solid #aaa;
            border-radius: 0 0 10px 10px;
            position: relative;
            background: rgba(255,255,255,0.8);
            overflow: hidden;
        }

        .liquid {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 70%;
            background-color: var(--sol-clear);
            transition: background-color 3s ease;
            z-index: 1;
        }

        .metal-strip {
            width: 40px;
            height: 160px;
            background-color: #ccc;
            position: absolute;
            top: 10px; /* ë¹„ì»¤ ìœ„ì— ê±¸ì¹¨ */
            left: 50%;
            transform: translateX(-50%);
            border-radius: 5px;
            z-index: 2;
            transition: background-color 0.5s;
            box-shadow: inset 2px 2px 5px rgba(0,0,0,0.2);
        }

        .coating {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 0%;
            background-color: transparent;
            transition: height 3s ease, background-color 3s ease;
            z-index: 3;
            opacity: 0.9;
        }

        /* ì»¨íŠ¸ë¡¤ ìš”ì†Œ */
        select, button {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #ddd;
            font-size: 16px;
        }

        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
        }

        button:hover { background-color: #357abd; }
        button:disabled { background-color: #ccc; cursor: not-allowed; }

        .reset-btn { background-color: #e74c3c; }
        .reset-btn:hover { background-color: #c0392b; }

        /* ë§ˆì´í¬ë¡œ ë·° (ì…ì ëª¨í˜•) */
        .particle-box {
            width: 100%;
            height: 150px;
            background: #222;
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 0.8em;
        }
        
        .particle-info {
            position: absolute;
            top: 5px;
            left: 5px;
            color: #aaa;
        }

        .electron {
            width: 8px;
            height: 8px;
            background-color: #ffeb3b;
            border-radius: 50%;
            position: absolute;
            display: none;
            box-shadow: 0 0 5px #ffeb3b;
        }

        /* ê²°ê³¼ í…ìŠ¤íŠ¸ */
        .equation {
            font-family: 'Times New Roman', serif;
            font-style: italic;
            background: #f0f0f0;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            margin-top: 10px;
        }

        .feedback {
            margin-top: 15px;
            font-size: 0.95em;
            line-height: 1.5;
        }
        
        .safe-badge {
            display: inline-block;
            background: #2ecc71;
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.7em;
            margin-left: 5px;
        }

        /* í€´ì¦ˆ ì˜ì—­ */
        .quiz-section {
            display: none;
            margin-top: 20px;
            border-top: 2px dashed #ddd;
            padding-top: 20px;
        }

    </style>
</head>
<body>

    <h1>ğŸ§ª ê¸ˆì†ì˜ ì‚°í™”ì„± ë¹„êµ ì‹¤í—˜ì‹¤</h1>
    <div class="subtitle">ê³ ë“±í•™êµ í™”í•™â…¡: ì‚°í™” í™˜ì› ë°˜ì‘ê³¼ ì´ì˜¨í™” ê²½í–¥ì„± íƒêµ¬</div>

    <div class="lab-container">
        
        <div class="control-panel">
            <h3>1. ì‹¤í—˜ ì¡°ê±´ ì„¤ì •</h3>
            <p>ë¹„ì»¤ì— ë‹´ì„ ìš©ì•¡ê³¼ ê¸ˆì† ì¡°ê°ì„ ì„ íƒí•˜ì„¸ìš”.</p>
            
            <label for="solution">ğŸ§ª ê¸ˆì†ì—¼ ìˆ˜ìš©ì•¡ (ì „í•´ì§ˆ)</label>
            <select id="solution">
                <option value="none">ì„ íƒí•˜ì„¸ìš”</option>
                <option value="ZnSO4">í™©ì‚° ì•„ì—° (ZnSOâ‚„)</option>
                <option value="CuSO4">í™©ì‚° êµ¬ë¦¬(II) (CuSOâ‚„)</option>
                <option value="AgNO3">ì§ˆì‚° ì€ (AgNOâ‚ƒ)</option>
            </select>

            <label for="metal">ğŸ§± ê¸ˆì† ì¡°ê°</label>
            <select id="metal">
                <option value="none">ì„ íƒí•˜ì„¸ìš”</option>
                <option value="Zn">ì•„ì—° (Zn)</option>
                <option value="Cu">êµ¬ë¦¬ (Cu)</option>
                <option value="Ag">ì€ (Ag)</option>
            </select>

            <button id="start-btn" onclick="startExperiment()">ì‹¤í—˜ ì‹œì‘í•˜ê¸°</button>
            <button class="reset-btn" onclick="resetExperiment()">ë¹„ì»¤ ë¹„ìš°ê¸° (ì´ˆê¸°í™”)</button>

            <div style="margin-top: 20px; font-size: 0.85em; color: #555;">
                <strong>âš ï¸ ì•ˆì „ ê°€ì´ë“œ:</strong><br>
                â€¢ ì§ˆì‚° ì€ ìˆ˜ìš©ì•¡ì€ í”¼ë¶€ì— ë‹¿ìœ¼ë©´ ê²€ê²Œ ë³€í•©ë‹ˆë‹¤.<br>
                â€¢ ê°€ìƒ ì‹¤í—˜ì´ë¯€ë¡œ ì•ˆì „í•˜ê²Œ ê´€ì°°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ <span class="safe-badge">SAFE</span>
            </div>
        </div>

        <div class="control-panel" style="flex: 1.5;">
            <h3>2. ì‹¤í—˜ ê´€ì°°</h3>
            <div class="experiment-stage">
                <div class="beaker">
                    <div class="liquid" id="liquid-display"></div>
                    <div class="metal-strip" id="metal-display">
                        <div class="coating" id="coating-display"></div>
                    </div>
                </div>
            </div>
            
            <div class="micro-view">
                <h4>ğŸ”¬ ì…ì í™•ëŒ€ê²½ (ì „ì ì´ë™)</h4>
                <div class="particle-box" id="particle-view">
                    <div class="particle-info">ì‹¤í—˜ì„ ì‹œì‘í•˜ë©´ ì „ìì˜ ì´ë™ì´ ë³´ì…ë‹ˆë‹¤.</div>
                    </div>
            </div>
        </div>

        <div class="result-panel">
            <h3>3. ê²°ê³¼ ë° í•´ì„</h3>
            <div id="result-text">
                ì‹¤í—˜ ì¡°ê±´ì„ ì„ íƒí•˜ê³  ì‹œì‘ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.
            </div>
            
            <div class="quiz-section" id="quiz-area">
                <h4>ğŸ“ ì´í•´ë„ í™•ì¸ í€´ì¦ˆ</h4>
                <p id="quiz-question"></p>
                <div id="quiz-options"></div>
                <p id="quiz-feedback" style="font-weight: bold;"></p>
            </div>
        </div>

    </div>

    <script>
        // ë°ì´í„° ë² ì´ìŠ¤
        const materials = {
            metals: {
                Zn: { name: "ì•„ì—°", color: "#9aa5b1", reactivity: 3 },
                Cu: { name: "êµ¬ë¦¬", color: "#b87333", reactivity: 2 },
                Ag: { name: "ì€", color: "#e0e0e0", reactivity: 1 }
            },
            solutions: {
                ZnSO4: { name: "í™©ì‚° ì•„ì—°", color: "rgba(220, 240, 255, 0.2)", ion: "Zn", reactivity: 3 }, // íˆ¬ëª…
                CuSO4: { name: "í™©ì‚° êµ¬ë¦¬(II)", color: "rgba(0, 119, 190, 0.6)", ion: "Cu", reactivity: 2 }, // íŒŒë‘
                AgNO3: { name: "ì§ˆì‚° ì€", color: "rgba(220, 240, 255, 0.2)", ion: "Ag", reactivity: 1 } // íˆ¬ëª…
            }
        };

        let currentMetal = null;
        let currentSol = null;
        let isReacting = false;

        function startExperiment() {
            const metalKey = document.getElementById('metal').value;
            const solKey = document.getElementById('solution').value;

            if (metalKey === "none" || solKey === "none") {
                alert("ê¸ˆì†ê³¼ ìˆ˜ìš©ì•¡ì„ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”!");
                return;
            }

            // ì´ˆê¸°í™”
            resetVisuals();
            document.getElementById('start-btn').disabled = true;

            currentMetal = materials.metals[metalKey];
            currentSol = materials.solutions[solKey];

            // 1. ì´ˆê¸° ìƒíƒœ ì„¸íŒ…
            const liquid = document.getElementById('liquid-display');
            const metalStrip = document.getElementById('metal-display');
            
            liquid.style.backgroundColor = currentSol.color;
            metalStrip.style.backgroundColor = currentMetal.color;

            // 2. ë°˜ì‘ ì—¬ë¶€ íŒë‹¨ (ê¸ˆì†ì˜ ì´ì˜¨í™” ê²½í–¥ì´ ìš©ì•¡ ì† ì´ì˜¨ë³´ë‹¤ í¬ë©´ ë°˜ì‘)
            // Zn(3) > Cu(2) > Ag(1)
            const metalReactivity = currentMetal.reactivity;
            const ionReactivity = currentSol.reactivity;

            // ê°™ì€ ê¸ˆì†ì´ë©´ ë°˜ì‘ ì•ˆí•¨
            if (metalKey === currentSol.ion) {
                displayResult(false, metalKey, solKey, true);
                return;
            }

            if (metalReactivity > ionReactivity) {
                // ë°˜ì‘ ë°œìƒ!
                isReacting = true;
                runReactionAnimation(metalKey, solKey);
                displayResult(true, metalKey, solKey, false);
                startParticleAnimation(true, metalKey, currentSol.ion);
            } else {
                // ë°˜ì‘ ì—†ìŒ
                isReacting = false;
                displayResult(false, metalKey, solKey, false);
                startParticleAnimation(false);
            }
        }

        function runReactionAnimation(metalKey, solKey) {
            const liquid = document.getElementById('liquid-display');
            const coating = document.getElementById('coating-display');

            // 1. ìš©ì•¡ ìƒ‰ ë³€í™” ì‹œë®¬ë ˆì´ì…˜
            setTimeout(() => {
                if (solKey === "CuSO4") {
                    // êµ¬ë¦¬ ì´ì˜¨ì´ ì‚¬ë¼ì§€ë¯€ë¡œ íˆ¬ëª…í•´ì§
                    liquid.style.backgroundColor = "rgba(220, 240, 255, 0.2)"; 
                } else if (solKey === "AgNO3" && metalKey === "Cu") {
                    // êµ¬ë¦¬ê°€ ë…¹ì•„ë‚˜ì˜¤ë¯€ë¡œ íŒŒë—ê²Œ ë³€í•¨
                    liquid.style.backgroundColor = "rgba(0, 119, 190, 0.6)";
                } else if (solKey === "AgNO3" && metalKey === "Zn") {
                    // ì•„ì—°ì€ ë¬´ìƒ‰ì´ë¯€ë¡œ ìƒ‰ ë³€í™” ì—†ìŒ (íˆ¬ëª… ìœ ì§€)
                }
            }, 500);

            // 2. ê¸ˆì† í‘œë©´ ì„ì¶œ ì‹œë®¬ë ˆì´ì…˜
            setTimeout(() => {
                let coatingColor = "";
                // ìš©ì•¡ ì† ì´ì˜¨ì´ ê¸ˆì†ì´ ë˜ì–´ ë‹¬ë¼ë¶™ìŒ
                if (solKey === "CuSO4") coatingColor = materials.metals.Cu.color; // ë¶‰ì€ êµ¬ë¦¬ ì„ì¶œ
                if (solKey === "AgNO3") coatingColor = materials.metals.Ag.color; // ì€ë°±ìƒ‰ ì€ ì„ì¶œ
                
                coating.style.backgroundColor = coatingColor;
                coating.style.height = "80%"; // ê¸ˆì† í‘œë©´ì„ ë®ìŒ
            }, 500);
        }

        function startParticleAnimation(reacting, oxidMetal, redIon) {
            const container = document.getElementById('particle-view');
            container.innerHTML = ''; // ê¸°ì¡´ ë‚´ìš© ì‚­ì œ

            if (!reacting) {
                container.innerHTML = '<div style="text-align:center;">ì…ìë“¤ì˜ ì´ë™ì´ ì—†ìŠµë‹ˆë‹¤.<br>(í™”í•™ ë°˜ì‘ì´ ì¼ì–´ë‚˜ì§€ ì•ŠìŒ)</div>';
                return;
            }

            // ì• ë‹ˆë©”ì´ì…˜ ì„¤ëª…
            const info = document.createElement('div');
            info.className = 'particle-info';
            info.innerHTML = `ì „ì(eâ») ì´ë™: <b>${oxidMetal} â†’ ${redIon}</b>`;
            container.appendChild(info);

            // ì „ì ì• ë‹ˆë©”ì´ì…˜ ìƒì„± (ê°„ë‹¨í•œ CSS í‚¤í”„ë ˆì„ ëŒ€ì‹  JSë¡œ ë™ì  ìƒì„±)
            for(let i=0; i<10; i++) {
                setTimeout(() => {
                    createElectron(container);
                }, i * 500);
            }
        }

        function createElectron(container) {
            const el = document.createElement('div');
            el.className = 'electron';
            el.style.display = 'block';
            el.style.left = '20%'; // ê¸ˆì† ìœ„ì¹˜ (ê°€ì •)
            el.style.top = '50%';
            
            container.appendChild(el);

            // ì• ë‹ˆë©”ì´ì…˜
            const anim = el.animate([
                { transform: 'translate(0, 0)', opacity: 1 },
                { transform: 'translate(150px, 0)', opacity: 0 } // ìš©ì•¡ ìª½ìœ¼ë¡œ ì´ë™
            ], {
                duration: 1500,
                iterations: Infinity
            });
        }

        function displayResult(reacting, metal, solKey, isSame) {
            const resultBox = document.getElementById('result-text');
            const ion = materials.solutions[solKey].ion;
            
            let html = "";
            let equation = "";

            if (isSame) {
                html = `<p><strong>ë°˜ì‘ ì—†ìŒ:</strong> ê°™ì€ ê¸ˆì† ì„±ë¶„ì´ë¯€ë¡œ ë°˜ì‘ì´ ì¼ì–´ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>`;
            } else if (reacting) {
                // ì´ì˜¨í™” ê²½í–¥: Metal > Ion
                html = `<p style="color: blue;"><strong>ë°˜ì‘ ë°œìƒ! (ì‚°í™”-í™˜ì›)</strong></p>`;
                html += `<p>â€¢ <b>${materials.metals[metal].name}</b>ì´(ê°€) ì‚°í™”ë˜ì–´ ì „ìë¥¼ ìƒê³  ë…¹ì•„ë‚©ë‹ˆë‹¤.<br>`;
                html += `â€¢ ìˆ˜ìš©ì•¡ ì† <b>${materials.metals[ion].name} ì´ì˜¨</b>ì´ ì „ìë¥¼ ì–»ì–´ ê¸ˆì†ìœ¼ë¡œ ì„ì¶œë©ë‹ˆë‹¤.</p>`;
                
                // í™”í•™ ë°˜ì‘ì‹ ìƒì„±
                if (metal === 'Zn' && ion === 'Cu') {
                    equation = `$$ Zn(s) + Cu^{2+}(aq) \\rightarrow Zn^{2+}(aq) + Cu(s) $$`;
                } else if (metal === 'Cu' && ion === 'Ag') {
                    equation = `$$ Cu(s) + 2Ag^{+}(aq) \\rightarrow Cu^{2+}(aq) + 2Ag(s) $$`;
                } else if (metal === 'Zn' && ion === 'Ag') {
                    equation = `$$ Zn(s) + 2Ag^{+}(aq) \\rightarrow Zn^{2+}(aq) + 2Ag(s) $$`;
                }

                html += `<div class="equation">${equation}</div>`;
                html += `<div class="feedback">ğŸ’¡ <strong>í•´ì„¤:</strong> ${materials.metals[metal].name}ì´ ${materials.metals[ion].name}ë³´ë‹¤ ì´ì˜¨í™” ê²½í–¥(ë°˜ì‘ì„±)ì´ í¬ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</div>`;
                
                showQuiz(metal, ion, true);

            } else {
                html = `<p style="color: #d35400;"><strong>ë°˜ì‘ ì—†ìŒ</strong></p>`;
                html += `<p>ë„£ì–´ì¤€ ê¸ˆì†(${materials.metals[metal].name})ì´ ìˆ˜ìš©ì•¡ ì† ì´ì˜¨(${materials.metals[ion].name})ë³´ë‹¤ ì´ì˜¨í™” ê²½í–¥ì´ ì‘ìŠµë‹ˆë‹¤.</p>`;
                html += `<div class="feedback">ì „ìê°€ ì´ë™í•˜ì§€ ì•Šì•„ ì‚°í™” í™˜ì› ë°˜ì‘ì´ ì¼ì–´ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>`;
                
                showQuiz(metal, ion, false);
            }

            resultBox.innerHTML = html;
            // MathJaxê°€ ìˆë‹¤ë©´ ë Œë”ë§ í˜¸ì¶œí•˜ê² ì§€ë§Œ, ì—¬ê¸°ì„œëŠ” í…ìŠ¤íŠ¸ë¡œ í‘œí˜„
        }

        function showQuiz(metal, ion, reacting) {
            const quizArea = document.getElementById('quiz-area');
            const question = document.getElementById('quiz-question');
            const options = document.getElementById('quiz-options');
            const feedback = document.getElementById('quiz-feedback');

            quizArea.style.display = 'block';
            feedback.innerHTML = '';
            options.innerHTML = '';

            if (reacting) {
                question.innerText = `Q. ì´ ë°˜ì‘ì—ì„œ ì‚°í™”ëœ ë¬¼ì§ˆ(ì „ìë¥¼ ìƒì€ ê²ƒ)ì€ ë¬´ì—‡ì¸ê°€ìš”?`;
                // ì •ë‹µ: metal
                createOption(options, materials.metals[metal].name, true, feedback);
                createOption(options, materials.metals[ion].name + " ì´ì˜¨", false, feedback);
            } else {
                question.innerText = `Q. ë°˜ì‘ì´ ì¼ì–´ë‚˜ì§€ ì•Šì€ ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€ìš”?`;
                createOption(options, `${materials.metals[metal].name}ì˜ ë°˜ì‘ì„±ì´ ë” ì‘ì•„ì„œ`, true, feedback);
                createOption(options, `${materials.metals[metal].name}ì˜ ë°˜ì‘ì„±ì´ ë” ì»¤ì„œ`, false, feedback);
            }
        }

        function createOption(container, text, isCorrect, feedbackElem) {
            const btn = document.createElement('button');
            btn.innerText = text;
            btn.style.margin = '5px';
            btn.style.width = 'auto';
            btn.onclick = () => {
                if (isCorrect) {
                    feedbackElem.innerText = "âœ… ì •ë‹µì…ë‹ˆë‹¤! ê°œë…ì„ ì •í™•íˆ ì´í•´í–ˆêµ°ìš”.";
                    feedbackElem.style.color = "green";
                } else {
                    feedbackElem.innerText = "âŒ ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”.";
                    feedbackElem.style.color = "red";
                }
            };
            container.appendChild(btn);
        }

        function resetVisuals() {
            document.getElementById('liquid-display').style.backgroundColor = "var(--sol-clear)";
            document.getElementById('metal-display').style.backgroundColor = "#ccc";
            document.getElementById('coating-display').style.height = "0%";
            document.getElementById('particle-view').innerHTML = '<div class="particle-info">ëŒ€ê¸° ì¤‘...</div>';
            document.getElementById('result-text').innerText = "ì‹¤í—˜ ì¡°ê±´ì„ ì„ íƒí•˜ê³  ì‹œì‘ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.";
            document.getElementById('quiz-area').style.display = 'none';
        }

        function resetExperiment() {
            document.getElementById('metal').value = "none";
            document.getElementById('solution').value = "none";
            document.getElementById('start-btn').disabled = false;
            resetVisuals();
        }
    </script>
</body>
</html>