<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íƒ„ì†Œ í™”í•©ë¬¼ ê°€ìƒ ì‹¤í—˜ì‹¤ - Carbon Builder</title>
    <style>
        :root {
            --primary: #4a90e2;
            --secondary: #50e3c2;
            --accent: #ff6b6b;
            --bg: #f4f7f6;
            --text: #333;
            --card-bg: #ffffff;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1, h2, h3 { margin-top: 0; color: #2c3e50; }

        .container {
            max-width: 1000px;
            width: 100%;
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 20px;
        }

        /* ì‹¤í—˜ ì˜ì—­ */
        .lab-panel {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
        }

        .viewer {
            width: 100%;
            height: 350px;
            background: #eef2f5;
            border-radius: 12px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px solid #ddd;
        }
        
        #molecule-canvas {
            width: 100%;
            height: 100%;
        }

        .controls {
            display: grid;
            gap: 15px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 12px;
        }

        .control-group {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        label { font-weight: bold; margin-right: 10px; }

        input[type="range"] { flex: 1; margin: 0 10px; cursor: pointer; }
        
        .btn-group {
            display: flex;
            gap: 10px;
        }

        button {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
            background: #ddd;
            color: #555;
        }

        button.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 2px 8px rgba(74, 144, 226, 0.4);
        }

        button:hover:not(.active) { background: #ccc; }

        /* ì •ë³´ ë° í€´ì¦ˆ ì˜ì—­ */
        .info-panel {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .molecule-card {
            background: #f0f7ff;
            border-left: 5px solid var(--primary);
            padding: 15px;
            border-radius: 4px;
        }

        .molecule-name { font-size: 1.5em; font-weight: bold; color: var(--primary); }
        .molecule-formula { font-size: 1.2em; color: #666; font-family: monospace; }
        
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            margin-right: 5px;
            color: white;
        }
        .bg-saturated { background: var(--secondary); color: #005f4e; }
        .bg-unsaturated { background: var(--accent); }
        .bg-ring { background: #9b59b6; }

        .real-life-box {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed #ccc;
        }

        .quiz-section {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ffeeba;
        }

        .feedback {
            margin-top: 10px;
            font-weight: bold;
            font-size: 0.9em;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 800px) {
            .container { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <div style="text-align: center; margin-bottom: 20px;">
        <h1>ğŸ§ª ë‹¤ì–‘í•œ íƒ„ì†Œ í™”í•©ë¬¼ ê°€ìƒ ì‹¤í—˜ì‹¤</h1>
        <p>íƒ„ì†Œ ì›ìë¥¼ ì¡°ë¦½í•˜ì—¬ ë‚˜ë§Œì˜ ë¶„ìë¥¼ ë§Œë“¤ê³ , ì´ë¦„ì„ ë§ì¶°ë³´ì„¸ìš”!</p>
    </div>

    <div class="container">
        <div class="lab-panel">
            <div class="viewer">
                <svg id="molecule-canvas" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
                    </svg>
                <div style="position: absolute; bottom: 10px; right: 10px; font-size: 0.8em; color: #999;">
                    ê²€ì€ìƒ‰: íƒ„ì†Œ(C) / í°ìƒ‰: ìˆ˜ì†Œ(H)
                </div>
            </div>

            <div class="controls">
                <div class="control-group">
                    <label>íƒ„ì†Œ(C) ê°œìˆ˜:</label>
                    <input type="range" id="carbon-slider" min="1" max="5" value="1" step="1">
                    <span id="carbon-val" style="font-weight:bold; color:var(--primary); width: 30px;">1</span>
                </div>

                <div class="control-group">
                    <label>ê²°í•© ë°©ì‹:</label>
                    <div class="btn-group">
                        <button class="type-btn active" data-type="alkane">ë‹¨ì¼ê²°í•© (-ane)</button>
                        <button class="type-btn" data-type="alkene">ì´ì¤‘ê²°í•© (-ene)</button>
                        <button class="type-btn" data-type="alkyne">ì‚¼ì¤‘ê²°í•© (-yne)</button>
                    </div>
                </div>

                <div class="control-group">
                    <label>êµ¬ì¡° í˜•íƒœ:</label>
                    <div class="btn-group">
                        <button class="struct-btn active" data-struct="chain">ì‚¬ìŠ¬í˜• (Chain)</button>
                        <button class="struct-btn" data-struct="ring">ê³ ë¦¬í˜• (Ring)</button>
                    </div>
                </div>
            </div>
            
            <div style="margin-top:10px; font-size: 0.9rem; color: #666;">
                âš ï¸ <strong>ì•ˆë‚´:</strong> ê³ ë¦¬í˜•ì€ íƒ„ì†Œ 3ê°œ ì´ìƒ, ì´ì¤‘/ì‚¼ì¤‘ ê²°í•©ì€ íƒ„ì†Œ 2ê°œ ì´ìƒì¼ ë•Œë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.
            </div>
        </div>

        <div class="info-panel">
            <div class="molecule-card">
                <div id="mol-name" class="molecule-name">ë©”í…Œì¸ (Methane)</div>
                <div id="mol-formula" class="molecule-formula">CHâ‚„</div>
                <div style="margin-top: 10px;">
                    <span id="badge-sat" class="badge bg-saturated">í¬í™” íƒ„í™”ìˆ˜ì†Œ</span>
                    <span id="badge-shape" class="badge bg-saturated">ì‚¬ìŠ¬í˜•</span>
                </div>
                
                <div class="real-life-box">
                    <strong>ğŸ’¡ ì‹¤ìƒí™œ í™œìš©:</strong>
                    <p id="mol-desc">ì²œì—°ê°€ìŠ¤(LNG)ì˜ ì£¼ì„±ë¶„ìœ¼ë¡œ, ê°€ì •ìš© ë‚œë°© ë° ì¡°ë¦¬ìš© ì—°ë£Œë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.</p>
                </div>
            </div>

            <div class="quiz-section">
                <h3>ğŸ“ ë¯¸ë‹ˆ í€´ì¦ˆ</h3>
                <p id="quiz-question">ì´ í™”í•©ë¬¼ì˜ ì´ë¦„ì€ ë¬´ì—‡ì¼ê¹Œìš”?</p>
                <input type="text" id="quiz-input" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ì—í…Œì¸)" style="width: 100%; padding: 8px; margin-top: 5px; box-sizing: border-box;">
                <button onclick="checkAnswer()" style="margin-top: 10px; width: 100%; background: var(--secondary); color: #005f4e;">ì •ë‹µ í™•ì¸</button>
                <div id="quiz-feedback" class="feedback"></div>
            </div>
            
            <button onclick="saveReport()" style="margin-top: auto; background: #2c3e50; color: white;">ğŸ“„ ì‹¤í—˜ ê²°ê³¼ PDF ì €ì¥(ì˜ˆì‹œ)</button>
        </div>
    </div>

    <script>
        // --- ìƒíƒœ ê´€ë¦¬ ---
        const state = {
            c: 1,
            bond: 'alkane', // alkane, alkene, alkyne
            struct: 'chain' // chain, ring
        };

        // --- ë°ì´í„°ë² ì´ìŠ¤ (ë‹¨ìˆœí™”) ---
        const molData = {
            getKey: (c, bond, struct) => `${c}-${bond}-${struct}`,
            data: {
                '1-alkane-chain': { name: 'ë©”í…Œì¸', eng: 'Methane', f: 'CHâ‚„', desc: 'ì²œì—°ê°€ìŠ¤(LNG)ì˜ ì£¼ì„±ë¶„. ê°€ì¥ ê°„ë‹¨í•œ íƒ„ì†Œ í™”í•©ë¬¼.' },
                '2-alkane-chain': { name: 'ì—í…Œì¸', eng: 'Ethane', f: 'Câ‚‚Hâ‚†', desc: 'ì²œì—°ê°€ìŠ¤ì— í¬í•¨ë˜ì–´ ìˆìœ¼ë©°, ì—í‹¸ë Œ ì œì¡°ì˜ ì›ë£Œë¡œ ì“°ì…ë‹ˆë‹¤.' },
                '3-alkane-chain': { name: 'í”„ë¡œí˜ì¸', eng: 'Propane', f: 'Câ‚ƒHâ‚ˆ', desc: 'ì•¡í™” ì„ìœ  ê°€ìŠ¤(LPG)ì˜ ì£¼ì„±ë¶„. íœ´ëŒ€ìš© ê°€ìŠ¤ë ˆì¸ì§€ ì—°ë£Œ.' },
                '4-alkane-chain': { name: 'ë·°í…Œì¸', eng: 'Butane', f: 'Câ‚„Hâ‚â‚€', desc: 'ë¶€íƒ„ê°€ìŠ¤(íœ´ëŒ€ìš© ë²„ë„ˆ) ë° ë¼ì´í„°ì˜ ì—°ë£Œ.' },
                '5-alkane-chain': { name: 'íœí…Œì¸', eng: 'Pentane', f: 'Câ‚…Hâ‚â‚‚', desc: 'ë°œí¬ì œë‚˜ ìš©ë§¤ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.' },
                
                '2-alkene-chain': { name: 'ì—í…', eng: 'Ethene', f: 'Câ‚‚Hâ‚„', desc: 'ê³¼ì¼ì„ ë¹¨ë¦¬ ìµê²Œ í•˜ëŠ” ì‹ë¬¼ í˜¸ë¥´ëª¬. í”Œë¼ìŠ¤í‹±(PE)ì˜ ì›ë£Œ.' },
                '3-alkene-chain': { name: 'í”„ë¡œíœ', eng: 'Propene', f: 'Câ‚ƒHâ‚†', desc: 'í”Œë¼ìŠ¤í‹±(PP)ì˜ ì›ë£Œ.' },
                
                '2-alkyne-chain': { name: 'ì—íƒ€ì¸', eng: 'Ethyne', f: 'Câ‚‚Hâ‚‚', desc: 'ì•„ì„¸í‹¸ë Œì´ë¼ê³ ë„ í•˜ë©°, ë†’ì€ ì—´ì„ ë‚´ì–´ ê¸ˆì† ìš©ì ‘ì— ì“°ì…ë‹ˆë‹¤.' },

                '3-alkane-ring': { name: 'ì‚¬ì´í´ë¡œí”„ë¡œí˜ì¸', eng: 'Cyclopropane', f: 'Câ‚ƒHâ‚†', desc: 'ê³¼ê±°ì—ëŠ” ë§ˆì·¨ì œë¡œ ì‚¬ìš©ë˜ì—ˆìœ¼ë‚˜ í­ë°œì„± ë•Œë¬¸ì— í˜„ì¬ëŠ” ì˜ ì•ˆ ì”€.' },
                '4-alkane-ring': { name: 'ì‚¬ì´í´ë¡œë·°í…Œì¸', eng: 'Cyclobutane', f: 'Câ‚„Hâ‚ˆ', desc: 'ê³ ë¦¬ í˜•íƒœì˜ íƒ„í™”ìˆ˜ì†Œ.' },
                '5-alkane-ring': { name: 'ì‚¬ì´í´ë¡œíœí…Œì¸', eng: 'Cyclopentane', f: 'Câ‚…Hâ‚â‚€', desc: 'ëƒ‰ì¥ê³  ë‹¨ì—´ì¬ ë°œí¬ì œë¡œ ì‚¬ìš©ë¨.' },
                '6-alkane-ring': { name: 'ì‚¬ì´í´ë¡œí—¥ì„¸ì¸', eng: 'Cyclohexane', f: 'Câ‚†Hâ‚â‚‚', desc: 'ë‚˜ì¼ë¡ ì˜ ì›ë£Œë¥¼ ë§Œë“œëŠ”ë° ì‚¬ìš©ë¨.' }
            }
        };

        // --- DOM ìš”ì†Œ ---
        const svg = document.getElementById('molecule-canvas');
        const cSlider = document.getElementById('carbon-slider');
        const cVal = document.getElementById('carbon-val');
        const typeBtns = document.querySelectorAll('.type-btn');
        const structBtns = document.querySelectorAll('.struct-btn');
        
        // --- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ---
        cSlider.addEventListener('input', (e) => {
            state.c = parseInt(e.target.value);
            cVal.textContent = state.c;
            validateState();
            render();
        });

        typeBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                typeBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                state.bond = btn.dataset.type;
                validateState();
                render();
            });
        });

        structBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                structBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                state.struct = btn.dataset.struct;
                validateState();
                render();
            });
        });

        // --- ë¡œì§: ìœ íš¨ì„± ê²€ì‚¬ ---
        function validateState() {
            // 1. íƒ„ì†Œ 1ê°œì¼ ë•ŒëŠ” alkaneë§Œ ê°€ëŠ¥
            if (state.c === 1) {
                state.bond = 'alkane';
                state.struct = 'chain';
            }
            // 2. ê³ ë¦¬í˜•ì€ íƒ„ì†Œ 3ê°œ ì´ìƒ í•„ìš”
            if (state.struct === 'ring' && state.c < 3) {
                state.struct = 'chain';
                // UI ì—…ë°ì´íŠ¸
                structBtns.forEach(b => b.classList.remove('active'));
                document.querySelector('[data-struct="chain"]').classList.add('active');
            }
            // 3. ê³ ë¦¬í˜•ì¼ ë•Œ í˜„ì¬ ì‹œë®¬ì—ì„œëŠ” ì´ì¤‘/ì‚¼ì¤‘ ê²°í•© ë¯¸êµ¬í˜„ (ë³µì¡ë„ ë‚®ì¶¤) -> alkaneìœ¼ë¡œ ê³ ì •
            if (state.struct === 'ring') {
                state.bond = 'alkane';
            }

            // ë²„íŠ¼ ìƒíƒœ ë°˜ì˜
            updateButtonStyles();
        }

        function updateButtonStyles() {
            // íƒ„ì†Œ 1ê°œì¼ ë•Œ ì´ì¤‘/ì‚¼ì¤‘ ë¹„í™œì„±í™” ì‹œê°ì  ì²˜ë¦¬
            typeBtns.forEach(btn => {
                if (state.c === 1 && btn.dataset.type !== 'alkane') {
                    btn.style.opacity = '0.5';
                    btn.style.pointerEvents = 'none';
                    if(btn.classList.contains('active')) btn.classList.remove('active');
                } else if (state.struct === 'ring' && btn.dataset.type !== 'alkane') {
                     // ê³ ë¦¬í˜•ì¼ ë•Œ ì´ì¤‘/ì‚¼ì¤‘ ë¹„í™œì„±í™”
                    btn.style.opacity = '0.5';
                    btn.style.pointerEvents = 'none';
                } else {
                    btn.style.opacity = '1';
                    btn.style.pointerEvents = 'auto';
                }
                if (btn.dataset.type === state.bond) btn.classList.add('active');
                else btn.classList.remove('active');
            });

            // íƒ„ì†Œ 3ê°œ ë¯¸ë§Œì¼ ë•Œ ê³ ë¦¬í˜• ë¹„í™œì„±í™”
            structBtns.forEach(btn => {
                if (state.c < 3 && btn.dataset.struct === 'ring') {
                    btn.style.opacity = '0.5';
                    btn.style.pointerEvents = 'none';
                } else {
                    btn.style.opacity = '1';
                    btn.style.pointerEvents = 'auto';
                }
                if (btn.dataset.struct === state.struct) btn.classList.add('active');
                else btn.classList.remove('active');
            });
        }

        // --- ë Œë”ë§ (SVG Drawing) ---
        function render() {
            // 1. ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const key = molData.getKey(state.c, state.bond, state.struct);
            const info = molData.data[key] || { 
                name: 'ë¯¸ì§€ì˜ í™”í•©ë¬¼', 
                eng: 'Unknown', 
                f: `C${state.c}H?`, 
                desc: 'í˜„ì¬ ì¡°ê±´ì—ì„œëŠ” ì•ˆì •ì ì¸ êµ¬ì¡°ë¥¼ ë§Œë“¤ê¸° ì–´ë µê±°ë‚˜ ì´ ì‹œë®¬ë ˆì´ì…˜ ë²”ìœ„ ë°–ì…ë‹ˆë‹¤.' 
            };

            // 2. ì •ë³´ íŒ¨ë„ ì—…ë°ì´íŠ¸
            document.getElementById('mol-name').innerHTML = `${info.name} <span style="font-size:0.6em; color:#888;">${info.eng}</span>`;
            document.getElementById('mol-formula').textContent = info.f;
            document.getElementById('mol-desc').textContent = info.desc;

            // ë±ƒì§€ ì—…ë°ì´íŠ¸
            const badgeSat = document.getElementById('badge-sat');
            const badgeShape = document.getElementById('badge-shape');
            
            if (state.bond === 'alkane') {
                badgeSat.textContent = 'í¬í™” íƒ„í™”ìˆ˜ì†Œ';
                badgeSat.className = 'badge bg-saturated';
            } else {
                badgeSat.textContent = 'ë¶ˆí¬í™” íƒ„í™”ìˆ˜ì†Œ';
                badgeSat.className = 'badge bg-unsaturated';
            }

            if (state.struct === 'ring') {
                badgeShape.textContent = 'ê³ ë¦¬í˜•';
                badgeShape.className = 'badge bg-ring';
            } else {
                badgeShape.textContent = 'ì‚¬ìŠ¬í˜•';
                badgeShape.className = 'badge bg-saturated';
                badgeShape.style.backgroundColor = '#4a90e2';
            }

            // 3. SVG ê·¸ë¦¬ê¸° ë¡œì§ (ê°„ì†Œí™”ëœ 2D êµ¬ì¡°ì‹)
            drawStructure();
            
            // í€´ì¦ˆ ì´ˆê¸°í™”
            document.getElementById('quiz-feedback').textContent = '';
            document.getElementById('quiz-input').value = '';
        }

        function drawStructure() {
            svg.innerHTML = ''; // ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
            const ns = "http://www.w3.org/2000/svg";
            const cx = 200, cy = 150;
            const bondLen = 60;
            const cRadius = 15;
            const hRadius = 8;

            let coords = [];

            // íƒ„ì†Œ ì¢Œí‘œ ê³„ì‚°
            if (state.struct === 'chain') {
                const startX = cx - ((state.c - 1) * bondLen) / 2;
                for (let i = 0; i < state.c; i++) {
                    coords.push({ x: startX + i * bondLen, y: cy });
                }
            } else { // ring (ì •ë‹¤ê°í˜•)
                const r = bondLen / (2 * Math.sin(Math.PI / state.c));
                for (let i = 0; i < state.c; i++) {
                    const angle = (2 * Math.PI * i) / state.c - Math.PI / 2;
                    coords.push({ x: cx + r * Math.cos(angle), y: cy + r * Math.sin(angle) });
                }
            }

            // ê²°í•© ê·¸ë¦¬ê¸° (ì„ )
            for (let i = 0; i < coords.length; i++) {
                let nextIdx = i + 1;
                // ì‚¬ìŠ¬í˜•ì´ë©´ ë§ˆì§€ë§‰ì€ ì—°ê²° ì•ˆ í•¨, ê³ ë¦¬í˜•ì´ë©´ ë§ˆì§€ë§‰ê³¼ ì²˜ìŒ ì—°ê²°
                if (state.struct === 'chain' && i === coords.length - 1) continue;
                if (state.struct === 'ring' && i === coords.length - 1) nextIdx = 0;

                const p1 = coords[i];
                const p2 = coords[nextIdx];

                // ì´ì¤‘/ì‚¼ì¤‘ ê²°í•© ì²˜ë¦¬ (ê°„ë‹¨íˆ ì²« ë²ˆì§¸ ê²°í•©ë§Œ ë‹¤ì¤‘ê²°í•©ìœ¼ë¡œ í‘œì‹œ - êµìœ¡ìš© ë‹¨ìˆœí™”)
                let bondsToDraw = 1;
                if (state.struct === 'chain' && i === 0) { // ì‚¬ìŠ¬í˜•ì˜ ì²«ë²ˆì§¸ ê²°í•© ìœ„ì¹˜ì— ë‹¤ì¤‘ê²°í•© í‘œì‹œ
                    if (state.bond === 'alkene') bondsToDraw = 2;
                    if (state.bond === 'alkyne') bondsToDraw = 3;
                }

                drawBond(svg, p1, p2, bondsToDraw);
            }

            // íƒ„ì†Œ ì›ì ê·¸ë¦¬ê¸°
            coords.forEach(p => {
                const cCircle = document.createElementNS(ns, "circle");
                cCircle.setAttribute("cx", p.x);
                cCircle.setAttribute("cy", p.y);
                cCircle.setAttribute("r", cRadius);
                cCircle.setAttribute("fill", "#333");
                svg.appendChild(cCircle);
                
                const txt = document.createElementNS(ns, "text");
                txt.setAttribute("x", p.x);
                txt.setAttribute("y", p.y + 5);
                txt.setAttribute("text-anchor", "middle");
                txt.setAttribute("fill", "white");
                txt.setAttribute("font-size", "12px");
                txt.setAttribute("font-weight", "bold");
                txt.textContent = "C";
                svg.appendChild(txt);
            });

            // ìˆ˜ì†Œ ì›ì ê·¸ë¦¬ê¸° (ë§¤ìš° ë‹¨ìˆœí™”: ê³µê°„ ë‚¨ëŠ” ê³³ì— ë°°ì¹˜ - ì—¬ê¸°ì„œëŠ” ì‹œê°ì  ë³µì¡ë„ë¥¼ ì¤„ì´ê¸° ìœ„í•´ ìƒëµí•˜ê±°ë‚˜ ê°„ë‹¨íˆ ê°œìˆ˜ë§Œ í‘œì‹œí•  ìˆ˜ ìˆìŒ.
            // í•˜ì§€ë§Œ êµìœ¡ì  íš¨ê³¼ë¥¼ ìœ„í•´ í…ìŠ¤íŠ¸ë¡œ H ê°œìˆ˜ë¥¼ í‘œì‹œí•˜ëŠ” ë°©ì‹ì´ ê¹”ë”í•¨)
        }

        function drawBond(svg, p1, p2, count) {
            const ns = "http://www.w3.org/2000/svg";
            const offset = 4;
            
            const createLine = (ox, oy) => {
                const line = document.createElementNS(ns, "line");
                line.setAttribute("x1", p1.x + ox);
                line.setAttribute("y1", p1.y + oy);
                line.setAttribute("x2", p2.x + ox);
                line.setAttribute("y2", p2.y + oy);
                line.setAttribute("stroke", "#666");
                line.setAttribute("stroke-width", "4");
                svg.prepend(line); // ì›ì ë’¤ë¡œ ê°€ë„ë¡
            };

            if (count === 1) createLine(0, 0);
            else if (count === 2) {
                createLine(0, -offset);
                createLine(0, offset);
            } else if (count === 3) {
                createLine(0, -offset*1.5);
                createLine(0, 0);
                createLine(0, offset*1.5);
            }
        }

        // --- í€´ì¦ˆ ë° ìœ í‹¸ë¦¬í‹° ---
        function checkAnswer() {
            const input = document.getElementById('quiz-input').value.trim();
            const key = molData.getKey(state.c, state.bond, state.struct);
            const correctName = molData.data[key].name;
            const feedback = document.getElementById('quiz-feedback');

            if (input === correctName) {
                feedback.textContent = "âœ… ì •ë‹µì…ë‹ˆë‹¤! êµ¬ì¡°ì™€ ì´ë¦„ì´ ì •í™•íˆ ì¼ì¹˜í•˜ë„¤ìš”.";
                feedback.style.color = "green";
            } else {
                feedback.innerHTML = `âŒ ì•„ì‰½ë„¤ìš”.<br>íŒíŠ¸: íƒ„ì†Œê°€ ${state.c}ê°œì´ë©´ '${getPrefix(state.c)}', ${getSuffix(state.bond)} ê²°í•©ì…ë‹ˆë‹¤.`;
                feedback.style.color = "red";
            }
        }

        function getPrefix(n) {
            return ['ë©”íŠ¸', 'ì—íŠ¸', 'í”„ë¡œí”„', 'ë·°íŠ¸', 'íœíŠ¸'][n-1];
        }
        function getSuffix(type) {
            if(type === 'alkane') return 'ë‹¨ì¼(-ì—ì¸)';
            if(type === 'alkene') return 'ì´ì¤‘(-ì—”)';
            if(type === 'alkyne') return 'ì‚¼ì¤‘(-ì•„ì¸)';
        }

        function saveReport() {
            alert("í•™ìŠµ ê²°ê³¼ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤! (ì‹¤ì œ êµ¬í˜„ ì‹œ PDF ë‹¤ìš´ë¡œë“œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—°ë™)");
        }

        // ì´ˆê¸° ì‹¤í–‰
        validateState();
        render();

    </script>
</body>
</html>