<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°€ìƒ ì‹¤í—˜: ì—íƒ„ì˜¬ ê°€ì—´í•˜ê¸°</title>
    <style>
        :root { --primary-color: #4a90e2; --bg-color: #f4f7f6; --text-color: #333; }
        body { font-family: 'Noto Sans KR', sans-serif; background: var(--bg-color); color: var(--text-color); margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        
        /* Layout */
        .container { max-width: 1000px; width: 100%; background: white; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); padding: 20px; }
        .header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        .lab-bench { display: flex; justify-content: space-around; flex-wrap: wrap; gap: 20px; margin-bottom: 20px; }
        
        /* Visuals */
        .apparatus { position: relative; width: 300px; height: 350px; background: #fafafa; border: 1px solid #ddd; border-radius: 10px; display: flex; justify-content: center; align-items: flex-end; padding-bottom: 20px; overflow: hidden; }
        .beaker { width: 120px; height: 160px; border: 3px solid #ccc; border-top: none; position: relative; background: rgba(255,255,255,0.5); border-radius: 0 0 10px 10px; z-index: 2; }
        .liquid { width: 100%; height: 60%; background: rgba(100, 181, 246, 0.4); position: absolute; bottom: 0; border-radius: 0 0 7px 7px; transition: height 0.5s; }
        .thermometer { width: 10px; height: 250px; background: #eee; border: 1px solid #999; position: absolute; left: 50%; bottom: 40px; transform: translateX(-50%); border-radius: 5px; z-index: 3; }
        .mercury { width: 100%; background: #e74c3c; position: absolute; bottom: 0; height: 20%; transition: height 0.2s; border-radius: 0 0 4px 4px; }
        .hotplate { width: 160px; height: 30px; background: #333; position: absolute; bottom: 10px; border-radius: 5px; }
        .coil { width: 140px; height: 10px; background: #555; margin: 5px auto; border-radius: 5px; transition: background 0.5s; }
        
        /* Bubbles Animation */
        .bubble { position: absolute; background: rgba(255,255,255,0.8); border-radius: 50%; animation: rise 2s infinite ease-in; bottom: 10px; opacity: 0; }
        @keyframes rise { 0% { bottom: 10px; opacity: 1; transform: scale(0.5); } 100% { bottom: 140px; opacity: 0; transform: scale(1.2); } }

        /* Graph & Particle Area */
        .data-panel { flex: 1; min-width: 300px; display: flex; flex-direction: column; gap: 10px; }
        canvas { background: #fff; border: 1px solid #ddd; border-radius: 5px; width: 100%; height: 200px; }
        .particle-box { height: 100px; background: #2c3e50; border-radius: 5px; position: relative; overflow: hidden; display: flex; justify-content: center; align-items: center; color: white; font-size: 0.8rem; }
        .molecule { width: 8px; height: 8px; background: #3498db; border-radius: 50%; position: absolute; }

        /* Controls */
        .controls { background: #f8f9fa; padding: 15px; border-radius: 10px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px; }
        button { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-start { background: #2ecc71; color: white; }
        .btn-reset { background: #e74c3c; color: white; }
        .slider-group { display: flex; align-items: center; gap: 10px; }
        
        /* Feedback & Quiz */
        .info-panel { margin-top: 20px; padding: 15px; background: #e8f4fc; border-left: 5px solid #3498db; border-radius: 5px; min-height: 60px; }
        .quiz-section { margin-top: 30px; border-top: 2px dashed #ccc; padding-top: 20px; display: none; }
        .quiz-option { display: block; margin: 5px 0; padding: 10px; background: #fff; border: 1px solid #ddd; cursor: pointer; border-radius: 5px; }
        .quiz-option:hover { background: #f0f0f0; }
        .correct { background: #d4edda !important; border-color: #c3e6cb; }
        .wrong { background: #f8d7da !important; border-color: #f5c6cb; }

    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h2>âš—ï¸ ì—íƒ„ì˜¬ ê°€ì—´ ì‹¤í—˜ (ê°€ìƒ ì‹¤í—˜ì‹¤)</h2>
        <p>ëª©í‘œ: ì—íƒ„ì˜¬ì„ ê°€ì—´í•˜ë©° ì‹œê°„-ì˜¨ë„ ê·¸ë˜í”„ë¥¼ ê´€ì°°í•˜ê³ , ë“ëŠ”ì ì˜ íŠ¹ì§•ì„ ì•Œì•„ë´…ì‹œë‹¤.</p>
    </div>

    <div class="lab-bench">
        <div class="apparatus">
            <div class="thermometer"><div class="mercury" id="mercury"></div></div>
            <div class="beaker">
                <div class="liquid" id="liquid"></div>
            </div>
            <div class="hotplate"><div class="coil" id="coil"></div></div>
        </div>

        <div class="data-panel">
            <div>ğŸ“Š ì˜¨ë„ ë³€í™” ê·¸ë˜í”„</div>
            <canvas id="graphCanvas"></canvas>
            
            <div style="margin-top:10px;">âš›ï¸ ë¶„ì ìš´ë™ ëª¨í˜•</div>
            <div class="particle-box" id="particleBox">
                </div>
            <div style="text-align: right; font-weight: bold; font-size: 1.2rem;">
                í˜„ì¬ ì˜¨ë„: <span id="tempDisplay">20.0</span>Â°C
            </div>
        </div>
    </div>

    <div class="controls">
        <div class="slider-group">
            <label>ğŸ”¥ í™”ë ¥ ì¡°ì ˆ:</label>
            <input type="range" id="heatSlider" min="1" max="5" value="3">
            <span id="heatLevel">ì¤‘ê°„</span>
        </div>
        <div>
            <button class="btn-start" onclick="toggleExperiment()" id="btnControl">ì‹¤í—˜ ì‹œì‘</button>
            <button class="btn-reset" onclick="resetExperiment()">ì´ˆê¸°í™”</button>
        </div>
    </div>

    <div class="info-panel" id="feedback">
        ğŸ‘¨â€ğŸ« ì„ ìƒë‹˜: "ì‹¤í—˜ ì‹œì‘ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì—íƒ„ì˜¬ì„ ê°€ì—´í•´ ë³´ì„¸ìš”."
    </div>

    <div class="quiz-section" id="quizSection">
        <h3>ğŸ“ ê°œë… í™•ì¸ í€´ì¦ˆ</h3>
        <p>ì§ˆë¬¸: ì—íƒ„ì˜¬ì´ ë“ê¸° ì‹œì‘í•œ í›„, ê³„ì† ê°€ì—´í–ˆëŠ”ë°ë„ ì˜¨ë„ê°€ ì˜¬ë¼ê°€ì§€ ì•ŠëŠ” ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€ìš”?</p>
        <div class="quiz-option" onclick="checkAnswer(this, false)">1. ì—íƒ„ì˜¬ì´ ëª¨ë‘ ì¦ë°œí•´ì„œ ì‚¬ë¼ì¡Œê¸° ë•Œë¬¸ì—</div>
        <div class="quiz-option" onclick="checkAnswer(this, true)">2. ê°€í•´ì¤€ ì—´ì´ ìƒíƒœ ë³€í™”(ì•¡ì²´â†’ê¸°ì²´)ì— ì“°ì˜€ê¸° ë•Œë¬¸ì—</div>
        <div class="quiz-option" onclick="checkAnswer(this, false)">3. ì˜¨ë„ê³„ê°€ ê³ ì¥ ë‚¬ê¸° ë•Œë¬¸ì—</div>
        <div id="quizFeedback" style="margin-top:10px; font-weight: bold;"></div>
    </div>
</div>

<script>
    // ìƒíƒœ ë³€ìˆ˜
    let isRunning = false;
    let temperature = 20.0;
    const boilingPoint = 78.5; // ì—íƒ„ì˜¬ ë“ëŠ”ì 
    let time = 0;
    let timerInterval;
    const dataPoints = [];
    
    // DOM ìš”ì†Œ
    const mercury = document.getElementById('mercury');
    const tempDisplay = document.getElementById('tempDisplay');
    const feedback = document.getElementById('feedback');
    const btnControl = document.getElementById('btnControl');
    const canvas = document.getElementById('graphCanvas');
    const ctx = canvas.getContext('2d');
    const coil = document.getElementById('coil');
    const liquid = document.getElementById('liquid');
    const particleBox = document.getElementById('particleBox');
    
    // ì´ˆê¸°í™” ë° ìº”ë²„ìŠ¤ ì„¤ì •
    canvas.width = 300;
    canvas.height = 200;
    
    // ë¶„ì ìƒì„±
    const particles = [];
    for(let i=0; i<15; i++) {
        const p = document.createElement('div');
        p.className = 'molecule';
        particleBox.appendChild(p);
        particles.push({ el: p, x: Math.random()*280, y: Math.random()*80, vx: Math.random()-0.5, vy: Math.random()-0.5 });
    }

    function toggleExperiment() {
        if (isRunning) {
            pauseExperiment();
        } else {
            startExperiment();
        }
    }

    function startExperiment() {
        isRunning = true;
        btnControl.textContent = "ì¼ì‹œ ì •ì§€";
        feedback.innerHTML = "ğŸ‘¨â€ğŸ« ê°€ì—´ ì¤‘ì…ë‹ˆë‹¤. ê·¸ë˜í”„ì˜ ê¸°ìš¸ê¸°ì™€ ë¶„ì ìš´ë™ì„ ê´€ì°°í•˜ì„¸ìš”.";
        coil.style.background = "#e74c3c"; // ì½”ì¼ ë¶‰ê²Œ
        
        timerInterval = setInterval(update, 100);
    }

    function pauseExperiment() {
        isRunning = false;
        btnControl.textContent = "ë‹¤ì‹œ ì‹œì‘";
        clearInterval(timerInterval);
        coil.style.background = "#555";
    }

    function resetExperiment() {
        pauseExperiment();
        temperature = 20.0;
        time = 0;
        dataPoints.length = 0;
        btnControl.textContent = "ì‹¤í—˜ ì‹œì‘";
        feedback.innerHTML = "ğŸ‘¨â€ğŸ« ë‹¤ì‹œ ì‹¤í—˜ì„ ì‹œì‘í•´ ë³´ì„¸ìš”.";
        document.getElementById('quizSection').style.display = 'none';
        
        // ì‹œê°í™” ì´ˆê¸°í™”
        updateVisuals();
        drawGraph();
        document.querySelectorAll('.bubble').forEach(b => b.remove());
    }

    function update() {
        time += 0.5; // ì‹œê°„ ê²½ê³¼
        const heatPower = parseInt(document.getElementById('heatSlider').value);
        
        // ì˜¨ë„ ê³„ì‚° ë¡œì§
        if (temperature < boilingPoint) {
            // ë“ëŠ”ì  ë„ë‹¬ ì „: í™”ë ¥ì— ë¹„ë¡€í•˜ì—¬ ìƒìŠ¹
            temperature += (heatPower * 0.1); 
        } else {
            // ë“ëŠ”ì  ë„ë‹¬ í›„: ì˜¨ë„ ìœ ì§€ (ì•½ê°„ì˜ ë…¸ì´ì¦ˆ ì¶”ê°€í•˜ì—¬ í˜„ì‹¤ê° ë¶€ì—¬)
            temperature = boilingPoint + (Math.random() * 0.2 - 0.1);
            createBubble();
            
            if (time % 20 === 0) { // ê°€ë” ë©”ì‹œì§€ ì¶œë ¥
                feedback.innerHTML = "ğŸ’¡ <b>ê´€ì°° í¬ì¸íŠ¸:</b> ë“ëŠ”ì ì— ë„ë‹¬í–ˆìŠµë‹ˆë‹¤! ì˜¨ë„ê°€ ë” ì´ìƒ ì˜¤ë¥´ì§€ ì•Šê³  ì¼ì •í•˜ê²Œ ìœ ì§€ë©ë‹ˆë‹¤.";
            }
        }

        // ë°ì´í„° ì €ì¥
        dataPoints.push(temperature);
        if (dataPoints.length > 300) pauseExperiment(); // ìë™ ì¢…ë£Œ

        updateVisuals();
        drawGraph();
        animateParticles();

        // ë“ëŠ”ì  ë„ë‹¬ í›„ ì¼ì • ì‹œê°„ ì§€ë‚˜ë©´ í€´ì¦ˆ í‘œì‹œ
        if (temperature >= boilingPoint && dataPoints.length > 200 && document.getElementById('quizSection').style.display === 'none') {
             document.getElementById('quizSection').style.display = 'block';
             feedback.innerHTML = "âœ… ì‹¤í—˜ ì™„ë£Œ! ì•„ë˜ í€´ì¦ˆë¥¼ í’€ì–´ë³´ì„¸ìš”.";
        }
    }

    function updateVisuals() {
        // í…ìŠ¤íŠ¸
        tempDisplay.textContent = temperature.toFixed(1);
        
        // ì˜¨ë„ê³„ ë†’ì´ (20ë„~100ë„ ë§¤í•‘)
        const percent = ((temperature - 0) / 120) * 100; 
        mercury.style.height = `${percent}%`;
    }

    function createBubble() {
        if (Math.random() > 0.7) return; 
        const bubble = document.createElement('div');
        bubble.className = 'bubble';
        bubble.style.width = bubble.style.height = (Math.random() * 10 + 5) + 'px';
        bubble.style.left = (Math.random() * 80 + 10) + '%';
        liquid.appendChild(bubble);
        setTimeout(() => bubble.remove(), 1900);
    }

    function animateParticles() {
        // ì˜¨ë„ê°€ ë†’ì„ìˆ˜ë¡ ì†ë„ ì¦ê°€
        const speedFactor = (temperature / 20); 
        
        particles.forEach(p => {
            p.x += p.vx * speedFactor;
            p.y += p.vy * speedFactor;

            // ë²½ ì¶©ëŒ
            if(p.x <= 0 || p.x >= 290) p.vx *= -1;
            if(p.y <= 0 || p.y >= 90) p.vy *= -1;

            p.el.style.left = p.x + 'px';
            p.el.style.top = p.y + 'px';
        });
    }

    function drawGraph() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // ì¶• ê·¸ë¦¬ê¸°
        ctx.strokeStyle = '#ccc';
        ctx.beginPath();
        ctx.moveTo(30, 10); ctx.lineTo(30, 180); // Yì¶•
        ctx.lineTo(290, 180); // Xì¶•
        ctx.stroke();

        // ë“ëŠ”ì  ê¸°ì¤€ì„  (ë¹¨ê°„ ì ì„ )
        const bpY = 180 - (boilingPoint / 120 * 170);
        ctx.strokeStyle = 'rgba(231, 76, 60, 0.5)';
        ctx.setLineDash([5, 5]);
        ctx.beginPath();
        ctx.moveTo(30, bpY); ctx.lineTo(290, bpY);
        ctx.stroke();
        ctx.setLineDash([]);

        // ë°ì´í„° ê·¸ë¦¬ê¸°
        ctx.strokeStyle = '#3498db';
        ctx.lineWidth = 2;
        ctx.beginPath();
        const startX = 30;
        
        // Xì¶• ìŠ¤ì¼€ì¼ ì¡°ì • (ë°ì´í„° í¬ì¸íŠ¸ ê°œìˆ˜ì— ë”°ë¼ ì••ì¶•)
        const xStep = 250 / (dataPoints.length > 100 ? dataPoints.length : 100); 

        dataPoints.forEach((temp, index) => {
            const x = startX + (index * xStep);
            const y = 180 - (temp / 120 * 170); // 120ë„ ê¸°ì¤€ ë§¤í•‘
            if (index === 0) ctx.moveTo(x, y);
            else ctx.lineTo(x, y);
        });
        ctx.stroke();
    }

    function checkAnswer(el, isCorrect) {
        const feedbackDiv = document.getElementById('quizFeedback');
        if (isCorrect) {
            el.classList.add('correct');
            feedbackDiv.style.color = 'green';
            feedbackDiv.textContent = "ì •ë‹µì…ë‹ˆë‹¤! ê°€í•´ì¤€ ì—´ ì—ë„ˆì§€ê°€ ë¶„ì ê°„ì˜ ì¸ë ¥ì„ ëŠê³  ê¸°ì²´ë¡œ ë³€í•˜ëŠ” ë° ì‚¬ìš©ë˜ì—ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.";
        } else {
            el.classList.add('wrong');
            feedbackDiv.style.color = 'red';
            feedbackDiv.textContent = "ë‹¤ì‹œ ìƒê°í•´ ë³¼ê¹Œìš”? ì˜¨ë„ëŠ” ì˜¤ë¥´ì§€ ì•Šì•˜ì§€ë§Œ ì—´ì€ ê³„ì† ê°€í•´ì§€ê³  ìˆì—ˆìŠµë‹ˆë‹¤.";
        }
    }
    
    // ìŠ¬ë¼ì´ë” ì´ë²¤íŠ¸
    document.getElementById('heatSlider').addEventListener('input', function(e) {
        const levels = ['ë§¤ìš° ì•½í•¨', 'ì•½í•¨', 'ì¤‘ê°„', 'ê°•í•¨', 'ë§¤ìš° ê°•í•¨'];
        document.getElementById('heatLevel').textContent = levels[e.target.value - 1];
    });
</script>

</body>
</html>