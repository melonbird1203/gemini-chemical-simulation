<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë“œë¼ì´ì•„ì´ìŠ¤ ìŠ¹í™” ê°€ìƒ ì‹¤í—˜</title>
    <style>
        body { font-family: 'Pretendard', sans-serif; background-color: #f0f4f8; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .container { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); max-width: 800px; width: 100%; }
        h1 { color: #2c3e50; text-align: center; }
        .canvas-wrapper { position: relative; width: 100%; height: 400px; background: #eef2f3; border: 2px solid #bdc3c7; border-radius: 10px; overflow: hidden; margin-bottom: 20px; }
        canvas { display: block; width: 100%; height: 100%; }
        .controls { display: flex; flex-direction: column; gap: 15px; background: #fafafa; padding: 15px; border-radius: 10px; }
        .control-group { display: flex; align-items: center; justify-content: space-between; gap: 10px; }
        label { font-weight: bold; color: #34495e; }
        input[type="range"] { flex-grow: 1; cursor: pointer; }
        .btn-group { display: flex; justify-content: center; gap: 10px; margin-top: 10px; }
        button { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-start { background-color: #3498db; color: white; }
        .btn-start:hover { background-color: #2980b9; }
        .btn-reset { background-color: #e74c3c; color: white; }
        .btn-reset:hover { background-color: #c0392b; }
        .status-panel { margin-top: 10px; padding: 10px; background: #e8f6f3; border-radius: 5px; border-left: 5px solid #1abc9c; }
        .status-text { font-size: 0.95rem; color: #16a085; }
        .overlay-text { position: absolute; top: 10px; left: 10px; background: rgba(255,255,255,0.8); padding: 5px 10px; border-radius: 5px; font-size: 0.9rem; pointer-events: none; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ§Š ë“œë¼ì´ì•„ì´ìŠ¤ ìŠ¹í™” ì‹¤í—˜</h1>
    
    <div class="canvas-wrapper">
        <canvas id="simCanvas"></canvas>
        <div class="overlay-text" id="stateLabel">í˜„ì¬ ìƒíƒœ: ê³ ì²´ (ë“œë¼ì´ì•„ì´ìŠ¤)</div>
    </div>

    <div class="controls">
        <div class="control-group">
            <label for="tempSlider">ì˜¨ë„ ì¡°ì ˆ (ì—´ ì—ë„ˆì§€):</label>
            <span id="tempValue">-78Â°C</span>
            <input type="range" id="tempSlider" min="-100" max="30" value="-80" step="1">
        </div>
        
        <div class="status-panel">
            <strong>ğŸ‘€ ê´€ì°° í¬ì¸íŠ¸:</strong> <span id="feedbackText">ì…ìë“¤ì´ ê·œì¹™ì ìœ¼ë¡œ ë°°ì—´ë˜ì–´ ì œìë¦¬ì—ì„œ ì§„ë™í•˜ê³  ìˆìŠµë‹ˆë‹¤.</span>
        </div>

        <div class="btn-group">
            <button class="btn-start" onclick="toggleSimulation()">â¯ ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘/ì •ì§€</button>
            <button class="btn-reset" onclick="resetSimulation()">ğŸ”„ ì´ˆê¸°í™”</button>
        </div>
    </div>
</div>

<script>
    const canvas = document.getElementById('simCanvas');
    const ctx = canvas.getContext('2d');
    const tempSlider = document.getElementById('tempSlider');
    const tempValue = document.getElementById('tempValue');
    const feedbackText = document.getElementById('feedbackText');
    const stateLabel = document.getElementById('stateLabel');

    let particles = [];
    let isRunning = true;
    let animationId;
    
    // ì„¤ì •ê°’
    const particleCount = 64; // 8x8 ê²©ì
    const particleRadius = 6;
    const sublimationPoint = -78.5;

    // ìº”ë²„ìŠ¤ í¬ê¸° ì¡°ì •
    function resizeCanvas() {
        canvas.width = canvas.parentElement.clientWidth;
        canvas.height = canvas.parentElement.clientHeight;
        resetSimulation();
    }

    class Particle {
        constructor(x, y, fixedX, fixedY) {
            this.x = x;
            this.y = y;
            this.fixedX = fixedX; // ê³ ì²´ì¼ ë•Œ ê¸°ì¤€ ìœ„ì¹˜
            this.fixedY = fixedY;
            this.vx = 0;
            this.vy = 0;
            this.isGas = false;
        }

        update(temp) {
            // ì˜¨ë„ì— ë”°ë¥¸ ì—ë„ˆì§€ ê³„ìˆ˜ (0 ~ 1.5)
            const energy = (temp + 100) / 130; 

            if (temp < sublimationPoint) {
                // ê³ ì²´ ìƒíƒœ: ì œìë¦¬ ì§„ë™
                this.isGas = false;
                // ì˜¨ë„ê°€ ë†’ì„ìˆ˜ë¡ ì§„ë™ í­ì´ ì»¤ì§
                this.x = this.fixedX + (Math.random() - 0.5) * (energy * 5);
                this.y = this.fixedY + (Math.random() - 0.5) * (energy * 5);
            } else {
                // ê¸°ì²´ ìƒíƒœ (ìŠ¹í™”): ììœ  ìš´ë™
                if (!this.isGas) {
                    // ê³ ì²´ -> ê¸°ì²´ë¡œ ë³€í•˜ëŠ” ìˆœê°„ ì´ˆê¸° ì†ë„ ë¶€ì—¬
                    this.isGas = true;
                    const angle = Math.random() * Math.PI * 2;
                    const speed = 2 + (energy * 3); // ì˜¨ë„ê°€ ë†’ì„ìˆ˜ë¡ ë” ë¹ ë¦„
                    this.vx = Math.cos(angle) * speed;
                    this.vy = Math.sin(angle) * speed;
                }

                // ì´ë™
                this.x += this.vx;
                this.y += this.vy;

                // ë²½ ì¶©ëŒ (íŠ•ê¸°ê¸°)
                if (this.x < particleRadius || this.x > canvas.width - particleRadius) this.vx *= -1;
                if (this.y < particleRadius || this.y > canvas.height - particleRadius) this.vy *= -1;
            }
        }

        draw() {
            ctx.beginPath();
            ctx.arc(this.x, this.y, particleRadius, 0, Math.PI * 2);
            // ìƒ‰ìƒ: ê³ ì²´(ì§„í•œ íŒŒë‘) -> ê¸°ì²´(ì—°í•œ í•˜ëŠ˜ìƒ‰/íšŒìƒ‰)
            ctx.fillStyle = this.isGas ? `rgba(100, 149, 237, 0.7)` : `rgba(41, 128, 185, 1)`;
            ctx.fill();
            ctx.strokeStyle = "#2c3e50";
            ctx.stroke();
            ctx.closePath();
        }
    }

    function initParticles() {
        particles = [];
        const cols = 8;
        const startX = (canvas.width / 2) - (cols * particleRadius * 2.5) / 2;
        const startY = canvas.height - 100;

        for (let i = 0; i < particleCount; i++) {
            const col = i % cols;
            const row = Math.floor(i / cols);
            const x = startX + col * (particleRadius * 2.5);
            const y = startY + row * (particleRadius * 2.5);
            particles.push(new Particle(x, y, x, y));
        }
    }

    function animate() {
        if (!isRunning) return;
        
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // íˆ¬ëª… ìš©ê¸° ê·¸ë¦¬ê¸° (ë¶€í”¼ê° í‘œí˜„)
        ctx.strokeStyle = "#bdc3c7";
        ctx.lineWidth = 2;
        ctx.strokeRect(10, 10, canvas.width - 20, canvas.height - 20);

        const currentTemp = parseFloat(tempSlider.value);

        particles.forEach(p => {
            p.update(currentTemp);
            p.draw();
        });

        // í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        updateFeedback(currentTemp);

        animationId = requestAnimationFrame(animate);
    }

    function updateFeedback(temp) {
        tempValue.innerText = temp + "Â°C";
        
        if (temp < sublimationPoint) {
            stateLabel.innerText = "í˜„ì¬ ìƒíƒœ: ê³ ì²´ (ë“œë¼ì´ì•„ì´ìŠ¤)";
            stateLabel.style.color = "blue";
            feedbackText.innerText = "ì…ìë“¤ì´ ê·œì¹™ì ìœ¼ë¡œ ë°°ì—´ë˜ì–´ ë¹½ë¹½í•˜ê²Œ ëª¨ì—¬ ìˆìŠµë‹ˆë‹¤. ì—´ì„ ë°›ìœ¼ë©´ ì œìë¦¬ì—ì„œ ì§„ë™í•©ë‹ˆë‹¤.";
        } else {
            stateLabel.innerText = "í˜„ì¬ ìƒíƒœ: ê¸°ì²´ (ì´ì‚°í™”íƒ„ì†Œ)";
            stateLabel.style.color = "red";
            feedbackText.innerText = "ì…ì ê°„ì˜ ì¸ë ¥ì´ ëŠì–´ì ¸ ë§¤ìš° ììœ ë¡­ê³  ë¹ ë¥´ê²Œ ì›€ì§ì…ë‹ˆë‹¤. ë¶€í”¼ê°€ í¬ê²Œ ëŠ˜ì–´ë‚©ë‹ˆë‹¤!";
        }
    }

    function toggleSimulation() {
        isRunning = !isRunning;
        if (isRunning) animate();
    }

    function resetSimulation() {
        tempSlider.value = -80;
        isRunning = true;
        cancelAnimationFrame(animationId);
        initParticles();
        animate();
    }

    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    window.addEventListener('resize', resizeCanvas);
    tempSlider.addEventListener('input', () => {
        // ìŠ¬ë¼ì´ë” ì¡°ì‘ ì‹œ ì¦‰ê° ë°˜ì‘
        if(!isRunning) {
             isRunning = true;
             animate();
        }
    });

    // ì´ˆê¸° ì‹¤í–‰
    setTimeout(() => {
        resizeCanvas();
        animate();
    }, 100);

</script>
</body>
</html>