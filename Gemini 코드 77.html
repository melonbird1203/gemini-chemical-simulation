<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸°ì²´ ë°˜ì‘ ë²•ì¹™ ê°€ìƒ ì‹¤í—˜ì‹¤</title>
    <style>
        :root {
            --primary: #4F46E5;
            --secondary: #10B981;
            --danger: #EF4444;
            --bg: #F3F4F6;
            --glass: rgba(255, 255, 255, 0.9);
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            background-color: var(--bg);
            margin: 0;
            padding: 20px;
            color: #1F2937;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            max-width: 1000px;
            width: 100%;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .container { grid-template-columns: 1fr; }
        }

        /* ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .card {
            background: white;
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        h1, h2, h3 { margin-top: 0; }
        h1 { color: var(--primary); text-align: center; width: 100%; margin-bottom: 30px; }

        /* ì œì–´ íŒ¨ë„ */
        .control-panel {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .slider-group {
            background: #F9FAFB;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #E5E7EB;
        }

        label { display: block; margin-bottom: 5px; font-weight: bold; }
        
        input[type=range] {
            width: 100%;
            margin: 10px 0;
        }

        .value-display {
            float: right;
            color: var(--primary);
            font-weight: bold;
        }

        button#ignite-btn {
            background-color: var(--danger);
            color: white;
            border: none;
            padding: 15px;
            font-size: 1.1rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.1s;
        }

        button#ignite-btn:active { transform: scale(0.98); }
        button#reset-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 10px;
        }

        /* ì‹œê°í™” ì˜ì—­ */
        .chamber-container {
            position: relative;
            height: 300px;
            background: linear-gradient(to bottom, #E0F2FE, #FFFFFF);
            border: 2px solid #9CA3AF;
            border-radius: 12px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
        }

        .piston {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 20px;
            background: #6B7280;
            transition: top 1s ease-in-out;
            z-index: 10;
        }
        .piston::after {
            content: "í”¼ìŠ¤í†¤";
            color: white;
            font-size: 12px;
            display: block;
            text-align: center;
        }

        .gas-particles {
            position: absolute;
            top: 20px;
            bottom: 0;
            left: 0;
            right: 0;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            border-radius: 50%;
            transition: all 1s;
        }
        .h2-particle { width: 10px; height: 10px; background: #EF4444; } /* ìˆ˜ì†Œ: ë¹¨ê°• */
        .o2-particle { width: 14px; height: 14px; background: #3B82F6; } /* ì‚°ì†Œ: íŒŒë‘ */
        .water-drop { 
            width: 16px; height: 16px; 
            background: #3B82F6; 
            border: 2px solid #EF4444; 
            border-radius: 50%;
            position: absolute;
            bottom: 5px;
        }

        /* ê²°ê³¼ ê·¸ë˜í”„ */
        .graph-container {
            display: flex;
            align-items: flex-end;
            height: 150px;
            gap: 20px;
            padding-top: 20px;
            border-bottom: 1px solid #E5E7EB;
        }

        .bar {
            width: 50px;
            background: var(--primary);
            transition: height 1s;
            position: relative;
            border-radius: 4px 4px 0 0;
            min-height: 2px;
        }
        .bar span {
            position: absolute;
            top: -25px;
            width: 100%;
            text-align: center;
            font-size: 0.9rem;
            font-weight: bold;
        }
        .bar-label {
            text-align: center;
            margin-top: 5px;
            font-size: 0.9rem;
        }

        .feedback-box {
            background: #FFFBEB;
            border-left: 4px solid #F59E0B;
            padding: 15px;
            margin-top: 15px;
            border-radius: 4px;
            display: none;
        }
        
        .safety-note {
            font-size: 0.8rem;
            color: #6B7280;
            margin-top: 10px;
            text-align: center;
        }

        /* í€´ì¦ˆ ì˜ì—­ */
        .quiz-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px dashed #E5E7EB;
        }

        .legend {
            display: flex;
            gap: 15px;
            font-size: 0.85rem;
            margin-bottom: 10px;
            justify-content: center;
        }
        .dot { width: 10px; height: 10px; display: inline-block; border-radius: 50%; margin-right: 5px; }
    </style>
</head>
<body>

    <h1>ğŸ§ª ê°€ìƒ ì‹¤í—˜ì‹¤: ê¸°ì²´ ë°˜ì‘ ë²•ì¹™</h1>

    <div class="container">
        <div class="card">
            <h2>1. ì‹¤í—˜ ì„¤ì •</h2>
            <p>ìˆ˜ì†Œì™€ ì‚°ì†Œ ê¸°ì²´ë¥¼ ì£¼ì‚¬ê¸°ì— ë„£ê³  ì „ê¸° ë¶ˆê½ƒìœ¼ë¡œ ë°˜ì‘ì‹œí‚µë‹ˆë‹¤. (ìµœëŒ€ 30mL)</p>
            
            <div class="control-panel">
                <div class="slider-group">
                    <label>ìˆ˜ì†Œ ($H_2$) ë¶€í”¼ <span id="val-h2" class="value-display">10 mL</span></label>
                    <input type="range" id="input-h2" min="0" max="30" value="10" step="2">
                </div>
                
                <div class="slider-group">
                    <label>ì‚°ì†Œ ($O_2$) ë¶€í”¼ <span id="val-o2" class="value-display">10 mL</span></label>
                    <input type="range" id="input-o2" min="0" max="30" value="10" step="2">
                </div>

                <div class="legend">
                    <span><span class="dot" style="background:#EF4444;"></span>ìˆ˜ì†Œ</span>
                    <span><span class="dot" style="background:#3B82F6;"></span>ì‚°ì†Œ</span>
                    <span><span class="dot" style="background:#3B82F6; border:1px solid red;"></span>ë¬¼(ì•¡ì²´)</span>
                </div>

                <button id="ignite-btn">ğŸ”¥ ì „ê¸° ì í™” (ë°˜ì‘ ì‹œì‘)</button>
                <button id="reset-btn">ğŸ”„ ì‹¤í—˜ ì´ˆê¸°í™”</button>
            </div>

            <div class="quiz-section">
                <h3>ğŸ’¡ ìƒê°í•´ë³´ê¸°</h3>
                <p id="quiz-question">ìˆ˜ì†Œ 10mLì™€ ì‚°ì†Œ 10mLê°€ ë°˜ì‘í•˜ë©´ ë‚¨ëŠ” ê¸°ì²´ëŠ” ë¬´ì—‡ì¼ê¹Œìš”?</p>
                <div id="quiz-feedback" style="font-weight: bold; color: var(--primary);"></div>
            </div>
            
            <p class="safety-note">âš ï¸ ì£¼ì˜: ì‹¤ì œ ì‹¤í—˜ì‹¤ì—ì„œ ìˆ˜ì†Œ í­ë°œ ì‹¤í—˜ì€ ë°˜ë“œì‹œ ì•ˆì „ ì¥ë¹„ì™€ ë³´í˜¸ë§‰ ì•ˆì—ì„œ êµì‚¬ì˜ ì§€ë„í•˜ì— ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤.</p>
        </div>

        <div class="card">
            <h2>2. ì‹¤í—˜ ê´€ì°°</h2>
            
            <div class="chamber-container" id="chamber">
                <div class="piston" id="piston"></div>
                <div class="gas-particles" id="particles"></div>
                <div id="explosion" style="position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); font-size:4rem; opacity:0; pointer-events:none;">ğŸ’¥</div>
            </div>

            <div style="margin-top:20px;">
                <h3>ğŸ“Š ê²°ê³¼ ë¶„ì„</h3>
                <div class="graph-container">
                    <div>
                        <div class="bar" id="bar-h2" style="background: #EF4444; height: 33%;"><span>10</span></div>
                        <div class="bar-label">ë‚¨ì€ ìˆ˜ì†Œ</div>
                    </div>
                    <div>
                        <div class="bar" id="bar-o2" style="background: #3B82F6; height: 33%;"><span>10</span></div>
                        <div class="bar-label">ë‚¨ì€ ì‚°ì†Œ</div>
                    </div>
                    <div>
                        <div class="bar" id="bar-water" style="background: #10B981; height: 0%;"><span>0</span></div>
                        <div class="bar-label">ìƒì„±ëœ ë¬¼<br>(ë¶„ììˆ˜ ë¹„ë¡€)</div>
                    </div>
                </div>
            </div>

            <div class="feedback-box" id="feedback">
                <strong id="feedback-title">ì‹¤í—˜ ê²°ê³¼</strong>
                <p id="feedback-text"></p>
            </div>
        </div>
    </div>

    <script>
        // DOM ìš”ì†Œ
        const inputH2 = document.getElementById('input-h2');
        const inputO2 = document.getElementById('input-o2');
        const valH2 = document.getElementById('val-h2');
        const valO2 = document.getElementById('val-o2');
        const piston = document.getElementById('piston');
        const particlesContainer = document.getElementById('particles');
        const feedbackBox = document.getElementById('feedback');
        const feedbackText = document.getElementById('feedback-text');
        const barH2 = document.getElementById('bar-h2');
        const barO2 = document.getElementById('bar-o2');
        const barWater = document.getElementById('bar-water');
        const quizQ = document.getElementById('quiz-question');
        const explosion = document.getElementById('explosion');

        let isReacted = false;

        // ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        function init() {
            updateValues();
            renderParticles(inputH2.value, inputO2.value, 0);
            updateGraph(inputH2.value, inputO2.value, 0);
            updatePiston(parseInt(inputH2.value) + parseInt(inputO2.value));
            
            inputH2.addEventListener('input', () => { if(!isReacted) updateValues(); });
            inputO2.addEventListener('input', () => { if(!isReacted) updateValues(); });
            
            document.getElementById('ignite-btn').addEventListener('click', runReaction);
            document.getElementById('reset-btn').addEventListener('click', resetExperiment);
        }

        function updateValues() {
            if(isReacted) return;
            const h2 = parseInt(inputH2.value);
            const o2 = parseInt(inputO2.value);
            valH2.textContent = `${h2} mL`;
            valO2.textContent = `${o2} mL`;
            
            // í€´ì¦ˆ ì—…ë°ì´íŠ¸
            quizQ.innerText = `ìˆ˜ì†Œ ${h2}mLì™€ ì‚°ì†Œ ${o2}mLê°€ ë°˜ì‘í•˜ë©´ ì–´ë–¤ ê¸°ì²´ê°€ ì–¼ë§ˆë‚˜ ë‚¨ì„ê¹Œìš”?`;
            
            renderParticles(h2, o2, 0);
            updatePiston(h2 + o2);
            updateGraph(h2, o2, 0);
            
            feedbackBox.style.display = 'none';
        }

        function renderParticles(h2Vol, o2Vol, waterCount) {
            particlesContainer.innerHTML = '';
            
            // ì‹œê°í™”ë¥¼ ìœ„í•´ ë¶€í”¼ë¥¼ ì…ì ìˆ˜ë¡œ ìŠ¤ì¼€ì¼ë§ (1mL = 1ê°œ ì…ìë¡œ ë‹¨ìˆœí™”í•˜ì—¬ í‘œí˜„)
            // ë°˜ì‘ í›„ì—ëŠ” ë¬¼ë°©ìš¸ì´ ë°”ë‹¥ì— ê³ ì´ê²Œ í‘œí˜„
            
            const areaWidth = particlesContainer.clientWidth;
            const areaHeight = particlesContainer.clientHeight;

            // ê¸°ì²´ ìƒíƒœ (ë¬´ì‘ìœ„ ìœ„ì¹˜)
            const addGas = (count, type) => {
                for(let i=0; i<count; i++) {
                    const p = document.createElement('div');
                    p.className = `particle ${type}`;
                    p.style.left = Math.random() * 90 + '%';
                    
                    // í”¼ìŠ¤í†¤ ì•„ë˜ ê³µê°„ì—ë§Œ ê¸°ì²´ ì¡´ì¬
                    const pistonTop = parseInt(piston.style.top || 0);
                    // ëŒ€ëµì ì¸ ê¸°ì²´ ê³µê°„ ì‹œë®¬ë ˆì´ì…˜
                    p.style.top = (Math.random() * 60 + 20) + '%'; 
                    
                    particlesContainer.appendChild(p);
                }
            };

            addGas(h2Vol, 'h2-particle');
            addGas(o2Vol, 'o2-particle');

            // ìƒì„±ëœ ë¬¼ (ë°”ë‹¥ì— ê³ ì„)
            for(let i=0; i<waterCount; i++) {
                const w = document.createElement('div');
                w.className = 'water-drop';
                w.style.left = Math.random() * 90 + '%';
                w.style.bottom = (Math.random() * 5) + '%'; // ë°”ë‹¥ì— ê¹”ë¦¼
                particlesContainer.appendChild(w);
            }
        }

        function updatePiston(totalGasVol) {
            // ìµœëŒ€ 60mL ê¸°ì¤€ìœ¼ë¡œ ë†’ì´ ê³„ì‚° (30+30)
            const maxVol = 60; 
            const containerHeight = 300;
            
            // ë¶€í”¼ê°€ í´ìˆ˜ë¡ í”¼ìŠ¤í†¤ì€ ìœ„ë¡œ(top ê°’ ì‘ìŒ), ì‘ì„ìˆ˜ë¡ ì•„ë˜ë¡œ(top ê°’ í¼)
            // totalGasVol 60 -> top 0
            // totalGasVol 0 -> top 280
            
            const percent = 1 - (totalGasVol / maxVol);
            // ìµœì†Œí•œì˜ ê³µê°„ì€ ë‚¨ê²¨ë‘ 
            const topPos = percent * (containerHeight - 40); 
            piston.style.top = `${topPos}px`;
        }

        function updateGraph(h2, o2, water) {
            const maxScale = 40; // ê·¸ë˜í”„ ìµœëŒ€ ë†’ì´ ê¸°ì¤€
            
            barH2.style.height = `${(h2 / maxScale) * 100}%`;
            barH2.querySelector('span').innerText = h2;
            
            barO2.style.height = `${(o2 / maxScale) * 100}%`;
            barO2.querySelector('span').innerText = o2;
            
            barWater.style.height = `${(water / maxScale) * 100}%`;
            barWater.querySelector('span').innerText = water; // ë¶„ì ìˆ˜ ê¸°ì¤€
        }

        function runReaction() {
            if(isReacted) return;
            isReacted = true;

            const startH2 = parseInt(inputH2.value);
            const startO2 = parseInt(inputO2.value);

            // ë°˜ì‘ ë…¼ë¦¬: 2 H2 + 1 O2 -> 2 H2O
            // ìˆ˜ì†Œ 2 : ì‚°ì†Œ 1 ë¹„ìœ¨ë¡œ ì†Œëª¨
            
            let usedH2, usedO2;
            
            if (startH2 >= startO2 * 2) {
                // ìˆ˜ì†Œê°€ ì¶©ë¶„í•˜ê±°ë‚˜ ë‚¨ìŒ (ì‚°ì†Œê°€ í•œê³„ ë°˜ì‘ë¬¼)
                usedO2 = startO2;
                usedH2 = startO2 * 2;
            } else {
                // ì‚°ì†Œê°€ ì¶©ë¶„í•˜ê±°ë‚˜ ë‚¨ìŒ (ìˆ˜ì†Œê°€ í•œê³„ ë°˜ì‘ë¬¼)
                usedH2 = startH2;
                usedO2 = startH2 / 2;
            }

            const remainH2 = startH2 - usedH2;
            const remainO2 = startO2 - usedO2;
            const producedWater = usedH2; // ìƒì„±ëœ ë¬¼ ë¶„ì ìˆ˜ëŠ” ë°˜ì‘í•œ ìˆ˜ì†Œ ë¶€í”¼ì™€ ë¹„ë¡€ (ë¶€í”¼ë¹„=ë¶„ììˆ˜ë¹„)

            // 1. í­ë°œ ì• ë‹ˆë©”ì´ì…˜
            explosion.style.opacity = 1;
            explosion.style.transition = "opacity 0.2s";
            setTimeout(() => { explosion.style.opacity = 0; }, 500);

            // 2. ê²°ê³¼ ì ìš© (1ì´ˆ ë’¤)
            setTimeout(() => {
                // ì…ì ë‹¤ì‹œ ê·¸ë¦¬ê¸° (ë‚¨ì€ ê¸°ì²´ + ë¬¼)
                renderParticles(remainH2, remainO2, producedWater);
                
                // í”¼ìŠ¤í†¤ ì´ë™ (ë‚¨ì€ ê¸°ì²´ ë¶€í”¼ë§Œí¼ë§Œ ê³µê°„ ì°¨ì§€, ë¬¼ì€ ì•¡ì²´ê°€ ë˜ì–´ ë¶€í”¼ ë¬´ì‹œ)
                updatePiston(remainH2 + remainO2);
                
                // ê·¸ë˜í”„ ì—…ë°ì´íŠ¸
                updateGraph(remainH2, remainO2, producedWater);

                // í”¼ë“œë°± ìƒì„±
                provideFeedback(startH2, startO2, remainH2, remainO2, producedWater);
                
                // ì…ë ¥ ë¹„í™œì„±í™” ì‹œê°ì  ì²˜ë¦¬
                inputH2.disabled = true;
                inputO2.disabled = true;
            }, 600);
        }

        function provideFeedback(startH2, startO2, rH2, rO2, water) {
            feedbackBox.style.display = 'block';
            
            let message = `<ul style="padding-left:20px; margin:5px 0;">`;
            message += `<li>ë°˜ì‘í•œ ìˆ˜ì†Œ: <b>${startH2 - rH2} mL</b></li>`;
            message += `<li>ë°˜ì‘í•œ ì‚°ì†Œ: <b>${startO2 - rO2} mL</b></li>`;
            
            // ë¹„ìœ¨ ê³„ì‚° ë° ì„¤ëª…
            const ratioCheck = (startH2 - rH2) / (startO2 - rO2);
            if (!isNaN(ratioCheck)) {
                message += `<li>ë°˜ì‘ ë¶€í”¼ë¹„ = <b>2 : 1</b> (ìˆ˜ì†Œ : ì‚°ì†Œ)</li>`;
            }

            message += `</ul><br>`;

            if (rH2 === 0 && rO2 === 0) {
                message += "ğŸŒŸ <b>ì™„ë²½í•œ ë°˜ì‘!</b> ë‚¨ì€ ê¸°ì²´ê°€ ì—†ìŠµë‹ˆë‹¤. ìˆ˜ì†Œì™€ ì‚°ì†Œë¥¼ ì •í™•íˆ 2:1 ë¹„ìœ¨ë¡œ ì„ìœ¼ì…¨ë„¤ìš”.";
            } else if (rH2 > 0) {
                message += `ğŸ§ <b>ìˆ˜ì†Œê°€ ${rH2}mL ë‚¨ì•˜ìŠµë‹ˆë‹¤.</b> ì‚°ì†Œê°€ ë¶€ì¡±í•˜ì—¬ ë” ì´ìƒ ë°˜ì‘í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.`;
            } else if (rO2 > 0) {
                message += `ğŸ§ <b>ì‚°ì†Œê°€ ${rO2}mL ë‚¨ì•˜ìŠµë‹ˆë‹¤.</b> ìˆ˜ì†Œê°€ ë¶€ì¡±í•˜ì—¬ ë” ì´ìƒ ë°˜ì‘í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.`;
            }

            message += `<br><small>ğŸ’¡ Tip: ìƒì„±ëœ ë¬¼ì€ ì•¡ì²´ ìƒíƒœê°€ ë˜ì–´ ë¶€í”¼ê°€ ê¸‰ê²©íˆ ì¤„ì–´ë“¤ê¸° ë•Œë¬¸ì—, í”¼ìŠ¤í†¤ì´ ë‚´ë ¤ê°‘ë‹ˆë‹¤.</small>`;
            
            feedbackText.innerHTML = message;
        }

        function resetExperiment() {
            isReacted = false;
            inputH2.disabled = false;
            inputO2.disabled = false;
            updateValues();
        }

        // ì‹œì‘
        init();
    </script>
</body>
</html>