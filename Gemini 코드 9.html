<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°€ìƒ ì‹¤í—˜: ê¸°ì²´ì˜ ì˜¨ë„ì™€ ë¶€í”¼ (ìƒ¤ë¥¼ì˜ ë²•ì¹™)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #4A90E2;
            --secondary-color: #FF6B6B;
            --bg-color: #f4f7f6;
            --panel-bg: #ffffff;
        }
        body {
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--bg-color);
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            max-width: 1200px;
            width: 100%;
            justify-content: center;
        }
        .panel {
            background: var(--panel-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        /* ì‹œë®¬ë ˆì´ì…˜ ì˜ì—­ */
        #sim-area {
            flex: 1;
            min-width: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        canvas#particleCanvas {
            border: 2px solid #333;
            border-radius: 4px;
            background: #fff;
            margin-top: 10px;
        }
        /* ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        #control-area {
            flex: 1;
            min-width: 300px;
        }
        .slider-group {
            margin: 20px 0;
        }
        label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
        }
        input[type=range] {
            width: 100%;
            cursor: pointer;
        }
        .data-display {
            display: flex;
            justify-content: space-around;
            background: #ecf0f1;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        .data-item {
            text-align: center;
        }
        .data-value {
            font-size: 1.2em;
            font-weight: bold;
            color: var(--primary-color);
        }
        /* ê·¸ë˜í”„ ì˜ì—­ */
        #graph-area {
            flex: 1;
            min-width: 300px;
            height: 300px;
        }
        .piston {
            width: 100%;
            height: 10px;
            background-color: #555;
            position: absolute;
            top: 0;
            transition: top 0.1s linear;
        }
        .fire-effect {
            text-align: center;
            font-size: 24px;
            height: 30px;
        }
        .explanation {
            margin-top: 10px;
            font-size: 0.9em;
            color: #666;
            background: #fff3cd;
            padding: 10px;
            border-radius: 5px;
        }
    </style>
</head>
<body>

    <h1>ğŸˆ ê¸°ì²´ì˜ ì˜¨ë„ì™€ ë¶€í”¼ (ìƒ¤ë¥¼ì˜ ë²•ì¹™)</h1>
    <p>ì˜¨ë„ë¥¼ ì¡°ì ˆí•˜ì—¬ ì…ìì˜ ìš´ë™ê³¼ ë¶€í”¼ ë³€í™”ë¥¼ ê´€ì°°í•´ë³´ì„¸ìš”.</p>

    <div class="container">
        <div id="sim-area" class="panel">
            <h3>ì‹¤í—˜ ì¥ì¹˜ (ì‹¤ë¦°ë” ë‚´ë¶€)</h3>
            <div style="position: relative;">
                <canvas id="particleCanvas" width="300" height="400"></canvas>
            </div>
            <div id="thermal-visual" class="fire-effect">ğŸŒ¡ï¸</div>
        </div>

        <div id="control-area" class="panel">
            <h3>ğŸ›ï¸ ì¡°ì‘ íŒ¨ë„</h3>
            
            <div class="data-display">
                <div class="data-item">
                    <div>ì˜¨ë„ (ì„­ì”¨)</div>
                    <div id="val-celsius" class="data-value">27 Â°C</div>
                </div>
                <div class="data-item">
                    <div>ì ˆëŒ€ì˜¨ë„</div>
                    <div id="val-kelvin" class="data-value">300 K</div>
                </div>
                <div class="data-item">
                    <div>ë¶€í”¼ (ìƒëŒ€ê°’)</div>
                    <div id="val-volume" class="data-value">1.0 L</div>
                </div>
            </div>

            <div class="slider-group">
                <label for="tempSlider">ì˜¨ë„ ì¡°ì ˆ (-273Â°C ~ 327Â°C)</label>
                <input type="range" id="tempSlider" min="-273" max="327" value="27">
            </div>

            <div class="explanation" id="feedback-text">
                í˜„ì¬ ìƒíƒœ: ì‹¤ì˜¨(27Â°C)ì…ë‹ˆë‹¤. ì…ìë“¤ì´ í™œë°œí•˜ê²Œ ì›€ì§ì´ê³  ìˆìŠµë‹ˆë‹¤.
            </div>
            
            <hr>
            <h4>ğŸ“‹ ì‹¤í—˜ ë…¸íŠ¸</h4>
            <p>1. ì˜¨ë„ë¥¼ ë†’ì´ë©´ ì…ìê°€ ë¹¨ë¼ì§€ê³  í”¼ìŠ¤í†¤ì´ ì˜¬ë¼ê°‘ë‹ˆë‹¤.<br>
            2. ì˜¨ë„ë¥¼ ë‚®ì¶”ë©´ ì…ìê°€ ëŠë ¤ì§€ê³  í”¼ìŠ¤í†¤ì´ ë‚´ë ¤ê°‘ë‹ˆë‹¤.<br>
            3. -273Â°C(0K)ì—ì„œëŠ” ì´ë¡ ìƒ ë¶€í”¼ê°€ 0ì´ ë©ë‹ˆë‹¤.</p>
        </div>

        <div id="graph-area" class="panel">
            <h3>ğŸ“ˆ V-T ê·¸ë˜í”„</h3>
            <canvas id="chartCanvas"></canvas>
        </div>
    </div>

    <script>
        // --- 1. ë³€ìˆ˜ ì„¤ì • ---
        const canvas = document.getElementById('particleCanvas');
        const ctx = canvas.getContext('2d');
        const tempSlider = document.getElementById('tempSlider');
        const valCelsius = document.getElementById('val-celsius');
        const valKelvin = document.getElementById('val-kelvin');
        const valVolume = document.getElementById('val-volume');
        const thermalVisual = document.getElementById('thermal-visual');
        const feedbackText = document.getElementById('feedback-text');

        // ìƒíƒœ ë³€ìˆ˜
        let temperatureC = 27; // ì„­ì”¨
        let temperatureK = 300; // ì ˆëŒ€ì˜¨ë„
        const minTempK = 10; // ì‹œê°í™”ë¥¼ ìœ„í•´ ìµœì†Œ 10K ìœ ì§€
        
        // ì…ì ì„¤ì •
        const particles = [];
        const numParticles = 30;
        const particleSize = 4;
        let containerHeight = 200; // ì´ˆê¸° ë†’ì´
        const containerWidth = canvas.width;
        const maxContainerHeight = canvas.height - 20;
        const baseVolumeFactor = 0.8; // ë¶€í”¼ ê³„ì‚°ìš© ê³„ìˆ˜

        // --- 2. ì´ˆê¸°í™” ---
        function initParticles() {
            for(let i=0; i<numParticles; i++) {
                particles.push({
                    x: Math.random() * containerWidth,
                    y: Math.random() * containerHeight,
                    vx: (Math.random() - 0.5) * 2,
                    vy: (Math.random() - 0.5) * 2
                });
            }
        }

        // ì°¨íŠ¸ ì„¤ì •
        const chartCtx = document.getElementById('chartCanvas').getContext('2d');
        const vtChart = new Chart(chartCtx, {
            type: 'line',
            data: {
                labels: [], // xì¶• (ì˜¨ë„)
                datasets: [{
                    label: 'ë¶€í”¼ (V)',
                    data: [], // yì¶• (ë¶€í”¼)
                    borderColor: '#4A90E2',
                    backgroundColor: 'rgba(74, 144, 226, 0.2)',
                    borderWidth: 2,
                    pointRadius: 0,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        title: { display: true, text: 'ì ˆëŒ€ì˜¨ë„ (K)' },
                        type: 'linear',
                        min: 0,
                        max: 600
                    },
                    y: {
                        title: { display: true, text: 'ë¶€í”¼ (L)' },
                        min: 0,
                        max: 2.5
                    }
                },
                animation: { duration: 0 }
            }
        });

        // --- 3. ë¬¼ë¦¬ ì—”ì§„ ë° ë Œë”ë§ ---
        function updatePhysics() {
            // ì˜¨ë„ ê³„ì‚°
            temperatureC = parseInt(tempSlider.value);
            temperatureK = temperatureC + 273;
            if (temperatureK < minTempK) temperatureK = minTempK;

            // ìƒ¤ë¥¼ì˜ ë²•ì¹™: V = k * T (ê°„ë‹¨í•œ ë¹„ë¡€ì‹ ì ìš©)
            // 300Kì¼ ë•Œ ë†’ì´ê°€ ì•½ 200pxì´ ë˜ë„ë¡ ì„¤ì •
            const targetHeight = (temperatureK / 300) * 200;
            
            // ë¶€ë“œëŸ¬ìš´ í”¼ìŠ¤í†¤ ì›€ì§ì„
            containerHeight += (targetHeight - containerHeight) * 0.1;
            if(containerHeight > maxContainerHeight) containerHeight = maxContainerHeight;
            if(containerHeight < 10) containerHeight = 10;

            // ì…ì ì†ë„ ì œì–´ (ì˜¨ë„ì˜ ì œê³±ê·¼ì— ë¹„ë¡€)
            const speedFactor = Math.sqrt(temperatureK) * 0.15;

            // í™”ë©´ ì—…ë°ì´íŠ¸ í…ìŠ¤íŠ¸
            valCelsius.textContent = `${temperatureC} Â°C`;
            valKelvin.textContent = `${temperatureK} K`;
            const volumeL = (containerHeight / 200).toFixed(2);
            valVolume.textContent = `${volumeL} L`;

            // ì‹œê°ì  í”¼ë“œë°±
            if(temperatureC > 100) thermalVisual.textContent = "ğŸ”¥ğŸ”¥ğŸ”¥ (ê°€ì—´ ì¤‘)";
            else if(temperatureC < 0) thermalVisual.textContent = "ğŸ§ŠğŸ§ŠğŸ§Š (ëƒ‰ê° ì¤‘)";
            else thermalVisual.textContent = "ğŸŒ¡ï¸ (ì‹¤ì˜¨)";

            // ì„¤ëª… í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            if (temperatureK <= 50) {
                feedbackText.innerHTML = "<b>[ê·¹ì €ì˜¨]</b> ì…ìì˜ ìš´ë™ì´ ê±°ì˜ ë©ˆì¶”ê³  ë¶€í”¼ê°€ ë§¤ìš° ì‘ìŠµë‹ˆë‹¤.";
            } else if (temperatureC > 200) {
                feedbackText.innerHTML = "<b>[ê³ ì˜¨]</b> ì…ìê°€ ë§¤ìš° ë¹ ë¦…ë‹ˆë‹¤! ì¶©ëŒì´ ê°•í•´ì ¸ ë¶€í”¼ê°€ í¬ê²Œ ëŠ˜ì–´ë‚¬ìŠµë‹ˆë‹¤.";
            } else {
                feedbackText.innerHTML = "ì˜¨ë„ë¥¼ ë³€í™”ì‹œí‚¤ë©° ì…ì ì†ë„ì™€ ë¶€í”¼ ë³€í™”ë¥¼ ê´€ì°°í•˜ì„¸ìš”.";
            }

            // ê·¸ë˜í”„ ë°ì´í„° ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ (í˜„ì¬ ì ë§Œ í‘œì‹œí•˜ê±°ë‚˜ ê¶¤ì  í‘œì‹œ ê°€ëŠ¥, ì—¬ê¸°ì„  í˜„ì¬ ì )
            // ì„±ëŠ¥ì„ ìœ„í•´ ë°ì´í„°ì…‹ ì „ì²´ë¥¼ ê³„ì† ë‹¤ì‹œ ê·¸ë¦¬ëŠ” ëŒ€ì‹ , í¬ì¸íŠ¸ í•˜ë‚˜ë¥¼ ê°•ì¡°í•˜ëŠ” ë°©ì‹ ì‚¬ìš© ê°€ëŠ¥
            // ì—¬ê¸°ì„œëŠ” ë‹¨ìˆœí™”ë¥¼ ìœ„í•´ í˜„ì¬ ìƒíƒœë¥¼ ì°¨íŠ¸ì— ë°˜ì˜í•˜ì§€ ì•Šê³ , ë¯¸ë¦¬ ê³„ì‚°ëœ ìƒ¤ë¥¼ì˜ ë²•ì¹™ ë¼ì¸ì„ ë³´ì—¬ì£¼ëŠ”ê²Œ êµìœ¡ì ìœ¼ë¡œ ë‚˜ì„ ìˆ˜ ìˆìŒ.
            // í•˜ì§€ë§Œ ìš”ì²­ì‚¬í•­ì¸ 'ì‹¤ì‹œê°„ ì‹œê°í™”'ë¥¼ ìœ„í•´ í˜„ì¬ ê°’ì„ í¬ì¸íŠ¸ë¡œ ì¶”ê°€í•´ë´„.
            
            if(vtChart.data.datasets[0].data.length > 50) vtChart.data.datasets[0].data.shift();
            // vtChart.data.datasets[0].data.push({x: temperatureK, y: volumeL}); // ê¶¤ì  ê·¸ë¦¬ê¸°
            // vtChart.update();
        }

        // ì´ˆê¸° ê·¸ë˜í”„ ë¼ì¸ ê·¸ë¦¬ê¸° (ì´ìƒì ì¸ ìƒ¤ë¥¼ì˜ ë²•ì¹™)
        function drawIdealGraph() {
            const data = [];
            for(let t=0; t<=600; t+=50) {
                data.push({x: t, y: (t/300) * 1.0}); // 300Kì¼ ë•Œ 1.0L ê¸°ì¤€
            }
            vtChart.data.datasets[0].data = data;
            
            // í˜„ì¬ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” í¬ì¸íŠ¸ ì¶”ê°€ (ë‘ ë²ˆì§¸ ë°ì´í„°ì…‹)
            vtChart.data.datasets.push({
                label: 'í˜„ì¬ ìƒíƒœ',
                data: [{x: temperatureK, y: (containerHeight/200)}],
                borderColor: '#FF6B6B',
                backgroundColor: '#FF6B6B',
                pointRadius: 6,
                type: 'scatter'
            });
            vtChart.update();
        }

        function draw() {
            // ë°°ê²½ ì§€ìš°ê¸°
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // ì‹¤ë¦°ë”(ì»¨í…Œì´ë„ˆ) ê·¸ë¦¬ê¸°
            ctx.fillStyle = '#f0f8ff';
            ctx.fillRect(0, canvas.height - containerHeight, containerWidth, containerHeight);
            
            // í”¼ìŠ¤í†¤ ê·¸ë¦¬ê¸°
            ctx.fillStyle = '#7f8c8d';
            ctx.fillRect(0, canvas.height - containerHeight - 10, containerWidth, 10);
            
            // ì…ì ê·¸ë¦¬ê¸°
            ctx.fillStyle = '#e74c3c';
            const speedFactor = Math.sqrt(temperatureK) * 0.15;

            particles.forEach(p => {
                // ìœ„ì¹˜ ì—…ë°ì´íŠ¸
                p.x += p.vx * speedFactor;
                p.y += p.vy * speedFactor;

                // ë²½ ì¶©ëŒ (Xì¶•)
                if(p.x < 0 || p.x > containerWidth) p.vx *= -1;
                
                // ë°”ë‹¥ ì¶©ëŒ
                if(p.y > canvas.height) p.vy *= -1;

                // í”¼ìŠ¤í†¤ ì¶©ëŒ (ìœ„ìª½ ë²½)
                // í”¼ìŠ¤í†¤ì˜ ì•„ë«ë©´ ìœ„ì¹˜: canvas.height - containerHeight
                const pistonBottom = canvas.height - containerHeight;
                if(p.y < pistonBottom) {
                    p.y = pistonBottom; // ìœ„ì¹˜ ë³´ì •
                    p.vy *= -1;
                }

                // ê·¸ë¦¬ê¸°
                ctx.beginPath();
                ctx.arc(p.x, p.y, particleSize, 0, Math.PI*2);
                ctx.fill();
            });

            // í˜„ì¬ ìƒíƒœ ê·¸ë˜í”„ ì—…ë°ì´íŠ¸
            vtChart.data.datasets[1].data[0] = {
                x: temperatureK, 
                y: parseFloat((containerHeight / 200).toFixed(2))
            };
            vtChart.update('none'); // ì• ë‹ˆë©”ì´ì…˜ ì—†ì´ ì—…ë°ì´íŠ¸

            requestAnimationFrame(draw);
            updatePhysics();
        }

        // --- 4. ì‹¤í–‰ ---
        initParticles();
        drawIdealGraph();
        draw();

    </script>
</body>
</html>