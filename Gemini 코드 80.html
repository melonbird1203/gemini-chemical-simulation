<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°€ìƒ ì‹¤í—˜: í¡ì—´ ë°˜ì‘ ì† ëƒ‰ì¥ê³ </title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --danger-color: #e74c3c;
            --bg-color: #f4f7f6;
            --panel-bg: #ffffff;
        }
        body {
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: var(--panel-bg);
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 30px;
        }
        header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #eee;
            padding-bottom: 20px;
        }
        h1 { color: var(--primary-color); margin: 0; }
        .subtitle { color: #666; font-size: 1.1em; margin-top: 10px; }
        
        .experiment-layout {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        /* ì œì–´ íŒ¨ë„ */
        .control-panel {
            flex: 1;
            min-width: 300px;
            background: #f9fbff;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #e1e8ed;
        }
        .control-group { margin-bottom: 20px; }
        label { display: block; font-weight: bold; margin-bottom: 8px; }
        input[type="range"] { width: 100%; cursor: pointer; }
        .value-display { font-weight: bold; color: var(--primary-color); float: right; }
        
        .btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
            margin-bottom: 10px;
        }
        .btn-start { background-color: var(--primary-color); color: white; }
        .btn-start:hover { background-color: #2980b9; }
        .btn-reset { background-color: #95a5a6; color: white; }
        .btn-reset:hover { background-color: #7f8c8d; }

        /* ì‹œê°í™” ì˜ì—­ */
        .visualization-panel {
            flex: 2;
            min-width: 400px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .visual-container {
            position: relative;
            height: 250px;
            background: #eef2f3;
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid #ccc;
        }

        /* ë¹„ì»¤/ì§€í¼ë°± ì‹œê°í™” */
        .beaker {
            width: 150px;
            height: 200px;
            border: 4px solid #aaa;
            border-top: none;
            border-radius: 0 0 20px 20px;
            position: relative;
            background: rgba(255, 255, 255, 0.5);
            overflow: hidden;
        }
        .liquid {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 60%; /* ë™ì  ë³€ê²½ */
            background: rgba(52, 152, 219, 0.3);
            transition: height 0.5s, background-color 1s;
        }
        .particles-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        .thermometer-display {
            position: absolute;
            top: 10px;
            right: 10px;
            background: white;
            padding: 10px;
            border-radius: 8px;
            border: 2px solid #333;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 1.2em;
        }

        .chart-container {
            height: 200px;
            background: white;
            border-radius: 10px;
            padding: 10px;
            border: 1px solid #eee;
        }

        /* í”¼ë“œë°± ë° í€´ì¦ˆ */
        .feedback-section {
            margin-top: 30px;
            padding: 20px;
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            border-radius: 5px;
            display: none; /* ì‹¤í—˜ í›„ í‘œì‹œ */
        }
        .safety-note {
            margin-top: 20px;
            font-size: 0.9em;
            color: #7f8c8d;
            background: #f0f0f0;
            padding: 10px;
            border-radius: 5px;
        }
        .quiz-section {
            margin-top: 20px;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸ§Š í¡ì—´ ë°˜ì‘ ì† ëƒ‰ì¥ê³  ë§Œë“¤ê¸°</h1>
        <p class="subtitle">ì§ˆì‚° ì•”ëª¨ëŠ„ê³¼ ë¬¼ì´ ë§Œë‚˜ë©´ ì—ë„ˆì§€ëŠ” ì–´ë–»ê²Œ ë³€í• ê¹Œìš”?</p>
    </header>

    <div class="experiment-layout">
        <div class="control-panel">
            <h3>ğŸ›ï¸ ì‹¤í—˜ ì¡°ê±´ ì„¤ì •</h3>
            
            <div class="control-group">
                <label>ë¬¼ì˜ ì–‘ (ìš©ë§¤) <span id="val-water" class="value-display">50 mL</span></label>
                <input type="range" id="range-water" min="20" max="100" value="50" step="10">
            </div>

            <div class="control-group">
                <label>ì§ˆì‚° ì•”ëª¨ëŠ„ ì–‘ (ìš©ì§ˆ) <span id="val-nitrate" class="value-display">10 g</span></label>
                <input type="range" id="range-nitrate" min="0" max="100" value="10" step="5">
            </div>

            <div class="control-group">
                <label>ì´ˆê¸° ë¬¼ ì˜¨ë„ <span id="val-temp" class="value-display">25 Â°C</span></label>
                <input type="range" id="range-temp" min="15" max="35" value="25" step="1">
            </div>

            <button class="btn btn-start" onclick="startExperiment()">âš—ï¸ ì‹¤í—˜ ì‹œì‘í•˜ê¸°</button>
            <button class="btn btn-reset" onclick="resetExperiment()">ğŸ”„ ì´ˆê¸°í™”</button>

            <div class="safety-note">
                âš ï¸ <strong>ì•ˆì „ ì£¼ì˜ì‚¬í•­:</strong><br>
                ì‹¤ì œ ì‹¤í—˜ ì‹œ ì§ˆì‚° ì•”ëª¨ëŠ„ì€ ë¹„ë£Œ ì„±ë¶„ì´ì§€ë§Œ ë¨¹ìœ¼ë©´ ì•ˆ ë©ë‹ˆë‹¤. ì‹¤í—˜ í›„ì—ëŠ” ë°˜ë“œì‹œ ì†ì„ ì”»ìœ¼ì„¸ìš”.
            </div>
        </div>

        <div class="visualization-panel">
            <div class="visual-container">
                <div class="beaker">
                    <div class="liquid" id="liquid-display"></div>
                    <canvas id="particle-canvas" width="150" height="200"></canvas>
                </div>
                <div class="thermometer-display">
                    ğŸŒ¡ï¸ <span id="current-temp-display">25.0</span>Â°C
                </div>
            </div>

            <div class="chart-container">
                <canvas id="tempChart"></canvas>
            </div>
        </div>
    </div>

    <div id="feedback-area" class="feedback-section">
        <h3>ğŸ’¡ ì‹¤í—˜ ê²°ê³¼ ë¶„ì„</h3>
        <p id="feedback-text">ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</p>
        
        <div class="quiz-section">
            <h4>ğŸ¤” ìƒê°í•´ë³´ê¸°</h4>
            <p><strong>Q. ë¹„ë‹ íŒ©ì˜ ì˜¨ë„ê°€ ë‚´ë ¤ê°„ ì´ìœ ëŠ” ë¬´ì—‡ì¼ê¹Œìš”?</strong></p>
            <select id="quiz-answer" style="padding: 8px; width: 100%; margin-bottom: 10px;">
                <option value="">ë‹µë³€ì„ ì„ íƒí•˜ì„¸ìš”</option>
                <option value="1">ì§ˆì‚° ì•”ëª¨ëŠ„ì´ ì—´ì„ ë°©ì¶œí–ˆê¸° ë•Œë¬¸ì´ë‹¤.</option>
                <option value="2">ì§ˆì‚° ì•”ëª¨ëŠ„ì´ ë¬¼ì— ë…¹ìœ¼ë©° ì£¼ë³€ì˜ ì—´ì„ í¡ìˆ˜í–ˆê¸° ë•Œë¬¸ì´ë‹¤.</option>
                <option value="3">ë¬¼ì´ ì–¼ìŒìœ¼ë¡œ ë³€í–ˆê¸° ë•Œë¬¸ì´ë‹¤.</option>
            </select>
            <button class="btn" style="background:#2ecc71; color:white; width: auto;" onclick="checkAnswer()">ì •ë‹µ í™•ì¸</button>
            <p id="quiz-result"></p>
        </div>
    </div>
</div>

<script>
    // --- ë³€ìˆ˜ ë° ì„¤ì • ---
    let waterMass = 50;
    let nitrateMass = 10;
    let startTemp = 25;
    let currentTemp = 25;
    let isRunning = false;
    let intervalId = null;
    let particleAnimationId = null;
    
    // ì°¨íŠ¸ ì„¤ì •
    const ctx = document.getElementById('tempChart').getContext('2d');
    let tempChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: [],
            datasets: [{
                label: 'ì˜¨ë„ (Â°C)',
                data: [],
                borderColor: '#e74c3c', // ì˜¨ë„ë‹ˆê¹Œ ë¹¨ê°„ìƒ‰ ê³„ì—´
                tension: 0.4,
                pointRadius: 0
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: { title: { display: true, text: 'ì‹œê°„ (ì´ˆ)' } },
                y: { title: { display: true, text: 'ì˜¨ë„ (Â°C)' }, min: 0, max: 40 }
            },
            animation: false
        }
    });

    // --- UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜ ---
    function updateUIValues() {
        document.getElementById('val-water').innerText = waterMass + " mL";
        document.getElementById('val-nitrate').innerText = nitrateMass + " g";
        document.getElementById('val-temp').innerText = startTemp + " Â°C";
        document.getElementById('current-temp-display').innerText = currentTemp.toFixed(1);
        
        // ìˆ˜ë©´ ë†’ì´ ì¡°ì ˆ (ë‹¨ìˆœ ì‹œê°í™”)
        const totalVol = parseInt(waterMass) + (parseInt(nitrateMass) * 0.5); 
        const heightPercent = Math.min((totalVol / 150) * 100, 95); 
        document.getElementById('liquid-display').style.height = heightPercent + "%";
    }

    // ìŠ¬ë¼ì´ë” ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    document.getElementById('range-water').addEventListener('input', (e) => {
        if(!isRunning) { waterMass = e.target.value; startTemp = document.getElementById('range-temp').value; currentTemp = parseFloat(startTemp); updateUIValues(); }
    });
    document.getElementById('range-nitrate').addEventListener('input', (e) => {
        if(!isRunning) { nitrateMass = e.target.value; updateUIValues(); }
    });
    document.getElementById('range-temp').addEventListener('input', (e) => {
        if(!isRunning) { startTemp = e.target.value; currentTemp = parseFloat(startTemp); updateUIValues(); }
    });

    // --- ì‹¤í—˜ ë¡œì§ ---
    function startExperiment() {
        if (isRunning) return;
        isRunning = true;
        
        // ì´ˆê¸°í™”
        resetChart();
        document.getElementById('feedback-area').style.display = 'none';
        
        // ìµœì¢… ì˜¨ë„ ê³„ì‚° (ê°„ëµí™”ëœ ëª¨ë¸)
        // ì‹¤ì œë¡œëŠ” ìš©í•´ì—´ ê³µì‹ì´ ë³µì¡í•˜ì§€ë§Œ, ì¤‘í•™ìƒìš© ëª¨ë¸ë§ìœ¼ë¡œ ê·¼ì‚¬ì¹˜ ì‚¬ìš©
        // ì§ˆì‚°ì•”ëª¨ëŠ„ ìš©í•´ì—´ì€ í¡ì—´(+). ìš©ì§ˆì´ ë§ì„ìˆ˜ë¡, ìš©ë§¤ê°€ ì ì„ìˆ˜ë¡ ì˜¨ë„ í•˜ê°•í­ í¼.
        const maxDrop = 20; // ìµœëŒ€ í•˜ê°• í­ ì œí•œ
        const concentrationFactor = nitrateMass / (parseInt(waterMass) + parseInt(nitrateMass));
        const tempDrop = concentrationFactor * 40; // ì„ì˜ì˜ ìƒìˆ˜ 40 ê³±í•¨
        const targetTemp = Math.max(startTemp - tempDrop, 2); // 2ë„ ì´í•˜ë¡œëŠ” ì˜ ì•ˆë–¨ì–´ì§€ê²Œ ì„¤ì •

        let time = 0;
        
        // ì‹œë®¬ë ˆì´ì…˜ ë£¨í”„
        intervalId = setInterval(() => {
            time++;
            
            // ì˜¨ë„ ë³€í™” ë¡œì§ (ì§€ìˆ˜ í•¨ìˆ˜ì ìœ¼ë¡œ ëª©í‘œ ì˜¨ë„ì— ë„ë‹¬)
            let diff = targetTemp - currentTemp;
            currentTemp += diff * 0.1; // 10%ì”© ì ‘ê·¼
            
            // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            tempChart.data.labels.push(time);
            tempChart.data.datasets[0].data.push(currentTemp);
            if(tempChart.data.labels.length > 20) { // xì¶• ìŠ¤í¬ë¡¤ íš¨ê³¼
                tempChart.options.scales.x.min = tempChart.data.labels.length - 20;
                tempChart.options.scales.x.max = tempChart.data.labels.length;
            }
            tempChart.update();
            
            // ì˜¨ë„ê³„ ë° ì…ì ì†ë„ ì—…ë°ì´íŠ¸
            document.getElementById('current-temp-display').innerText = currentTemp.toFixed(1);
            
            // ìƒ‰ìƒ ë³€í™” (ì˜¨ë„ê°€ ë‚®ì•„ì§€ë©´ íŒŒë€ìƒ‰ì´ ì§„í•´ì§ - ì‹œì˜¨ ì‰í¬ íš¨ê³¼ ê°€ì •)
            const blueIntensity = Math.min(0.3 + (30 - currentTemp)/40, 0.8);
            document.getElementById('liquid-display').style.backgroundColor = `rgba(52, 152, 219, ${blueIntensity})`;

            // ì¢…ë£Œ ì¡°ê±´ (ë³€í™”ê°€ ë¯¸ë¯¸í•  ë•Œ)
            if (Math.abs(diff) < 0.1 || time > 60) {
                finishExperiment(targetTemp);
            }
        }, 200); // 0.2ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸

        startParticleAnimation();
    }

    function finishExperiment(finalTemp) {
        clearInterval(intervalId);
        isRunning = false;
        
        // ê²°ê³¼ ë¶„ì„ ë° í”¼ë“œë°± í‘œì‹œ
        const drop = (startTemp - finalTemp).toFixed(1);
        const feedbackDiv = document.getElementById('feedback-area');
        const feedbackText = document.getElementById('feedback-text');
        
        feedbackDiv.style.display = 'block';
        
        let msg = `ì‹¤í—˜ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! <strong>ì˜¨ë„ê°€ ${drop}Â°C ë§Œí¼ ë‚´ë ¤ê°”ìŠµë‹ˆë‹¤.</strong><br>`;
        if (drop > 10) {
            msg += "ì™€ìš°! ê½¤ ì„±ëŠ¥ì´ ì¢‹ì€ ì† ëƒ‰ì¥ê³ ê°€ ë§Œë“¤ì–´ì¡Œë„¤ìš”! ì§ˆì‚° ì•”ëª¨ëŠ„ì„ ì¶©ë¶„íˆ ë„£ì–´ì„œ í¡ì—´ ë°˜ì‘ì´ í™œë°œí•˜ê²Œ ì¼ì–´ë‚¬ìŠµë‹ˆë‹¤.";
        } else if (drop > 5) {
            msg += "ì˜¨ë„ê°€ ì¡°ê¸ˆ ë‚´ë ¤ê°”ìŠµë‹ˆë‹¤. ë” ì°¨ê°‘ê²Œ ë§Œë“œë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”? (íŒíŠ¸: ë¬¼ì˜ ì–‘ì„ ì¤„ì´ê±°ë‚˜ ê°€ë£¨ë¥¼ ë” ë„£ì–´ë³´ì„¸ìš”)";
        } else {
            msg += "ì˜¨ë„ ë³€í™”ê°€ í¬ì§€ ì•ŠìŠµë‹ˆë‹¤. ì§ˆì‚° ì•”ëª¨ëŠ„ì˜ ì–‘ì´ ë„ˆë¬´ ì ì—ˆë˜ ê²ƒ ê°™ë„¤ìš”.";
        }
        
        msg += "<br><br>ì…ì ëª¨í˜•ì„ ë³´ì„¸ìš”. ë°˜ì‘ ì „ë³´ë‹¤ ì…ìë“¤ì˜ ì›€ì§ì„ì´ ì–´ë–»ê²Œ ë³€í–ˆë‚˜ìš”?";
        feedbackText.innerHTML = msg;
    }

    function resetExperiment() {
        clearInterval(intervalId);
        cancelAnimationFrame(particleAnimationId);
        isRunning = false;
        currentTemp = parseFloat(startTemp);
        
        resetChart();
        updateUIValues();
        document.getElementById('feedback-area').style.display = 'none';
        
        // ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
        const canvas = document.getElementById('particle-canvas');
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        document.getElementById('quiz-result').innerText = "";
        document.getElementById('quiz-answer').value = "";
    }

    function resetChart() {
        tempChart.data.labels = [];
        tempChart.data.datasets[0].data = [];
        tempChart.options.scales.x.min = undefined;
        tempChart.options.scales.x.max = undefined;
        tempChart.update();
    }

    function checkAnswer() {
        const val = document.getElementById('quiz-answer').value;
        const resultP = document.getElementById('quiz-result');
        if (val === "2") {
            resultP.innerHTML = "<span style='color:blue'>â­• ì •ë‹µì…ë‹ˆë‹¤!</span><br>ì§ˆì‚° ì•”ëª¨ëŠ„ì´ ë¬¼ì— ë…¹ëŠ” ê³¼ì •ì€ ì—ë„ˆì§€ë¥¼ í•„ìš”ë¡œ í•˜ëŠ” 'í¡ì—´ ë°˜ì‘'ì…ë‹ˆë‹¤. ì£¼ë³€(ë¬¼)ì˜ ì—ë„ˆì§€ë¥¼ ëºì–´ì˜¤ê¸° ë•Œë¬¸ì— ë¬¼ì˜ ì˜¨ë„ê°€ ë‚´ë ¤ê°‘ë‹ˆë‹¤.";
        } else {
            resultP.innerHTML = "<span style='color:red'>âŒ ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”.</span><br>ì˜¨ë„ê°€ ë‚´ë ¤ê°”ë‹¤ëŠ” ê²ƒì€ ì£¼ë³€ì˜ ì—´ì—ë„ˆì§€ê°€ ì–´ë”˜ê°€ë¡œ í¡ìˆ˜ë˜ì—ˆë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤.";
        }
    }

    // --- ì…ì ì• ë‹ˆë©”ì´ì…˜ (Canvas) ---
    // ì˜¨ë„ê°€ ë†’ìœ¼ë©´ ë¹ ë¥´ê³ , ë‚®ìœ¼ë©´ ëŠë¦¬ê²Œ ì›€ì§ì„
    const pCanvas = document.getElementById('particle-canvas');
    const pCtx = pCanvas.getContext('2d');
    
    let particles = [];
    
    function initParticles() {
        particles = [];
        for(let i=0; i<30; i++) {
            particles.push({
                x: Math.random() * pCanvas.width,
                y: Math.random() * pCanvas.height,
                vx: (Math.random() - 0.5) * 2,
                vy: (Math.random() - 0.5) * 2,
                color: '#888' // ì´ˆê¸° ìƒ‰ìƒ
            });
        }
    }
    
    function startParticleAnimation() {
        initParticles();
        animateParticles();
    }

    function animateParticles() {
        if (!isRunning) return;
        
        pCtx.clearRect(0, 0, pCanvas.width, pCanvas.height);
        
        // ì˜¨ë„ì— ë¹„ë¡€í•œ ì†ë„ ê³„ìˆ˜ (ì˜¨ë„ê°€ ë‚®ì„ìˆ˜ë¡ ì›€ì§ì„ ë‘”í™”)
        // ì„­ì”¨ 0ë„ ~ 40ë„ ë²”ìœ„ë¥¼ 0.2 ~ 1.0 ì†ë„ë¡œ ë§¤í•‘
        const speedFactor = Math.max(0.2, currentTemp / 40); 

        particles.forEach(p => {
            p.x += p.vx * speedFactor;
            p.y += p.vy * speedFactor;

            // ë²½ íŠ€ê¸°ê¸°
            if(p.x < 0 || p.x > pCanvas.width) p.vx *= -1;
            if(p.y < 0 || p.y > pCanvas.height) p.vy *= -1;

            // ê·¸ë¦¬ê¸°
            pCtx.beginPath();
            pCtx.arc(p.x, p.y, 3, 0, Math.PI * 2);
            // ì—ë„ˆì§€ê°€ ë‚®ì•„ì§(í¡ì—´ë¨) -> íŒŒë€ìƒ‰ ê³„ì—´ë¡œ ì…ì ìƒ‰ ë³€í™” í‘œí˜„
            pCtx.fillStyle = currentTemp < 15 ? '#3498db' : '#e74c3c'; 
            pCtx.fill();
        });

        particleAnimationId = requestAnimationFrame(animateParticles);
    }
    
    // ì´ˆê¸° ë¡œë“œ ì‹œ ê°’ ì„¸íŒ…
    updateUIValues();
</script>

</body>
</html>