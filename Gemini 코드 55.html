<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°€ìƒ ì‹¤í—˜ì‹¤: í¬ë¡œë§ˆí† ê·¸ë˜í”¼</title>
    <style>
        :root {
            --primary-color: #4a90e2;
            --bg-color: #f4f7f6;
            --panel-bg: #ffffff;
        }
        body {
            font-family: 'Malgun Gothic', sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1 { color: #333; margin-bottom: 10px; }
        .container {
            display: flex;
            gap: 20px;
            max-width: 1200px;
            width: 100%;
            flex-wrap: wrap;
            justify-content: center;
        }
        /* ì œì–´ íŒ¨ë„ ìŠ¤íƒ€ì¼ */
        .control-panel, .result-panel {
            background: var(--panel-bg);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            width: 300px;
            flex-shrink: 0;
        }
        .control-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #555; }
        select, button, input[type="range"] {
            width: 100%;
            padding: 10px;
            border-radius: 6px;
            border: 1px solid #ddd;
            margin-bottom: 5px;
        }
        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s;
        }
        button:hover { background-color: #357abd; }
        button.reset { background-color: #e74c3c; margin-top: 10px;}
        
        /* ì‹¤í—˜ ì˜ì—­ ìŠ¤íƒ€ì¼ */
        .lab-area {
            position: relative;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        canvas {
            border: 1px solid #ccc;
            background: #f9f9f9; /* ë°°ê²½ìƒ‰ */
            cursor: crosshair;
        }
        .info-box {
            margin-top: 10px;
            padding: 10px;
            background: #eef;
            border-left: 4px solid var(--primary-color);
            font-size: 0.9rem;
            width: 100%;
            box-sizing: border-box;
        }

        /* ê²°ê³¼ í…Œì´ë¸” */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            font-size: 0.9rem;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        th { background-color: #f2f2f2; }
        
        .feedback {
            margin-top: 15px;
            font-weight: bold;
            color: #2c3e50;
            white-space: pre-line;
        }
    </style>
</head>
<body>

    <h1>âš—ï¸ í¬ë¡œë§ˆí† ê·¸ë˜í”¼ í˜¼í•©ë¬¼ ë¶„ë¦¬ ì‹¤í—˜</h1>
    <p>ìš©ë§¤ì™€ ê±°ë¦„ì¢…ì´ë¥¼ ì„ íƒí•˜ê³  ìƒ‰ì†Œê°€ ì–´ë–»ê²Œ ë¶„ë¦¬ë˜ëŠ”ì§€ ê´€ì°°í•˜ë©° Rf ê°’ì„ ê³„ì‚°í•´ë´…ì‹œë‹¤.</p>

    <div class="container">
        <div class="control-panel">
            <h3>ğŸ§ª ì‹¤í—˜ ì¡°ê±´ ì„¤ì •</h3>
            
            <div class="control-group">
                <label for="solvent">ìš©ë§¤ ì¢…ë¥˜</label>
                <select id="solvent">
                    <option value="water">ë¬¼ (ê·¹ì„± ìš©ë§¤)</option>
                    <option value="ethanol">ì—íƒ„ì˜¬ (ìœ ê¸° ìš©ë§¤)</option>
                </select>
            </div>

            <div class="control-group">
                <label for="ink">ì‚¬ì¸íœ ì¢…ë¥˜</label>
                <select id="ink">
                    <option value="water_black">ìˆ˜ì„± ì‚¬ì¸íœ (ê²€ì •)</option>
                    <option value="perm_black">ìœ ì„± ì‚¬ì¸íœ (ê²€ì •)</option>
                    <option value="water_red">ìˆ˜ì„± ì‚¬ì¸íœ (ë¹¨ê°•)</option>
                    <option value="mix_green">ì‹ìš© ìƒ‰ì†Œ (ì´ˆë¡ í˜¼í•©)</option>
                </select>
            </div>

            <div class="control-group">
                <label for="paper">ì¢…ì´ ì¢…ë¥˜</label>
                <select id="paper">
                    <option value="filter">ê±°ë¦„ì¢…ì´ (í‘œì¤€)</option>
                    <option value="chalk">ë¶„í•„ (í¡ìˆ˜ ë¹ ë¦„)</option>
                </select>
            </div>

            <button onclick="startExperiment()">ì‹¤í—˜ ì‹œì‘ â–¶</button>
            <button class="reset" onclick="resetExperiment()">ì´ˆê¸°í™” â†º</button>
            
            <div class="info-box">
                <strong>ğŸ’¡ Tip:</strong> ìœ ì„± ì‚¬ì¸íœì€ ë¬¼ì— ë…¹ì„ê¹Œìš”? ìš©ë§¤ë¥¼ ë°”ê¿”ê°€ë©° ì‹¤í—˜í•´ë³´ì„¸ìš”!
            </div>
        </div>

        <div class="lab-area">
            <canvas id="simCanvas" width="300" height="500"></canvas>
            <div id="statusMessage" style="margin-top:10px; color:#666;">ì¤€ë¹„ ì™„ë£Œ</div>
        </div>

        <div class="result-panel">
            <h3>ğŸ“Š ì‹¤í—˜ ê²°ê³¼ ë°ì´í„°</h3>
            <p><strong>Rf ê°’(ì „ê°œìœ¨) ê³„ì‚°ì‹:</strong><br>
            $$Rf = \frac{\text{ìƒ‰ì†Œ ì´ë™ ê±°ë¦¬}}{\text{ìš©ë§¤ ì´ë™ ê±°ë¦¬}}$$</p>
            
            <table>
                <thead>
                    <tr>
                        <th>ì„±ë¶„ ìƒ‰ì†Œ</th>
                        <th>ì´ë™ ê±°ë¦¬</th>
                        <th>Rf ê°’</th>
                    </tr>
                </thead>
                <tbody id="resultBody">
                    <tr><td colspan="3">ì‹¤í—˜ì„ ì‹œì‘í•˜ì„¸ìš”</td></tr>
                </tbody>
            </table>

            <div class="feedback" id="feedbackArea"></div>
            
            <div style="margin-top:20px; border-top:1px solid #eee; padding-top:10px;">
                <h4>ğŸ“ í™•ì¸ í€´ì¦ˆ</h4>
                <div id="quizSection">
                    <p id="quizQuestion">ì‹¤í—˜ í›„ í€´ì¦ˆê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.</p>
                    <button onclick="checkAnswer()" id="quizBtn" style="display:none; margin-top:5px;">ì •ë‹µ í™•ì¸</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        const resultBody = document.getElementById('resultBody');
        const feedbackArea = document.getElementById('feedbackArea');
        const statusMsg = document.getElementById('statusMessage');

        let isRunning = false;
        let animationId;
        let solventY = 450; // ìš©ë§¤ ì‹œì‘ ë†’ì´ (ìº”ë²„ìŠ¤ ë°”ë‹¥ ê·¼ì²˜)
        const baselineY = 400; // ì›ì  ë¼ì¸
        const maxSolventHeight = 50; // ìš©ë§¤ê°€ ì˜¬ë¼ê°ˆ ìµœëŒ€ ë†’ì´
        
        let components = [];
        let solventSpeed = 0.5;
        let solventFront = baselineY; // í˜„ì¬ ìš©ë§¤ ì „ì„  ìœ„ì¹˜

        // ì‰í¬ ë°ì´í„°ë² ì´ìŠ¤
        const inkData = {
            'water_black': {
                name: 'ìˆ˜ì„± ê²€ì •',
                components: [
                    { color: 'cyan', speedRatio: 0.9, name: 'íŒŒë‘(Cyan)' },
                    { color: 'magenta', speedRatio: 0.6, name: 'ë¶„í™(Magenta)' },
                    { color: 'yellow', speedRatio: 0.3, name: 'ë…¸ë‘(Yellow)' }
                ],
                isSolubleInWater: true
            },
            'perm_black': {
                name: 'ìœ ì„± ê²€ì •',
                components: [
                    { color: 'black', speedRatio: 0.95, name: 'ê²€ì • ì„±ë¶„' },
                    { color: 'purple', speedRatio: 0.7, name: 'ë³´ë¼ ì„±ë¶„' }
                ],
                isSolubleInWater: false // ë¬¼ì— ì•ˆ ë…¹ìŒ
            },
            'water_red': {
                name: 'ìˆ˜ì„± ë¹¨ê°•',
                components: [
                    { color: 'red', speedRatio: 0.8, name: 'ë¹¨ê°•(Red)' },
                    { color: 'orange', speedRatio: 0.4, name: 'ì£¼í™©(Orange)' }
                ],
                isSolubleInWater: true
            },
            'mix_green': {
                name: 'í˜¼í•© ì´ˆë¡',
                components: [
                    { color: 'blue', speedRatio: 0.85, name: 'íŒŒë‘(Blue)' },
                    { color: 'yellow', speedRatio: 0.4, name: 'ë…¸ë‘(Yellow)' }
                ],
                isSolubleInWater: true
            }
        };

        function drawSetup() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // ê±°ë¦„ì¢…ì´ ê·¸ë¦¬ê¸°
            ctx.fillStyle = '#fff';
            ctx.fillRect(50, 20, 200, 460);
            ctx.strokeStyle = '#ddd';
            ctx.strokeRect(50, 20, 200, 460);

            // ì›ì  ë¼ì¸ (ì—°í•„ ì„ )
            ctx.beginPath();
            ctx.moveTo(70, baselineY);
            ctx.lineTo(230, baselineY);
            ctx.strokeStyle = '#aaa';
            ctx.setLineDash([5, 5]);
            ctx.stroke();
            ctx.setLineDash([]);
            ctx.fillStyle = '#666';
            ctx.font = '12px Arial';
            ctx.fillText("ì‹œì‘ì„ ", 235, baselineY + 5);

            // ë¹„ì»¤ ì† ìš©ë§¤
            ctx.fillStyle = document.getElementById('solvent').value === 'water' ? 'rgba(173, 216, 230, 0.5)' : 'rgba(200, 200, 200, 0.5)';
            ctx.fillRect(50, 450, 200, 50);
            
            // í˜„ì¬ ì‰í¬ ì  (ì‹œì‘ ì „)
            if (!isRunning && components.length === 0) {
                ctx.beginPath();
                ctx.arc(150, baselineY, 6, 0, Math.PI * 2);
                ctx.fillStyle = 'black';
                ctx.fill();
            }
        }

        function startExperiment() {
            if (isRunning) return;
            
            const solventType = document.getElementById('solvent').value;
            const inkType = document.getElementById('ink').value;
            const paperType = document.getElementById('paper').value;

            // ì‹¤í—˜ ì¡°ê±´ ì´ˆê¸°í™”
            solventFront = baselineY;
            solventSpeed = paperType === 'chalk' ? 1.0 : 0.5; // ë¶„í•„ì´ ë” ë¹ ë¦„
            
            const selectedInk = inkData[inkType];
            
            // ìš©í•´ì„± ì²´í¬ ë¡œì§
            let willSeparate = true;
            if (solventType === 'water' && !selectedInk.isSolubleInWater) {
                willSeparate = false;
            }

            // ì„±ë¶„ ìƒì„±
            components = [];
            if (willSeparate) {
                selectedInk.components.forEach(c => {
                    components.push({
                        y: baselineY,
                        color: c.color,
                        speed: solventSpeed * c.speedRatio, // ìš©ë§¤ ì†ë„ ëŒ€ë¹„ ë¹„ìœ¨
                        name: c.name,
                        finalRf: c.speedRatio
                    });
                });
            } else {
                // ë¶„ë¦¬ ì•ˆë¨ (ê·¸ëŒ€ë¡œ ìˆìŒ)
                components.push({
                    y: baselineY,
                    color: 'black',
                    speed: 0,
                    name: 'ë¶„ë¦¬ë˜ì§€ ì•ŠìŒ',
                    finalRf: 0
                });
            }

            isRunning = true;
            statusMsg.innerText = "ìš©ë§¤ê°€ ê±°ë¦„ì¢…ì´ë¥¼ íƒ€ê³  ì˜¬ë¼ê°€ëŠ” ì¤‘...";
            animate();
        }

        function animate() {
            if (!isRunning) return;

            // ìš©ë§¤ ì´ë™
            if (solventFront > maxSolventHeight) {
                solventFront -= solventSpeed;
                
                // ê° ì„±ë¶„ ì´ë™
                components.forEach(comp => {
                    comp.y -= comp.speed;
                });
                
                renderFrame();
                updateTable(false);
                animationId = requestAnimationFrame(animate);
            } else {
                finishExperiment();
            }
        }

        function renderFrame() {
            drawSetup();

            // ìš©ë§¤ ì „ì„  í‘œì‹œ
            ctx.beginPath();
            ctx.moveTo(50, solventFront);
            ctx.lineTo(250, solventFront);
            ctx.strokeStyle = 'blue';
            ctx.stroke();
            ctx.fillStyle = 'blue';
            ctx.fillText("ìš©ë§¤ ì „ì„ ", 255, solventFront + 5);

            // ì –ì€ ì¢…ì´ ì˜ì—­ í‘œì‹œ
            ctx.fillStyle = 'rgba(200, 230, 255, 0.2)';
            ctx.fillRect(50, solventFront, 200, 450 - solventFront);

            // ì„±ë¶„ ì  ê·¸ë¦¬ê¸°
            components.forEach(comp => {
                ctx.beginPath();
                ctx.arc(150, comp.y, 8, 0, Math.PI * 2); // ì  í¬ê¸°
                ctx.fillStyle = comp.color;
                ctx.globalAlpha = 0.7; // ê²¹ì¹  ë•Œ ìƒ‰ í˜¼í•© íš¨ê³¼ í‰ë‚´
                ctx.fill();
                ctx.globalAlpha = 1.0;
            });
        }

        function updateTable(isFinal) {
            let html = '';
            const solventDist = baselineY - solventFront;

            components.forEach(comp => {
                const compDist = baselineY - comp.y;
                let rf = 0;
                if (solventDist > 0) {
                    rf = (compDist / solventDist).toFixed(2);
                }
                
                html += `<tr>
                    <td><span style="color:${comp.color}">â—</span> ${comp.name}</td>
                    <td>${compDist.toFixed(1)} mm</td> <td><strong>${rf}</strong></td>
                </tr>`;
            });
            
            // ìš©ë§¤ ê±°ë¦¬ ì¶”ê°€
            html += `<tr style="background:#f9f9f9">
                <td>ìš©ë§¤ ì „ì„ </td>
                <td>${solventDist.toFixed(1)} mm</td>
                <td>-</td>
            </tr>`;

            resultBody.innerHTML = html;
        }

        function finishExperiment() {
            isRunning = false;
            cancelAnimationFrame(animationId);
            statusMsg.innerText = "ì‹¤í—˜ ì™„ë£Œ! ê²°ê³¼ë¥¼ ë¶„ì„í•˜ì„¸ìš”.";
            
            // í”¼ë“œë°± ìƒì„±
            const solventType = document.getElementById('solvent').value;
            const inkType = document.getElementById('ink').value;
            
            let msg = "";
            if (solventType === 'water' && inkType === 'perm_black') {
                msg = "âŒ ë¶„ë¦¬ ì‹¤íŒ¨!\nì´ìœ : ìœ ì„± ì‚¬ì¸íœì˜ ì‰í¬ëŠ” ë¬¼(ê·¹ì„± ìš©ë§¤)ì— ë…¹ì§€ ì•Šì•„ì„œ ì´ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\nğŸ’¡ ì œì•ˆ: ìš©ë§¤ë¥¼ 'ì—íƒ„ì˜¬'ë¡œ ë°”ê¾¸ì–´ ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”.";
            } else {
                msg = "âœ… ë¶„ë¦¬ ì„±ê³µ!\nê° ìƒ‰ì†Œê°€ ì„œë¡œ ë‹¤ë¥¸ ì†ë„ë¡œ ì´ë™í–ˆìŠµë‹ˆë‹¤.\nì´ëŠ” ê° ì„±ë¶„ì´ ìš©ë§¤ì— ë…¹ëŠ” ì •ë„ì™€ ì¢…ì´ì— í¡ì°©ë˜ëŠ” ì •ë„ê°€ ë‹¤ë¥´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.";
            }
            feedbackArea.innerText = msg;

            // í€´ì¦ˆ í™œì„±í™”
            document.getElementById('quizBtn').style.display = 'block';
            generateQuiz();
        }

        function resetExperiment() {
            isRunning = false;
            cancelAnimationFrame(animationId);
            components = [];
            solventFront = baselineY;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawSetup();
            resultBody.innerHTML = '<tr><td colspan="3">ì‹¤í—˜ì„ ì‹œì‘í•˜ì„¸ìš”</td></tr>';
            feedbackArea.innerText = '';
            statusMsg.innerText = "ì¤€ë¹„ ì™„ë£Œ";
            document.getElementById('quizBtn').style.display = 'none';
            document.getElementById('quizSection').innerHTML = '<p id="quizQuestion">ì‹¤í—˜ í›„ í€´ì¦ˆê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.</p><button onclick="checkAnswer()" id="quizBtn" style="display:none; margin-top:5px;">ì •ë‹µ í™•ì¸</button>';
        }

        function generateQuiz() {
            const solventType = document.getElementById('solvent').value;
            const qSection = document.getElementById('quizQuestion');
            
            if (solventType === 'water' && components[0].speed === 0) {
                qSection.innerText = "Q. ìœ ì„± ì‚¬ì¸íœì´ ë¶„ë¦¬ë˜ì§€ ì•Šì€ ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€ìš”?";
                // ë‹µ: ìš©ë§¤(ë¬¼)ì— ë…¹ì§€ ì•Šì•„ì„œ
            } else {
                // ê°€ì¥ ë©€ë¦¬ ê°„ ì„±ë¶„ ì°¾ê¸°
                let fastest = components.reduce((prev, current) => (prev.y < current.y) ? prev : current);
                qSection.innerHTML = `Q. ê°€ì¥ ë©€ë¦¬ ì´ë™í•œ <strong>${fastest.name}</strong>ì˜ íŠ¹ì§•ìœ¼ë¡œ ì˜³ì€ ê²ƒì€?<br>
                1. ìš©ë§¤ì— ëŒ€í•œ ìš©í•´ë„ê°€ ê°€ì¥ ì‘ë‹¤.<br>
                2. ê±°ë¦„ì¢…ì´ì— ëŒ€í•œ í¡ì°©ë ¥ì´ ê°€ì¥ í¬ë‹¤.<br>
                3. ìš©ë§¤ì™€ í•¨ê»˜ ì´ë™í•˜ëŠ” ì†ë„ê°€ ê°€ì¥ ë¹ ë¥´ë‹¤.`;
                
                window.correctAnswer = 3;
            }
        }

        function checkAnswer() {
            const solventType = document.getElementById('solvent').value;
            const inkType = document.getElementById('ink').value;
             if (solventType === 'water' && inkType === 'perm_black') {
                 alert("ì •ë‹µ: ìœ ì„± ì„±ë¶„ì€ ê·¹ì„± ìš©ë§¤ì¸ ë¬¼ì— ë…¹ì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.");
             } else {
                 alert("ì •ë‹µ: 3ë²ˆ. Rf ê°’ì´ í´ìˆ˜ë¡(ë©€ë¦¬ ì´ë™í• ìˆ˜ë¡) ìš©ë§¤ì— ëŒ€í•œ ì¹œí™”ë ¥ì´ í¬ê³  ì´ë™ ì†ë„ê°€ ë¹ ë¦…ë‹ˆë‹¤.");
             }
        }

        // ì´ˆê¸° í™”ë©´ ê·¸ë¦¬ê¸°
        drawSetup();

    </script>
</body>
</html>