<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¤‘2 ê³¼í•™: ì•™ê¸ˆ ìƒì„± ë°˜ì‘ ê°€ìƒ ì‹¤í—˜</title>
    <style>
        :root { --primary: #4a90e2; --bg: #f4f7f6; --plate: #222; --precipitate: rgba(255, 255, 255, 0.9); }
        body { font-family: 'Malgun Gothic', sans-serif; background: var(--bg); margin: 0; padding: 20px; color: #333; }
        
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: var(--primary); }
        
        /* Control Panel */
        .controls { display: flex; gap: 20px; justify-content: center; margin-bottom: 20px; flex-wrap: wrap; }
        .btn { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; transition: 0.2s; }
        .btn-solution { background: #e0e7ff; color: #333; border: 2px solid #aecbfa; }
        .btn-reagent { background: #fff3cd; color: #856404; border: 2px solid #ffeeba; }
        .btn:hover, .btn.active { transform: translateY(-2px); box-shadow: 0 2px 5px rgba(0,0,0,0.1); font-weight: bold; }
        .btn.active { background: var(--primary); color: white; border-color: var(--primary); }

        /* Lab Area */
        .lab-bench { display: flex; flex-direction: column; align-items: center; gap: 20px; }
        
        /* Reaction Plate */
        .plate-container { position: relative; width: 300px; height: 300px; background: var(--plate); border-radius: 50%; border: 5px solid #555; display: flex; justify-content: center; align-items: center; box-shadow: inset 0 0 20px #000; }
        .liquid { width: 200px; height: 200px; border-radius: 50%; background: rgba(135, 206, 235, 0.1); transition: 0.5s; position: relative; display: flex; justify-content: center; align-items: center; }
        
        /* Precipitate Animation */
        .precipitate { width: 100%; height: 100%; border-radius: 50%; background: radial-gradient(circle, #fff 20%, transparent 80%); opacity: 0; transform: scale(0.5); filter: blur(10px); transition: all 1.5s ease-out; position: absolute; }
        .precipitate.formed { opacity: 1; transform: scale(1); filter: blur(2px); }

        /* Dropper Animation */
        .dropper { position: absolute; top: -50px; left: 50%; transform: translateX(-50%); font-size: 3rem; opacity: 0; transition: 0.5s; pointer-events: none; }
        .dropper.drop { top: 40px; opacity: 1; }
        
        /* Log & Feedback */
        .feedback-box { width: 100%; background: #eee; padding: 15px; border-radius: 10px; margin-top: 20px; min-height: 60px; }
        .log-table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 0.9rem; }
        .log-table th, .log-table td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        .log-table th { background-color: #f8f9fa; }
        
        .reset-btn { background: #ff6b6b; color: white; margin-top: 10px; }

        /* Molecule Tooltip */
        .molecule-view { font-family: 'Times New Roman', serif; font-style: italic; color: #666; font-size: 0.9rem; margin-top: 5px; min-height: 20px; text-align: center;}
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ”¬ ì´ì˜¨ í™•ì¸ ê°€ìƒ ì‹¤í—˜ì‹¤</h1>
    <p style="text-align: center;">ë¯¸ì§€ì˜ ìš©ì•¡(A, B, C)ì„ ì„ íƒí•˜ê³  ì‹œì•½ì„ ë–¨ì–´ëœ¨ë ¤ ì•™ê¸ˆì´ ìƒê¸°ëŠ”ì§€ ê´€ì°°í•˜ì„¸ìš”.</p>

    <div class="controls">
        <span>1. ë¯¸ì§€ ìš©ì•¡ ì„ íƒ: </span>
        <button class="btn btn-solution" onclick="selectSolution('A')">ìš©ì•¡ A</button>
        <button class="btn btn-solution" onclick="selectSolution('B')">ìš©ì•¡ B</button>
        <button class="btn btn-solution" onclick="selectSolution('C')">ìš©ì•¡ C (ì¦ë¥˜ìˆ˜)</button>
    </div>

    <div class="controls" id="reagent-controls" style="opacity: 0.5; pointer-events: none;">
        <span>2. ë°˜ì‘ ì‹œì•½ ì²¨ê°€: </span>
        <button class="btn btn-reagent" onclick="addReagent('AgNO3')">ì§ˆì‚° ì€ ìˆ˜ìš©ì•¡ (AgNOâ‚ƒ)</button>
        <button class="btn btn-reagent" onclick="addReagent('Na2CO3')">íƒ„ì‚° ë‚˜íŠ¸ë¥¨ ìˆ˜ìš©ì•¡ (Naâ‚‚COâ‚ƒ)</button>
    </div>

    <div class="lab-bench">
        <div class="plate-container">
            <div class="dropper" id="dropper">ğŸ’§</div>
            <div class="liquid" id="liquid">
                <div class="precipitate" id="precipitate"></div>
            </div>
        </div>
        <div class="molecule-view" id="molecule-display"></div>
    </div>

    <div class="feedback-box" id="feedback">
        ğŸ‘¨â€ğŸ”¬ ì‹¤í—˜ì„ ì‹œì‘í•˜ë ¤ë©´ ë¨¼ì € **ë¯¸ì§€ ìš©ì•¡**ì„ ì„ íƒí•´ì£¼ì„¸ìš”.
    </div>

    <table class="log-table">
        <thead>
            <tr>
                <th>ë¯¸ì§€ ìš©ì•¡</th>
                <th>ì²¨ê°€í•œ ì‹œì•½</th>
                <th>ê´€ì°° ê²°ê³¼</th>
                <th>ì¶”ì • ì´ì˜¨</th>
            </tr>
        </thead>
        <tbody id="log-body">
            </tbody>
    </table>

    <div style="text-align: center;">
        <button class="btn reset-btn" onclick="resetLab()">ğŸ§ª ì‹¤í—˜íŒ ë¹„ìš°ê¸° (ì´ˆê¸°í™”)</button>
    </div>
</div>

<script>
    // Experiment State
    let currentSolution = null;
    let currentReagent = null;
    let hasReacted = false;

    // Solution Data (Hidden Logic)
    // A: NaCl (Contains Cl-)
    // B: Ca(NO3)2 (Contains Ca2+) - Note: Using Nitrate to avoid Ag reaction confusion for this level
    // C: Distilled Water
    const solutions = {
        'A': { name: 'ë¯¸ì§€ ìš©ì•¡ A', ions: ['Na+', 'Cl-'] },
        'B': { name: 'ë¯¸ì§€ ìš©ì•¡ B', ions: ['Ca2+', 'NO3-'] },
        'C': { name: 'ë¯¸ì§€ ìš©ì•¡ C', ions: [] }
    };

    const reagents = {
        'AgNO3': { name: 'ì§ˆì‚° ì€', target: 'Cl-', product: 'AgCl', color: 'í°ìƒ‰', formula: 'Agâº + Clâ» â†’ AgCl(s)' },
        'Na2CO3': { name: 'íƒ„ì‚° ë‚˜íŠ¸ë¥¨', target: 'Ca2+', product: 'CaCO3', color: 'í°ìƒ‰', formula: 'CaÂ²âº + COâ‚ƒÂ²â» â†’ CaCOâ‚ƒ(s)' }
    };

    function selectSolution(sol) {
        resetLab();
        currentSolution = sol;
        
        // UI Update
        document.querySelectorAll('.btn-solution').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');
        
        // Activate Reagents
        document.getElementById('reagent-controls').style.opacity = '1';
        document.getElementById('reagent-controls').style.pointerEvents = 'auto';
        
        updateFeedback(`ğŸ‘¨â€ğŸ”¬ **${solutions[sol].name}**ì„(ë¥¼) ë°˜ì‘íŒì— ëœì—ˆìŠµë‹ˆë‹¤. ì´ì œ ì‹œì•½ì„ ì„ íƒí•´ ë–¨ì–´ëœ¨ë ¤ ë³´ì„¸ìš”.`);
    }

    function addReagent(reag) {
        if (!currentSolution) return;
        currentReagent = reag;
        hasReacted = true;

        // Dropper Animation
        const dropper = document.getElementById('dropper');
        dropper.classList.add('drop');
        setTimeout(() => dropper.classList.remove('drop'), 1000);

        // Check Reaction Logic
        const solData = solutions[currentSolution];
        const reagData = reagents[reag];
        const isMatch = solData.ions.includes(reagData.target);

        setTimeout(() => {
            if (isMatch) {
                // Precipitation Animation
                document.getElementById('precipitate').classList.add('formed');
                document.getElementById('molecule-display').innerHTML = `<strong>í™”í•™ ë°˜ì‘ì‹:</strong> ${reagData.formula}`;
                updateFeedback(`âœ¨ **ë°˜ì‘ ì„±ê³µ!** ${reagData.color} ì•™ê¸ˆì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ê²ƒì€ **${reagData.target}** ì´ì˜¨ì´ ìˆë‹¤ëŠ” ì¦ê±°ì…ë‹ˆë‹¤.`);
                addLog(solutions[currentSolution].name, reagData.name, `${reagData.color} ì•™ê¸ˆ ìƒì„±`, `${reagData.target} ì¡´ì¬`);
            } else {
                // No Reaction
                document.getElementById('molecule-display').innerText = "ë°˜ì‘ ì—†ìŒ (ì´ì˜¨ì´ ê·¸ëŒ€ë¡œ ë…¹ì•„ ìˆìŒ)";
                updateFeedback(`â˜ï¸ ì•„ë¬´ëŸ° ë³€í™”ê°€ ì—†ìŠµë‹ˆë‹¤. ì´ ì‹œì•½ê³¼ ë°˜ì‘í•˜ëŠ” ì´ì˜¨ì´ ì—†ë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤.`);
                addLog(solutions[currentSolution].name, reagData.name, `ë³€í™” ì—†ìŒ`, `?`);
            }
        }, 600);
    }

    function updateFeedback(msg) {
        document.getElementById('feedback').innerHTML = msg;
    }

    function addLog(sol, reag, result, guess) {
        const tbody = document.getElementById('log-body');
        const row = `<tr><td>${sol}</td><td>${reag}</td><td>${result}</td><td><strong>${guess}</strong></td></tr>`;
        tbody.innerHTML += row;
    }

    function resetLab() {
        currentSolution = null;
        currentReagent = null;
        hasReacted = false;
        document.getElementById('precipitate').classList.remove('formed');
        document.getElementById('molecule-display').innerHTML = "";
        document.querySelectorAll('.btn').forEach(b => b.classList.remove('active'));
        document.getElementById('reagent-controls').style.opacity = '0.5';
        document.getElementById('reagent-controls').style.pointerEvents = 'none';
        updateFeedback("ğŸ‘¨â€ğŸ”¬ ì‹¤í—˜íŒì„ ê¹¨ë—ì´ ì”»ì—ˆìŠµë‹ˆë‹¤. ìƒˆ ìš©ì•¡ì„ ì„ íƒí•˜ì„¸ìš”.");
    }
</script>

</body>
</html>