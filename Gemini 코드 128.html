<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°€ìƒ ì‹¤í—˜ì‹¤: ì˜¨ë„ì— ë”°ë¥¸ í™”í•™ í‰í˜• ì´ë™</title>
    <style>
        :root {
            --primary-color: #4a90e2;
            --text-color: #333;
            --bg-color: #f4f7f9;
            --panel-bg: #ffffff;
        }
        body {
            font-family: 'Pretendard', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1, h2 { margin-bottom: 10px; text-align: center; }
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            max-width: 1200px;
            width: 100%;
        }
        .panel {
            background: var(--panel-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        /* ì‹¤í—˜ ì˜ì—­ ìŠ¤íƒ€ì¼ */
        .experiment-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .beaker-container {
            position: relative;
            width: 200px;
            height: 250px;
            border: 4px solid #aaa;
            border-top: none;
            border-radius: 0 0 20px 20px;
            margin: 20px;
            background-color: rgba(255, 192, 203, 0.8); /* ì´ˆê¸°ê°’: ë¶„í™ */
            transition: background-color 0.5s ease;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            overflow: hidden;
        }
        .liquid-label {
            margin-bottom: 20px;
            font-weight: bold;
            color: rgba(0,0,0,0.6);
            background: rgba(255,255,255,0.5);
            padding: 5px 10px;
            border-radius: 4px;
        }
        .heater {
            width: 220px;
            height: 20px;
            background: #ddd;
            border-radius: 4px;
            margin-top: 5px;
            position: relative;
        }
        .heater.hot { background: linear-gradient(to right, #ffeda0, #ff4d4d); }
        .heater.cold { background: linear-gradient(to right, #a0d8ef, #0077be); }

        /* ì…ì ëª¨í˜• ìº”ë²„ìŠ¤ */
        #particleCanvas {
            width: 100%;
            height: 200px;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
        }

        /* ê·¸ë˜í”„ ìº”ë²„ìŠ¤ */
        #graphCanvas {
            width: 100%;
            height: 200px;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
        }

        /* ì œì–´ íŒ¨ë„ */
        .controls {
            margin-top: 20px;
            width: 100%;
        }
        input[type=range] {
            width: 100%;
            margin: 10px 0;
        }
        .value-display {
            font-size: 1.2em;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
        }

        /* í™”í•™ ë°˜ì‘ì‹ ê°•ì¡° */
        .reaction-equation {
            font-size: 1.1em;
            text-align: center;
            padding: 15px;
            background: #eef2f5;
            border-radius: 8px;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        .reactant { color: #e91e63; font-weight: bold; } /* ë¶„í™ */
        .product { color: #2196f3; font-weight: bold; } /* íŒŒë‘ */
        .energy { color: #f44336; font-weight: bold; }

        /* í€´ì¦ˆ ë° ë²„íŠ¼ */
        .quiz-section { margin-top: 20px; border-top: 2px dashed #ddd; padding-top: 20px; }
        .btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            margin-top: 10px;
        }
        .btn:hover { background-color: #357abd; }
        .btn-reset { background-color: #999; }
        
        /* í”¼ë“œë°± ë°•ìŠ¤ */
        #feedback {
            margin-top: 10px;
            padding: 10px;
            border-radius: 6px;
            display: none;
        }
        .correct { background-color: #d4edda; color: #155724; }
        .incorrect { background-color: #f8d7da; color: #721c24; }

        @media (max-width: 768px) {
            .container { grid-template-columns: 1fr; }
        }
        
        /* ì¸ì‡„ìš© ìŠ¤íƒ€ì¼ */
        @media print {
            body { background: white; }
            .panel { box-shadow: none; border: 1px solid #ddd; }
            .btn { display: none; }
        }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>

    <h1>âš—ï¸ ê°€ìƒ ì‹¤í—˜ì‹¤: ì˜¨ë„ì™€ í™”í•™ í‰í˜•</h1>
    <p>í™”í•™â…¡ 2-4-02: ì˜¨ë„ ë³€í™”ì— ë”°ë¥¸ í‰í˜• ì´ë™ ê´€ì°° ì‹¤í—˜</p>

    <div class="container">
        <div class="panel">
            <h2>ğŸ§ª ì‹¤í—˜ ì¥ì¹˜</h2>
            <div class="reaction-equation">
                <span class="reactant">$[Co(H_2O)_6]^{2+}$</span> (ë¶„í™) + $4Cl^-$ + <span class="energy">ì—´(Heat)</span> <br>
                $\rightleftharpoons$ <span class="product">$[CoCl_4]^{2-}$</span> (íŒŒë‘) + $6H_2O$
            </div>
            
            <div class="experiment-area">
                <div class="beaker-container" id="beaker">
                    <div class="liquid-label" id="colorName">ë¶„í™ìƒ‰</div>
                </div>
                <div class="heater" id="heaterPlate"></div>
            </div>

            <div class="controls">
                <div class="value-display">í˜„ì¬ ì˜¨ë„: <span id="tempValue">25</span>Â°C</div>
                <label>â„ï¸ ëƒ‰ê° ------------------------ ê°€ì—´ ğŸ”¥</label>
                <input type="range" id="tempSlider" min="0" max="100" value="25" step="1">
                <button class="btn btn-reset" onclick="resetExperiment()">ì¡°ê±´ ì´ˆê¸°í™”</button>
            </div>
            
            <div style="margin-top: 15px; font-size: 0.9em; color: #666;">
                <strong>ğŸ’¡ Tip:</strong> ìŠ¬ë¼ì´ë”ë¥¼ ì›€ì§ì—¬ ì˜¨ë„ë¥¼ ë³€í™”ì‹œì¼œ ë³´ì„¸ìš”. ì˜¨ë„ê°€ ì˜¬ë¼ê°€ë©´ 'ì—´'ì´ ê°€í•´ì§€ëŠ” ê²ƒì…ë‹ˆë‹¤.
            </div>
        </div>

        <div class="panel">
            <h2>ğŸ“Š ê²°ê³¼ ë¶„ì„</h2>
            
            <h3>1. ì…ì ëª¨í˜• (Micro View)</h3>
            <canvas id="particleCanvas"></canvas>
            <p style="font-size: 0.8em; text-align: center;">ğŸ”´: ë¶„í™ìƒ‰ ì°©ì´ì˜¨(ë°˜ì‘ë¬¼) / ğŸ”µ: íŒŒë€ìƒ‰ ì°©ì´ì˜¨(ìƒì„±ë¬¼)</p>

            <h3>2. í‰í˜• ìƒìˆ˜(K) ë³€í™” ê·¸ë˜í”„</h3>
            <canvas id="graphCanvas"></canvas>
            
            <div class="quiz-section">
                <h3>ğŸ“ í™•ì¸ í€´ì¦ˆ</h3>
                <p>Q. ì˜¨ë„ë¥¼ ë†’ì´ë©´ ìˆ˜ìš©ì•¡ì´ íŒŒë€ìƒ‰ìœ¼ë¡œ ë³€í•©ë‹ˆë‹¤. ì´ë•Œ ì •ë°˜ì‘ì€ í¡ì—´ ë°˜ì‘ì¼ê¹Œìš”, ë°œì—´ ë°˜ì‘ì¼ê¹Œìš”?</p>
                <button class="btn" onclick="checkAnswer('endo')">í¡ì—´ ë°˜ì‘</button>
                <button class="btn" onclick="checkAnswer('exo')">ë°œì—´ ë°˜ì‘</button>
                <div id="feedback"></div>
            </div>

            <button class="btn" style="width:100%; margin-top:20px; background-color: #28a745;" onclick="window.print()">ğŸ“„ ê²°ê³¼ ë³´ê³ ì„œ ì¸ì‡„ (PDF ì €ì¥)</button>
        </div>
    </div>

    <script>
        // DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
        const slider = document.getElementById('tempSlider');
        const tempValue = document.getElementById('tempValue');
        const beaker = document.getElementById('beaker');
        const colorName = document.getElementById('colorName');
        const heaterPlate = document.getElementById('heaterPlate');
        const feedback = document.getElementById('feedback');

        // ìº”ë²„ìŠ¤ ì„¤ì •
        const pCanvas = document.getElementById('particleCanvas');
        const pCtx = pCanvas.getContext('2d');
        const gCanvas = document.getElementById('graphCanvas');
        const gCtx = gCanvas.getContext('2d');

        // ìº”ë²„ìŠ¤ í¬ê¸° ì¡°ì •
        function resizeCanvas() {
            pCanvas.width = pCanvas.offsetWidth;
            pCanvas.height = 200;
            gCanvas.width = gCanvas.offsetWidth;
            gCanvas.height = 200;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        // ì…ì ë°°ì—´
        let particles = [];
        const TOTAL_PARTICLES = 50;

        // ì…ì í´ë˜ìŠ¤
        class Particle {
            constructor() {
                this.x = Math.random() * pCanvas.width;
                this.y = Math.random() * pCanvas.height;
                this.vx = (Math.random() - 0.5) * 2;
                this.vy = (Math.random() - 0.5) * 2;
                this.size = 5;
                this.type = 'pink'; // 'pink' or 'blue'
            }

            move(speedFactor) {
                this.x += this.vx * speedFactor;
                this.y += this.vy * speedFactor;

                // ë²½ ì¶©ëŒ
                if (this.x < 0 || this.x > pCanvas.width) this.vx *= -1;
                if (this.y < 0 || this.y > pCanvas.height) this.vy *= -1;
            }

            draw() {
                pCtx.beginPath();
                pCtx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                pCtx.fillStyle = this.type === 'pink' ? '#e91e63' : '#2196f3';
                pCtx.fill();
                pCtx.closePath();
            }
        }

        // ì…ì ì´ˆê¸°í™”
        for (let i = 0; i < TOTAL_PARTICLES; i++) {
            particles.push(new Particle());
        }

        // ë©”ì¸ ë£¨í”„
        function animate() {
            updateExperiment();
            drawParticles();
            drawGraph();
            requestAnimationFrame(animate);
        }

        function updateExperiment() {
            const temp = parseInt(slider.value);
            tempValue.textContent = temp;

            // 1. ë¹„ì»¤ ìƒ‰ìƒ ê³„ì‚° (ì˜¨ë„ê°€ ë†’ì„ìˆ˜ë¡ íŒŒë‘, ë‚®ì„ìˆ˜ë¡ ë¶„í™)
            // 0ë„ -> ë¶„í™(100%), 100ë„ -> íŒŒë‘(100%) ë¡œ ê°€ì •í•˜ì—¬ ë³´ê°„
            // Pink RGB: 255, 192, 203 | Blue RGB: 65, 105, 225 (RoyalBlue)
            
            const ratio = temp / 100; // 0.0 ~ 1.0
            
            const r = Math.round(255 * (1 - ratio) + 65 * ratio);
            const g = Math.round(192 * (1 - ratio) + 105 * ratio);
            const b = Math.round(203 * (1 - ratio) + 225 * ratio);

            beaker.style.backgroundColor = `rgb(${r}, ${g}, ${b})`;

            // í…ìŠ¤íŠ¸ ë¼ë²¨ ë³€ê²½
            if (temp < 40) colorName.textContent = "ë¶„í™ìƒ‰ (ë°˜ì‘ë¬¼ ìš°ì„¸)";
            else if (temp > 60) colorName.textContent = "íŒŒë€ìƒ‰ (ìƒì„±ë¬¼ ìš°ì„¸)";
            else colorName.textContent = "ë³´ë¼ìƒ‰ (í‰í˜• ìƒíƒœ)";

            // íˆí„° ì‹œê°í™”
            heaterPlate.className = 'heater ' + (temp > 50 ? 'hot' : 'cold');

            // 2. ì…ì ìƒíƒœ ì—…ë°ì´íŠ¸ (í™•ë¥ ì  ë³€í™˜)
            // tempê°€ ë†’ì„ìˆ˜ë¡ 'blue'ê°€ ë  í™•ë¥  ë†’ìŒ
            const blueCountTarget = Math.floor(TOTAL_PARTICLES * ratio);
            let currentBlue = particles.filter(p => p.type === 'blue').length;

            particles.forEach(p => {
                // ì…ì ì†ë„ = ì˜¨ë„ì— ë¹„ë¡€
                p.move(0.5 + (temp / 50)); 
            });

            // ê°œìˆ˜ ë§ì¶”ê¸° (ë‹¨ìˆœí™”ëœ ëª¨ë¸: ë¬´ì‘ìœ„ ì…ìë¥¼ íƒ€ê²Ÿ ìƒ‰ìƒìœ¼ë¡œ ë³€ê²½)
            if (currentBlue < blueCountTarget) {
                // íŒŒë€ìƒ‰ì´ ë¶€ì¡±í•˜ë©´ ë¶„í™ -> íŒŒë‘
                const pinks = particles.filter(p => p.type === 'pink');
                if (pinks.length > 0) pinks[0].type = 'blue';
            } else if (currentBlue > blueCountTarget) {
                // íŒŒë€ìƒ‰ì´ ë„˜ì¹˜ë©´ íŒŒë‘ -> ë¶„í™
                const blues = particles.filter(p => p.type === 'blue');
                if (blues.length > 0) blues[0].type = 'pink';
            }
        }

        function drawParticles() {
            pCtx.clearRect(0, 0, pCanvas.width, pCanvas.height);
            particles.forEach(p => p.draw());
        }

        function drawGraph() {
            gCtx.clearRect(0, 0, gCanvas.width, gCanvas.height);
            
            // ì¶• ê·¸ë¦¬ê¸°
            gCtx.beginPath();
            gCtx.strokeStyle = '#666';
            gCtx.moveTo(30, 10);
            gCtx.lineTo(30, 170); // Yì¶•
            gCtx.lineTo(gCanvas.width - 10, 170); // Xì¶•
            gCtx.stroke();

            // ë¼ë²¨
            gCtx.fillStyle = '#333';
            gCtx.font = '12px Arial';
            gCtx.fillText('Temp (Â°C)', gCanvas.width - 60, 190);
            gCtx.fillText('K (í‰í˜•ìƒìˆ˜)', 10, 20);

            // ê·¸ë˜í”„ ê·¸ë¦¬ê¸° (ì§€ìˆ˜ í•¨ìˆ˜ì  ì¦ê°€ í‰ë‚´)
            gCtx.beginPath();
            gCtx.strokeStyle = '#28a745';
            gCtx.lineWidth = 2;
            
            for (let t = 0; t <= 100; t++) {
                const x = 30 + (t / 100) * (gCanvas.width - 40);
                // Kê°’ ì‹œë®¬ë ˆì´ì…˜: í¡ì—´ ë°˜ì‘ì´ë¯€ë¡œ T ì¦ê°€ ì‹œ K ì¦ê°€
                // yê°’ì€ ìº”ë²„ìŠ¤ ì¢Œí‘œê³„ (ìœ„ê°€ 0)ì´ë¯€ë¡œ ë°˜ì „ í•„ìš”
                const kValue = Math.pow(t/100, 2) * 0.8 + 0.1; // 0~1 ì‚¬ì´ ê°’
                const y = 170 - (kValue * 150); 
                
                if (t === 0) gCtx.moveTo(x, y);
                else gCtx.lineTo(x, y);
            }
            gCtx.stroke();

            // í˜„ì¬ ìœ„ì¹˜ í‘œì‹œ
            const currentTemp = parseInt(slider.value);
            const cx = 30 + (currentTemp / 100) * (gCanvas.width - 40);
            const ckValue = Math.pow(currentTemp/100, 2) * 0.8 + 0.1;
            const cy = 170 - (ckValue * 150);

            gCtx.beginPath();
            gCtx.fillStyle = 'red';
            gCtx.arc(cx, cy, 5, 0, Math.PI*2);
            gCtx.fill();
        }

        // ì´ˆê¸°í™” í•¨ìˆ˜
        function resetExperiment() {
            slider.value = 25;
            feedback.style.display = 'none';
        }

        // í€´ì¦ˆ ì •ë‹µ í™•ì¸
        function checkAnswer(answer) {
            feedback.style.display = 'block';
            if (answer === 'endo') {
                feedback.className = 'correct';
                feedback.innerHTML = "<strong>âœ… ì •ë‹µì…ë‹ˆë‹¤!</strong><br>ì˜¨ë„ë¥¼ ë†’ì˜€ì„ ë•Œ(ì—´ ê°€í•¨) í‰í˜•ì´ ì˜¤ë¥¸ìª½(ìƒì„±ë¬¼, íŒŒë‘)ìœ¼ë¡œ ì´ë™í–ˆìœ¼ë¯€ë¡œ, ì •ë°˜ì‘ì€ ì—´ì„ í¡ìˆ˜í•˜ëŠ” <strong>í¡ì—´ ë°˜ì‘</strong>ì…ë‹ˆë‹¤.<br>(ë¥´ìƒ¤í‹€ë¦¬ì— ì›ë¦¬: ê°€í•´ì¤€ ì—´ì„ ì†Œë¹„í•˜ëŠ” ìª½ìœ¼ë¡œ ì´ë™)";
            } else {
                feedback.className = 'incorrect';
                feedback.innerHTML = "<strong>âŒ ë‹¤ì‹œ ìƒê°í•´ë³¼ê¹Œìš”?</strong><br>ë°œì—´ ë°˜ì‘ì´ë¼ë©´ ì˜¨ë„ë¥¼ ë†’ì˜€ì„ ë•Œ ì—´ì„ ì œê±°í•˜ê¸° ìœ„í•´ ì—­ë°˜ì‘(ë¶„í™ìƒ‰) ìª½ìœ¼ë¡œ ì´ë™í•´ì•¼ í•©ë‹ˆë‹¤. ì‹œë®¬ë ˆì´ì…˜ì—ì„œ ì˜¨ë„ë¥¼ ë†’ì´ë©´ ìƒ‰ì´ ì–´ë–»ê²Œ ë³€í–ˆë‚˜ìš”?";
            }
        }

        // ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
        animate();
    </script>
</body>
</html>