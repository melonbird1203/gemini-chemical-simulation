<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¤‘2 ê³¼í•™: ë¬¼ì˜ ì „ê¸° ë¶„í•´ ê°€ìƒ ì‹¤í—˜ì‹¤</title>
    <style>
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #50e3c2;
            --danger-color: #ff6b6b;
            --text-color: #333;
            --bg-color: #f4f7f6;
            --glass-color: rgba(255, 255, 255, 0.8);
        }

        body {
            font-family: 'Pretendard', 'Malgun Gothic', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
            max-width: 800px;
        }

        h1 { margin: 0; color: var(--primary-color); }
        .subtitle { font-size: 0.9rem; color: #666; margin-top: 5px; }

        /* ë©”ì¸ ë ˆì´ì•„ì›ƒ */
        .lab-container {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
            max-width: 1000px;
            width: 100%;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        /* ì œì–´ íŒ¨ë„ */
        .control-panel {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        label { font-weight: bold; font-size: 0.9rem; }
        select, input[type="range"] {
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }

        button {
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.2s;
        }

        .btn-start { background-color: var(--primary-color); color: white; }
        .btn-stop { background-color: var(--danger-color); color: white; }
        .btn-reset { background-color: #95a5a6; color: white; }
        button:hover { opacity: 0.9; transform: translateY(-2px); }
        button:disabled { background-color: #ccc; cursor: not-allowed; }

        /* ì‹œë®¬ë ˆì´ì…˜ ì˜ì—­ */
        .simulation-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .apparatus {
            position: relative;
            height: 300px;
            background: linear-gradient(to bottom, #e3f2fd, #bbdefb);
            border-radius: 10px;
            border: 2px solid #90caf9;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: flex-end;
            padding-bottom: 20px;
        }

        /* í˜¸í”„ë§Œ ì „í•´ ì¥ì¹˜ ëª¨ì‚¬ */
        .tube-container {
            display: flex;
            gap: 50px;
            align-items: flex-end;
            position: relative;
            z-index: 2;
        }

        .test-tube {
            width: 60px;
            height: 200px;
            background: rgba(255,255,255,0.3);
            border: 2px solid #555;
            border-bottom: none;
            border-radius: 30px 30px 0 0;
            position: relative;
            overflow: hidden;
        }

        .electrode {
            width: 10px;
            height: 40px;
            background: #333;
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
        }

        .electrode::after {
            content: '';
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-weight: bold;
            font-size: 1.2rem;
            color: #d32f2f;
        }
        
        #electrode-minus::after { content: '(-)ê·¹'; color: blue; }
        #electrode-plus::after { content: '(+)ê·¹'; color: red; }

        .gas-space {
            background-color: white;
            width: 100%;
            height: 0%; /* ê¸°ì²´ê°€ ì°¨ë©´ ëŠ˜ì–´ë‚¨ */
            position: absolute;
            top: 0;
            left: 0;
            transition: height 0.2s linear;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 0.8rem;
            color: #666;
            border-bottom: 1px dashed #aaa;
        }

        .bubbles {
            position: absolute;
            bottom: 40px;
            left: 0;
            width: 100%;
            height: 0;
            pointer-events: none;
        }

        .bubble {
            position: absolute;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            animation: rise 2s infinite ease-in;
        }

        @keyframes rise {
            0% { bottom: 0; transform: scale(0.5); opacity: 0; }
            50% { opacity: 1; }
            100% { bottom: 150px; transform: scale(1.2); opacity: 0; }
        }

        /* ì •ë³´ íŒ¨ë„ */
        .info-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .data-box {
            background: #fff;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #eee;
            text-align: center;
        }

        .molecular-view {
            background: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        
        .molecule-anim { font-size: 1.5rem; letter-spacing: 5px; }

        /* í€´ì¦ˆ ì˜ì—­ */
        .quiz-section {
            margin-top: 30px;
            width: 100%;
            max-width: 1000px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .message-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
            z-index: 100;
            display: none;
            text-align: center;
            max-width: 400px;
        }
        .overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 99;
            display: none;
        }

        /* ìœ í‹¸ë¦¬í‹° */
        .hidden { display: none; }
        .tag {
            display: inline-block;
            padding: 2px 8px;
            background: #eee;
            border-radius: 4px;
            font-size: 0.8rem;
            margin-bottom: 5px;
        }
    </style>
</head>
<body>

    <header>
        <h1>ğŸ’§ ë¬¼ì˜ ì „ê¸° ë¶„í•´ ì‹¤í—˜ì‹¤</h1>
        <p class="subtitle">ì¤‘í•™êµ 2í•™ë…„ ê³¼í•™ [â… . ì›ì†Œ] - ë¼ë¶€ì•„ì§€ì—ì˜ ì‹¤í—˜ ì¬í˜„</p>
    </header>

    <div class="lab-container">
        <aside class="control-panel">
            <h3>ğŸ”¬ ì‹¤í—˜ ì¡°ê±´ ì„¤ì •</h3>
            
            <div class="control-group">
                <label>ì „í•´ì§ˆ ì„ íƒ (í•„ìˆ˜)</label>
                <select id="electrolyte">
                    <option value="none">ì—†ìŒ (ìˆœìˆ˜í•œ ë¬¼)</option>
                    <option value="naoh">ìˆ˜ì‚°í™”ë‚˜íŠ¸ë¥¨ (NaOH)</option>
                    <option value="na2so4">í™©ì‚°ë‚˜íŠ¸ë¥¨ (Na2SO4)</option>
                </select>
                <small style="color: #666; font-size: 0.8em;">* ìˆœìˆ˜í•œ ë¬¼ì€ ì „ê¸°ê°€ ì˜ í†µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</small>
            </div>

            <div class="control-group">
                <label>ì „ë¥˜ì˜ ì„¸ê¸°: <span id="current-val">0</span> mA</label>
                <input type="range" id="current" min="0" max="1000" step="50" value="0">
            </div>

            <div class="control-group">
                <button id="btn-start" class="btn-start">ì‹¤í—˜ ì‹œì‘</button>
                <button id="btn-stop" class="btn-stop" disabled>ë©ˆì¶¤</button>
                <button id="btn-reset" class="btn-reset">ì´ˆê¸°í™”</button>
            </div>

            <hr>
            <h3>ğŸ”¥ ê¸°ì²´ í™•ì¸ ì‹¤í—˜</h3>
            <div class="control-group">
                <button id="test-minus" disabled>(-)ê·¹ ê¸°ì²´ í™•ì¸ (ì„±ëƒ¥ë¶ˆ)</button>
                <button id="test-plus" disabled>(+)ê·¹ ê¸°ì²´ í™•ì¸ (êº¼ì§„ ë¶ˆì”¨)</button>
            </div>
        </aside>

        <main class="simulation-area">
            <div class="apparatus">
                <div class="tube-container">
                    <div class="test-tube" id="tube-h2">
                        <div class="gas-space" id="gas-h2"></div>
                        <div class="bubbles" id="bubbles-h2"></div>
                        <div class="electrode" id="electrode-minus"></div>
                    </div>
                    <div class="test-tube" id="tube-o2">
                        <div class="gas-space" id="gas-o2"></div>
                        <div class="bubbles" id="bubbles-o2"></div>
                        <div class="electrode" id="electrode-plus"></div>
                    </div>
                </div>
            </div>

            <div class="info-panel">
                <div class="data-box">
                    <span class="tag">ê±°ì‹œì  ê´€ì </span>
                    <h4>ìƒì„±ëœ ê¸°ì²´ ë¶€í”¼ë¹„</h4>
                    <p style="font-size: 1.2rem;">
                        (-)ê·¹ : (+)ê·¹ = <br>
                        <strong style="color: var(--primary-color);" id="ratio-display">0 : 0</strong>
                    </p>
                </div>
                <div class="molecular-view">
                    <span class="tag">ë¯¸ì‹œì  ê´€ì  (ì…ì ëª¨í˜•)</span>
                    <div id="molecule-anim" class="molecule-anim">ğŸ’§ Hâ‚‚O</div>
                    <div id="reaction-text" style="margin-top:10px; font-size: 0.9rem;">ë¬¼ì´ ê°€ë§Œíˆ ìˆìŠµë‹ˆë‹¤.</div>
                </div>
            </div>
        </main>
    </div>

    <section class="quiz-section">
        <h3>ğŸ“ ê°œë… í™•ì¸ í€´ì¦ˆ</h3>
        <p>ì‹¤í—˜ ê²°ê³¼ë¥¼ ë³´ê³  ì•„ë˜ ì§ˆë¬¸ì— ë‹µí•´ë³´ì„¸ìš”.</p>
        <div style="margin-bottom: 10px;">
            <strong>Q1. (-)ê·¹ì—ì„œ ë°œìƒí•˜ì—¬ 'í‘' ì†Œë¦¬ë¥¼ ë‚´ë©° íƒ€ëŠ” ê¸°ì²´ëŠ” ë¬´ì—‡ì¸ê°€ìš”?</strong><br>
            <label><input type="radio" name="q1" value="O2"> ì‚°ì†Œ</label>
            <label><input type="radio" name="q1" value="H2"> ìˆ˜ì†Œ</label>
            <label><input type="radio" name="q1" value="N2"> ì§ˆì†Œ</label>
            <button onclick="checkAnswer('q1', 'H2', 'ì •ë‹µì…ë‹ˆë‹¤! (-)ê·¹ì—ì„œëŠ” ìˆ˜ì†Œ ê¸°ì²´ê°€ ë°œìƒí•©ë‹ˆë‹¤.')">í™•ì¸</button>
        </div>
        <div>
            <strong>Q2. ì´ ì‹¤í—˜ì„ í†µí•´ ì•Œ ìˆ˜ ìˆëŠ” ì‚¬ì‹¤ì€?</strong><br>
            <label><input type="radio" name="q2" value="wrong"> ë¬¼ì€ ì›ì†Œì´ë‹¤.</label>
            <label><input type="radio" name="q2" value="correct"> ë¬¼ì€ ìˆ˜ì†Œì™€ ì‚°ì†Œë¡œ ë¶„í•´ë˜ë¯€ë¡œ ì›ì†Œê°€ ì•„ë‹ˆë‹¤.</label>
            <button onclick="checkAnswer('q2', 'correct', 'ì •ë‹µì…ë‹ˆë‹¤! ë¼ë¶€ì•„ì§€ì—ëŠ” ì´ ì‹¤í—˜ìœ¼ë¡œ ë¬¼ì´ ì›ì†Œê°€ ì•„ë‹˜ì„ ì¦ëª…í–ˆìŠµë‹ˆë‹¤.')">í™•ì¸</button>
        </div>
    </section>

    <div class="overlay" id="overlay"></div>
    <div class="message-box" id="msg-box">
        <h3 id="msg-title">ì•Œë¦¼</h3>
        <p id="msg-content">ë‚´ìš©</p>
        <button onclick="closeModal()">ë‹«ê¸°</button>
    </div>

    <script>
        // ìƒíƒœ ë³€ìˆ˜
        let isRunning = false;
        let volumeH2 = 0;
        let volumeO2 = 0;
        let animationFrame;
        
        // ìš”ì†Œ ì„ íƒ
        const sliderCurrent = document.getElementById('current');
        const displayCurrent = document.getElementById('current-val');
        const selectElectrolyte = document.getElementById('electrolyte');
        const tubeH2 = document.getElementById('gas-h2');
        const tubeO2 = document.getElementById('gas-o2');
        const bubblesH2 = document.getElementById('bubbles-h2');
        const bubblesO2 = document.getElementById('bubbles-o2');
        const ratioDisplay = document.getElementById('ratio-display');
        const reactionText = document.getElementById('reaction-text');
        const moleculeAnim = document.getElementById('molecule-anim');
        
        const btnStart = document.getElementById('btn-start');
        const btnStop = document.getElementById('btn-stop');
        const btnReset = document.getElementById('btn-reset');
        const btnTestMinus = document.getElementById('test-minus');
        const btnTestPlus = document.getElementById('test-plus');

        // ì´ˆê¸°í™”
        sliderCurrent.addEventListener('input', (e) => {
            displayCurrent.textContent = e.target.value;
        });

        btnStart.addEventListener('click', startExperiment);
        btnStop.addEventListener('click', stopExperiment);
        btnReset.addEventListener('click', resetExperiment);

        btnTestMinus.addEventListener('click', () => testGas('minus'));
        btnTestPlus.addEventListener('click', () => testGas('plus'));

        function startExperiment() {
            const current = parseInt(sliderCurrent.value);
            const electrolyte = selectElectrolyte.value;

            // 1. ì•ˆì „ ë° ì¡°ê±´ í™•ì¸
            if (electrolyte === 'none') {
                showModal('ë°˜ì‘ ì—†ìŒ', 'ìˆœìˆ˜í•œ ë¬¼ì—ëŠ” ì „ë¥˜ê°€ ê±°ì˜ íë¥´ì§€ ì•Šì•„ ë¶„í•´ê°€ ì¼ì–´ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br>ì „í•´ì§ˆ(ìˆ˜ì‚°í™”ë‚˜íŠ¸ë¥¨ ë“±)ì„ ë„£ì–´ë³´ì„¸ìš”!');
                return;
            }
            if (current === 0) {
                showModal('ì „ë¥˜ ë¶€ì¡±', 'ì „ì› ì¥ì¹˜ì˜ ì „ë¥˜ë¥¼ ë†’ì—¬ì£¼ì„¸ìš”.');
                return;
            }

            isRunning = true;
            btnStart.disabled = true;
            btnStop.disabled = false;
            selectElectrolyte.disabled = true; // ì‹¤í—˜ ì¤‘ ì¡°ê±´ ë³€ê²½ ë¶ˆê°€

            // ì• ë‹ˆë©”ì´ì…˜ ë° ë¡œì§ ì‹œì‘
            createBubbles();
            runSimulationLoop();
            
            // ë¯¸ì‹œì  ê´€ì  ì—…ë°ì´íŠ¸
            moleculeAnim.innerHTML = "âš¡ 2Hâ‚‚O â†’ 2Hâ‚‚ + Oâ‚‚ âš¡";
            reactionText.textContent = "ì „ê¸°ì—ë„ˆì§€ê°€ ë¬¼ ë¶„ìë¥¼ ìˆ˜ì†Œì™€ ì‚°ì†Œë¡œ ëŠì–´ë‚´ê³  ìˆìŠµë‹ˆë‹¤!";
        }

        function stopExperiment() {
            isRunning = false;
            btnStart.disabled = false;
            btnStop.disabled = true;
            clearBubbles();
            cancelAnimationFrame(animationFrame);
            
            moleculeAnim.innerHTML = "â¸ï¸ ì¼ì‹œ ì •ì§€";
            reactionText.textContent = "ì‹¤í—˜ì´ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.";
        }

        function resetExperiment() {
            stopExperiment();
            volumeH2 = 0;
            volumeO2 = 0;
            updateVisuals();
            selectElectrolyte.disabled = false;
            moleculeAnim.innerHTML = "ğŸ’§ Hâ‚‚O";
            reactionText.textContent = "ë¬¼ì´ ê°€ë§Œíˆ ìˆìŠµë‹ˆë‹¤.";
            
            btnTestMinus.disabled = true;
            btnTestPlus.disabled = true;
        }

        function runSimulationLoop() {
            if (!isRunning) return;

            const current = parseInt(sliderCurrent.value);
            // ì†ë„ ê³„ì‚° (ì „ë¥˜ê°€ ì…€ìˆ˜ë¡ ë¹ ë¦„)
            const speed = (current / 1000) * 0.2; 

            // ë¶€í”¼ ì¦ê°€ (ìˆ˜ì†Œ 2 : ì‚°ì†Œ 1)
            if (volumeH2 < 100) {
                volumeH2 += speed * 2;
                volumeO2 += speed * 1;
                updateVisuals();
                animationFrame = requestAnimationFrame(runSimulationLoop);
            } else {
                stopExperiment();
                showModal('ì‹¤í—˜ ì™„ë£Œ', 'ì‹œí—˜ê´€ì— ê¸°ì²´ê°€ ê°€ë“ ì°¼ìŠµë‹ˆë‹¤! ê¸°ì²´ í™•ì¸ ì‹¤í—˜ì„ ì§„í–‰í•´ë³´ì„¸ìš”.');
            }
        }

        function updateVisuals() {
            // ì‹œí—˜ê´€ ê¸°ì²´ ë†’ì´ ë°˜ì˜
            tubeH2.style.height = `${Math.min(volumeH2, 100)}%`;
            tubeH2.textContent = `${Math.floor(volumeH2)}mL`;
            
            tubeO2.style.height = `${Math.min(volumeO2, 100)}%`;
            tubeO2.textContent = `${Math.floor(volumeO2)}mL`;

            // ë¹„ìœ¨ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            if (volumeO2 > 0) {
                const ratio = (volumeH2 / volumeO2).toFixed(1);
                ratioDisplay.textContent = `${ratio} : 1`;
            }

            // ê¸°ì²´ê°€ ì–´ëŠ ì •ë„ ëª¨ì´ë©´ í™•ì¸ ë²„íŠ¼ í™œì„±í™”
            if (volumeH2 > 20) btnTestMinus.disabled = false;
            if (volumeO2 > 20) btnTestPlus.disabled = false;
        }

        // ë²„ë¸” ì• ë‹ˆë©”ì´ì…˜ (CSS class ë™ì  ì¶”ê°€ ì•„ë‹˜, ê°„ë‹¨íˆ DOM ì œì–´)
        let bubbleInterval;
        function createBubbles() {
            clearBubbles(); // ê¸°ì¡´ ì œê±°
            bubbleInterval = setInterval(() => {
                addBubble(bubblesH2, 2); // ìˆ˜ì†Œ ìª½ ë§ì´
                addBubble(bubblesO2, 1); // ì‚°ì†Œ ìª½ ì ê²Œ
            }, 300);
        }

        function addBubble(container, count) {
            for(let i=0; i<count; i++) {
                const b = document.createElement('div');
                b.className = 'bubble';
                b.style.left = Math.random() * 80 + 10 + '%';
                b.style.width = (Math.random() * 5 + 5) + 'px';
                b.style.height = b.style.width;
                container.appendChild(b);
                // ì• ë‹ˆë©”ì´ì…˜ ëë‚˜ë©´ ì œê±°
                setTimeout(() => b.remove(), 2000);
            }
        }

        function clearBubbles() {
            clearInterval(bubbleInterval);
            bubblesH2.innerHTML = '';
            bubblesO2.innerHTML = '';
        }

        // ê¸°ì²´ í™•ì¸ ë¡œì§
        function testGas(type) {
            if (type === 'minus') {
                showModal('(-)ê·¹ í™•ì¸ ê²°ê³¼', 'ğŸ”¥ ì„±ëƒ¥ë¶ˆì„ ê°€ê¹Œì´ ëŒ€ë‹ˆ "í‘!" ì†Œë¦¬ë¥¼ ë‚´ë©° íƒ”ìŠµë‹ˆë‹¤.<br>âœ <strong>ìˆ˜ì†Œ(Hâ‚‚)</strong>ì˜ ê°€ì—°ì„±');
            } else {
                showModal('(+)ê·¹ í™•ì¸ ê²°ê³¼', 'ğŸ•¯ï¸ êº¼ì ¸ê°€ëŠ” ë¶ˆì”¨ë¥¼ ëŒ€ë‹ˆ ë‹¤ì‹œ íƒ€ì˜¬ëìŠµë‹ˆë‹¤.<br>âœ <strong>ì‚°ì†Œ(Oâ‚‚)</strong>ì˜ ì¡°ì—°ì„±');
            }
        }

        // ëª¨ë‹¬ ë° í€´ì¦ˆ
        function showModal(title, content) {
            document.getElementById('msg-title').innerText = title;
            document.getElementById('msg-content').innerHTML = content;
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('msg-box').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('msg-box').style.display = 'none';
        }
        
        function checkAnswer(name, correctVal, correctMsg) {
            const radios = document.getElementsByName(name);
            let selected;
            for(let r of radios) { if(r.checked) selected = r.value; }
            
            if(!selected) {
                alert('ë³´ê¸°ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if(selected === correctVal) {
                alert(correctMsg);
            } else {
                alert('ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”. ì‹¤í—˜ ê²°ê³¼ë¥¼ ì˜ ê´€ì°°í•´ë³´ì„¸ìš”!');
            }
        }
    </script>
</body>
</html>