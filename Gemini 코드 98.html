<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì´ì˜¨ í˜•ì„± ì›ë¦¬ ê°€ìƒì‹¤í—˜ì‹¤</title>
    <style>
        :root {
            --primary-color: #4a90e2;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --bg-color: #f0f4f8;
            --panel-bg: #ffffff;
        }

        body {
            font-family: 'Pretendard', 'Malgun Gothic', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--bg-color);
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #7f8c8d;
            margin-bottom: 20px;
            text-align: center;
            max-width: 600px;
        }

        /* Layout */
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            max-width: 1200px;
            width: 100%;
            justify-content: center;
        }

        .panel {
            background: var(--panel-bg);
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 20px;
        }

        /* Element Selector */
        .selector-panel {
            flex: 1;
            min-width: 250px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .element-btn {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .element-btn:hover {
            border-color: var(--primary-color);
            background: #eef5ff;
        }

        .element-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* Visualization Area */
        .display-panel {
            flex: 2;
            min-width: 350px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            min-height: 400px;
            justify-content: center;
        }

        .atom-container {
            position: relative;
            width: 300px;
            height: 300px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .nucleus {
            width: 50px;
            height: 50px;
            background: radial-gradient(circle at 30% 30%, #e74c3c, #c0392b);
            border-radius: 50%;
            z-index: 10;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
            box-shadow: 0 0 10px rgba(231, 76, 60, 0.5);
        }

        .shell {
            position: absolute;
            border: 1px dashed #bbb;
            border-radius: 50%;
            transition: all 0.5s ease;
        }

        .electron {
            position: absolute;
            width: 12px;
            height: 12px;
            background: radial-gradient(circle at 30% 30%, #3498db, #2980b9);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 5px rgba(52, 152, 219, 0.5);
            transition: all 0.3s;
        }

        /* Info & Controls */
        .control-panel {
            flex: 1;
            min-width: 280px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .status-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid #ddd;
        }

        .status-box.stable {
            border-left-color: var(--success-color);
            background: #e8f8f0;
        }

        .status-box.unstable {
            border-left-color: var(--warning-color);
        }

        .btn-group {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            color: white;
            transition: opacity 0.2s;
        }

        .btn-add { background-color: var(--primary-color); }
        .btn-remove { background-color: var(--danger-color); }
        .btn-reset { background-color: #95a5a6; }
        
        .action-btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        /* Quiz Section */
        .quiz-section {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }

        .feedback-msg {
            font-weight: bold;
            margin-top: 10px;
            min-height: 24px;
        }

        /* Animation Keyframes */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .highlight {
            animation: pulse 1s infinite;
        }
        
        .chem-symbol {
            font-size: 2em;
            font-weight: bold;
            position: absolute;
            top: 10px;
            right: 10px;
            background: #eee;
            padding: 5px 10px;
            border-radius: 8px;
        }
    </style>
</head>
<body>

    <h1>âš›ï¸ ì´ì˜¨ í˜•ì„± ì‹¤í—˜ì‹¤</h1>
    <div class="subtitle">ì›ì†Œë¥¼ ì„ íƒí•˜ê³  ì „ìë¥¼ ì´ë™ì‹œì¼œ ì˜¥í…Ÿ ê·œì¹™ì„ ë§Œì¡±í•˜ëŠ” ì•ˆì •í•œ ì´ì˜¨ì„ ë§Œë“¤ì–´ë³´ì„¸ìš”.</div>

    <div class="container">
        <div class="panel selector-panel">
            <h3>1. ì›ì†Œ ì„ íƒ</h3>
            <div id="elementList">
                </div>
            <div class="status-box">
                <h4>ğŸ“ í•™ìŠµ íŒ</h4>
                <p id="elementTip">ì›ì†Œë¥¼ ì„ íƒí•˜ë©´ íŒì´ í‘œì‹œë©ë‹ˆë‹¤.</p>
            </div>
        </div>

        <div class="panel display-panel">
            <div class="chem-symbol" id="displaySymbol">Na</div>
            <div class="atom-container" id="atomView">
                </div>
            <div id="stabilityBadge" style="margin-top: 20px; font-weight: bold; color: var(--warning-color);">
                ìƒíƒœ: ë¶ˆì•ˆì • (ì˜¥í…Ÿ ê·œì¹™ ë¶ˆë§Œì¡±)
            </div>
        </div>

        <div class="panel control-panel">
            <h3>2. ì „ì ì œì–´</h3>
            <div class="info-grid">
                <p>í˜„ì¬ ì „ì ìˆ˜: <span id="currentElectrons">0</span></p>
                <p>ì›ìê°€ ì „ì: <span id="valenceElectrons">0</span></p>
                <p>í˜„ì¬ ì „í•˜ëŸ‰: <span id="netCharge">0</span></p>
            </div>
            
            <div class="btn-group">
                <button class="action-btn btn-remove" id="btnRemove" onclick="modifyElectron(-1)">ì „ì ìƒê¸° (-)</button>
                <button class="action-btn btn-add" id="btnAdd" onclick="modifyElectron(1)">ì „ì ì–»ê¸° (+)</button>
            </div>
            <button class="action-btn btn-reset" onclick="resetExperiment()" style="width: 100%; margin-top: 10px;">ì´ˆê¸°í™”</button>

            <div class="quiz-section">
                <h3>3. í•™ìŠµ í€´ì¦ˆ</h3>
                <p id="quizQuestion">ë¬¸ì œê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</p>
                <div class="btn-group" id="quizOptions">
                    </div>
                <div class="feedback-msg" id="quizFeedback"></div>
            </div>
        </div>
    </div>

    <script>
        // --- 1. Data & State ---
        const elements = [
            { symbol: 'Na', name: 'ë‚˜íŠ¸ë¥¨', number: 11, group: 1, period: 3, type: 'metal' },
            { symbol: 'Mg', name: 'ë§ˆê·¸ë„¤ìŠ˜', number: 12, group: 2, period: 3, type: 'metal' },
            { symbol: 'O', name: 'ì‚°ì†Œ', number: 8, group: 16, period: 2, type: 'nonmetal' },
            { symbol: 'F', name: 'í”Œë£¨ì˜¤ë¦°', number: 9, group: 17, period: 2, type: 'nonmetal' },
            { symbol: 'Cl', name: 'ì—¼ì†Œ', number: 17, group: 17, period: 3, type: 'nonmetal' },
            { symbol: 'Ne', name: 'ë„¤ì˜¨', number: 10, group: 18, period: 2, type: 'noble' }
        ];

        let currentElement = elements[0];
        let currentElectronCount = 11;
        let isStable = false;

        // --- 2. Initialization ---
        function init() {
            const list = document.getElementById('elementList');
            list.innerHTML = '';
            elements.forEach(el => {
                const btn = document.createElement('div');
                btn.className = 'element-btn';
                btn.innerHTML = `<span>${el.name} (${el.symbol})</span> <small>ì›ìë²ˆí˜¸ ${el.number}</small>`;
                btn.onclick = () => selectElement(el);
                if(el.symbol === currentElement.symbol) btn.classList.add('active');
                list.appendChild(btn);
            });
            selectElement(currentElement);
        }

        function selectElement(el) {
            currentElement = el;
            currentElectronCount = el.number; // ì´ˆê¸° ìƒíƒœëŠ” ì¤‘ì„± ì›ì
            
            // UI ì—…ë°ì´íŠ¸
            document.querySelectorAll('.element-btn').forEach(btn => {
                btn.classList.toggle('active', btn.innerText.includes(el.symbol));
            });
            
            // íŒ ì—…ë°ì´íŠ¸
            updateTip();
            
            // ë Œë”ë§ ë° ìƒíƒœ ì—…ë°ì´íŠ¸
            renderAtom();
            updateStats();
            generateQuiz();
        }

        function updateTip() {
            const tipBox = document.getElementById('elementTip');
            if (currentElement.type === 'noble') {
                tipBox.innerHTML = `<strong>${currentElement.name}</strong>ì€ ë¹„í™œì„± ê¸°ì²´ì…ë‹ˆë‹¤. ì´ë¯¸ ì˜¥í…Ÿ ê·œì¹™ì„ ë§Œì¡±í•˜ì—¬ ë§¤ìš° ì•ˆì •í•©ë‹ˆë‹¤.`;
            } else if (currentElement.type === 'metal') {
                tipBox.innerHTML = `<strong>${currentElement.name}</strong>ì€ ê¸ˆì†ì…ë‹ˆë‹¤. ì „ìë¥¼ ìƒê³  ì–‘ì´ì˜¨ì´ ë˜ê¸° ì‰½ìŠµë‹ˆë‹¤.`;
            } else {
                tipBox.innerHTML = `<strong>${currentElement.name}</strong>ì€ ë¹„ê¸ˆì†ì…ë‹ˆë‹¤. ì „ìë¥¼ ì–»ì–´ ìŒì´ì˜¨ì´ ë˜ê¸° ì‰½ìŠµë‹ˆë‹¤.`;
            }
        }

        // --- 3. Core Logic ---
        function getElectronConfig(electronCount) {
            const shells = [];
            let remaining = electronCount;
            const capacities = [2, 8, 8, 18]; // ë‹¨ìˆœí™”ëœ êµìœ¡ìš© ëª¨ë¸ (K, L, M ê»ì§ˆ)

            for (let cap of capacities) {
                if (remaining <= 0) break;
                let count = Math.min(remaining, cap);
                shells.push(count);
                remaining -= count;
            }
            return shells;
        }

        function modifyElectron(change) {
            // ì œí•œ: ë„ˆë¬´ ë§ì´ ìƒê±°ë‚˜ ì–»ì§€ ì•Šë„ë¡ (êµìœ¡ì  ë²”ìœ„ ë‚´)
            if (change < 0 && currentElectronCount <= currentElement.number - 4) {
                alert("ì¼ë°˜ì ì¸ í™”í•™ ë°˜ì‘ì—ì„œ ì „ìë¥¼ ë„ˆë¬´ ë§ì´ ìƒê¸°ëŠ” ì–´ë µìŠµë‹ˆë‹¤.");
                return;
            }
            if (change > 0 && currentElectronCount >= currentElement.number + 4) {
                alert("ì¼ë°˜ì ì¸ í™”í•™ ë°˜ì‘ì—ì„œ ì „ìë¥¼ ë„ˆë¬´ ë§ì´ ì–»ê¸°ëŠ” ì–´ë µìŠµë‹ˆë‹¤.");
                return;
            }

            currentElectronCount += change;
            renderAtom();
            updateStats();
        }

        function checkStability(config) {
            const valence = config[config.length - 1];
            // í—¬ë¥¨(2) í˜¹ì€ ì˜¥í…Ÿ(8) ë§Œì¡± ì—¬ë¶€
            // ì˜ˆì™¸: ìˆ˜ì†Œ, ë¦¬íŠ¬, ë² ë¦´ë¥¨ ë“±ì˜ í—¬ë¥¨ ì „ìë°°ì¹˜(2) ì²˜ë¦¬, ì—¬ê¸°ì„œëŠ” ê°„ë‹¨íˆ 1ì£¼ê¸° 2, ë‚˜ë¨¸ì§€ 8ë¡œ ì²˜ë¦¬
            if (config.length === 1 && valence === 2) return true;
            if (config.length > 1 && valence === 8) return true;
            return false;
        }

        function resetExperiment() {
            selectElement(currentElement);
        }

        // --- 4. Rendering (Bohr Model) ---
        function renderAtom() {
            const container = document.getElementById('atomView');
            container.innerHTML = ''; // Clear

            // Nucleus
            const nucleus = document.createElement('div');
            nucleus.className = 'nucleus';
            nucleus.innerText = `${currentElement.symbol}\n+${currentElement.number}`;
            container.appendChild(nucleus);

            const config = getElectronConfig(currentElectronCount);
            
            // Render Shells and Electrons
            config.forEach((count, shellIndex) => {
                const shellSize = 100 + (shellIndex * 60);
                const shell = document.createElement('div');
                shell.className = 'shell';
                shell.style.width = `${shellSize}px`;
                shell.style.height = `${shellSize}px`;
                
                // ì „ìê°€ ìœ„ì¹˜í•  ì¤‘ì‹¬ì  ì •ë ¬
                shell.style.left = `calc(50% - ${shellSize/2}px)`;
                shell.style.top = `calc(50% - ${shellSize/2}px)`;
                
                container.appendChild(shell);

                // Electrons placement logic
                const angleStep = 360 / count;
                for (let i = 0; i < count; i++) {
                    const electron = document.createElement('div');
                    electron.className = 'electron';
                    
                    // ê°ë„ì— ë”°ë¥¸ ìœ„ì¹˜ ê³„ì‚°
                    const angle = (angleStep * i) * (Math.PI / 180);
                    const radius = shellSize / 2;
                    const x = Math.cos(angle) * radius + (shellSize / 2); // relative to shell
                    const y = Math.sin(angle) * radius + (shellSize / 2);
                    
                    electron.style.left = `${x}px`;
                    electron.style.top = `${y}px`;
                    
                    // ê»ì§ˆ div ì•ˆì— ë„£ì–´ì„œ ê°™ì´ ëŒê²Œ í•  ìˆ˜ë„ ìˆìœ¼ë‚˜, ì—¬ê¸°ì„œëŠ” ì •ì ìœ¼ë¡œ ë°°ì¹˜
                    shell.appendChild(electron);
                }
            });

            isStable = checkStability(config);
            updateVisualFeedback(config);
        }

        function updateVisualFeedback(config) {
            const statusEl = document.getElementById('stabilityBadge');
            const symbolEl = document.getElementById('displaySymbol');
            const netCharge = currentElement.number - currentElectronCount;
            
            // ì „í•˜ í‘œì‹œ ë¬¸ìì—´
            let chargeStr = '';
            if (netCharge === 0) chargeStr = '';
            else if (netCharge === 1) chargeStr = 'âº';
            else if (netCharge === -1) chargeStr = 'â»';
            else chargeStr = (netCharge > 0 ? `Â²âº` : `Â²â»`).replace('2', Math.abs(netCharge)); // ë‹¨ìˆœí™”

            symbolEl.innerText = `${currentElement.symbol}${chargeStr}`;

            if (isStable) {
                statusEl.innerHTML = `ğŸ‰ ìƒíƒœ: ì•ˆì • (ì˜¥í…Ÿ ê·œì¹™ ë§Œì¡±!)<br><small>ë¹„í™œì„± ê¸°ì²´ì™€ ê°™ì€ ì „ì ë°°ì¹˜ì…ë‹ˆë‹¤.</small>`;
                statusEl.style.color = 'var(--success-color)';
                document.querySelector('.status-box').classList.add('stable');
            } else {
                statusEl.innerText = `âš ï¸ ìƒíƒœ: ë¶ˆì•ˆì •`;
                statusEl.style.color = 'var(--warning-color)';
                document.querySelector('.status-box').classList.remove('stable');
            }
        }

        function updateStats() {
            document.getElementById('currentElectrons').innerText = currentElectronCount;
            
            const config = getElectronConfig(currentElectronCount);
            const valence = config[config.length - 1];
            document.getElementById('valenceElectrons').innerText = valence;

            const charge = currentElement.number - currentElectronCount;
            const chargeText = charge > 0 ? `+${charge}` : charge;
            document.getElementById('netCharge').innerText = chargeText;

            // ë²„íŠ¼ ìƒíƒœ ì œì–´
            document.getElementById('btnAdd').disabled = isStable && currentElement.type !== 'noble'; 
            // ì•ˆì •ì´ ë˜ë©´ ì¡°ì‘ ë©ˆì¶¤ ìœ ë„ (ì›í•˜ë©´ ê³„ì†í•˜ê²Œ í•  ìˆ˜ë„ ìˆìŒ)
        }

        // --- 5. Assessment ---
        function generateQuiz() {
            const qBox = document.getElementById('quizQuestion');
            const optBox = document.getElementById('quizOptions');
            const feedback = document.getElementById('quizFeedback');
            
            optBox.innerHTML = '';
            feedback.innerText = '';
            feedback.style.color = '#333';

            let question = '';
            let correctAnswer = '';
            let options = [];

            if (currentElement.type === 'metal') {
                question = `${currentElement.symbol} ì›ìê°€ ì•ˆì •í•´ì§€ê¸° ìœ„í•´ ê°€ì¥ ìœ ë¦¬í•œ ë³€í™”ëŠ”?`;
                correctAnswer = 'ì „ì ìƒê¸°';
                options = ['ì „ì ìƒê¸°', 'ì „ì ì–»ê¸°'];
            } else if (currentElement.type === 'nonmetal') {
                question = `${currentElement.symbol} ì›ìê°€ ì•ˆì •í•´ì§€ê¸° ìœ„í•´ ê°€ì¥ ìœ ë¦¬í•œ ë³€í™”ëŠ”?`;
                correctAnswer = 'ì „ì ì–»ê¸°';
                options = ['ì „ì ìƒê¸°', 'ì „ì ì–»ê¸°'];
            } else {
                question = `${currentElement.symbol} ì›ìëŠ” í˜„ì¬ ì–´ë–¤ ìƒíƒœì…ë‹ˆê¹Œ?`;
                correctAnswer = 'ì´ë¯¸ ì•ˆì •í•¨';
                options = ['ì „ì ìƒê¸° í•„ìš”', 'ì „ì ì–»ê¸° í•„ìš”', 'ì´ë¯¸ ì•ˆì •í•¨'];
            }

            qBox.innerText = question;

            options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'action-btn';
                btn.style.backgroundColor = '#7f8c8d';
                btn.innerText = opt;
                btn.onclick = () => {
                    if (opt === correctAnswer) {
                        feedback.innerText = "âœ… ì •ë‹µì…ë‹ˆë‹¤! ì˜¥í…Ÿ ê·œì¹™ì„ ë§Œì¡±í•˜ê¸° ìœ„í•œ ì˜¬ë°”ë¥¸ ë°©í–¥ì…ë‹ˆë‹¤.";
                        feedback.style.color = "var(--success-color)";
                    } else {
                        feedback.innerText = "âŒ ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”. ì—ë„ˆì§€ ì¤€ìœ„ì™€ ì›ìê°€ ì „ìë¥¼ í™•ì¸í•˜ì„¸ìš”.";
                        feedback.style.color = "var(--danger-color)";
                    }
                };
                optBox.appendChild(btn);
            });
        }

        // Start
        init();

    </script>
</body>
</html>