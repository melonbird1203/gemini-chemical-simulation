<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°€ìƒ ì‹¤í—˜: ëŸ¬ë”í¼ë“œ ì•ŒíŒŒ ì…ì ì‚°ë€</title>
    <style>
        body {
            font-family: 'Malgun Gothic', sans-serif;
            background-color: #f0f4f8;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 20px;
        }
        h1 { color: #2c3e50; margin-bottom: 10px; }
        .container {
            display: flex;
            gap: 20px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            max-width: 1000px;
            flex-wrap: wrap;
            justify-content: center;
        }
        canvas {
            background-color: #222; /* ìš°ì£¼ ê³µê°„ ê°™ì€ ì–´ë‘ìš´ ë°°ê²½ */
            border-radius: 8px;
            cursor: crosshair;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
        }
        .controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            min-width: 250px;
        }
        .control-group {
            background: #eef2f5;
            padding: 15px;
            border-radius: 8px;
        }
        label { display: block; margin-bottom: 5px; font-weight: bold; font-size: 0.9em; }
        input[type="range"] { width: 100%; }
        select, button {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 5px;
            font-size: 1em;
            cursor: pointer;
            transition: 0.2s;
        }
        button.primary { background-color: #3498db; color: white; }
        button.primary:hover { background-color: #2980b9; }
        button.secondary { background-color: #e67e22; color: white; }
        button.secondary:hover { background-color: #d35400; }
        
        .feedback-box {
            margin-top: 15px;
            padding: 10px;
            background-color: #fff3cd;
            border-left: 5px solid #ffc107;
            border-radius: 4px;
            font-size: 0.9em;
            line-height: 1.4;
        }
        .status { margin-top: 5px; font-size: 0.85em; color: #666; }
    </style>
</head>
<body>

    <h1>âš›ï¸ ëŸ¬ë”í¼ë“œ ì•ŒíŒŒ ì…ì ì‚°ë€ ì‹¤í—˜</h1>
    <p>ë³´ì´ì§€ ì•ŠëŠ” ì›ìí•µ(ë„í˜•)ì„ ì…ìì˜ ê¶¤ì ìœ¼ë¡œ ì°¾ì•„ë³´ì„¸ìš”!</p>

    <div class="container">
        <div>
            <canvas id="simCanvas" width="600" height="400"></canvas>
            <div class="status">ğŸ“Œ ìº”ë²„ìŠ¤ë¥¼ í´ë¦­í•˜ë©´ ê·¸ ìœ„ì¹˜(Yì¶•) ë†’ì´ë¡œ ì…ìê°€ ë°œì‚¬ë©ë‹ˆë‹¤.</div>
        </div>

        <div class="controls">
            <div class="control-group">
                <label for="shapeSelect">ğŸ¯ í‘œì  ëª¨ì–‘ (ì›ìí•µ ëª¨í˜•)</label>
                <select id="shapeSelect">
                    <option value="circle">ì›í˜• (Circle)</option>
                    <option value="triangle">ì‚¼ê°í˜• (Triangle)</option>
                    <option value="rect">ì‚¬ê°í˜• (Rectangle)</option>
                </select>
            </div>

            <div class="control-group">
                <label for="speedRange">ğŸš€ ì…ì ì†ë„ (ì—ë„ˆì§€)</label>
                <input type="range" id="speedRange" min="2" max="10" value="5">
                <div id="speedVal" style="text-align: right; font-size: 0.8em;">5</div>
            </div>

            <button class="primary" id="resetBtn">ğŸ”„ ê¶¤ì  ì§€ìš°ê¸° (ìƒˆ ì‹¤í—˜)</button>
            <button class="secondary" id="revealBtn">ğŸ‘ï¸ ì •ë‹µ(ëª¨ì–‘) ê³µê°œ</button>

            <div id="aiFeedback" class="feedback-box">
                ğŸ‘‹ ì•ˆë…•í•˜ì„¸ìš”! ì‹¤í—˜ì„ ì‹œì‘í•´ë³¼ê¹Œìš”?<br>
                ì™¼ìª½ ìº”ë²„ìŠ¤ë¥¼ í´ë¦­í•˜ì—¬ ì•ŒíŒŒ ì…ìë¥¼ ë°œì‚¬í•´ë³´ì„¸ìš”.
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        const speedRange = document.getElementById('speedRange');
        const shapeSelect = document.getElementById('shapeSelect');
        const revealBtn = document.getElementById('revealBtn');
        const resetBtn = document.getElementById('resetBtn');
        const feedbackBox = document.getElementById('aiFeedback');
        const speedVal = document.getElementById('speedVal');

        let particles = [];
        let isRevealed = false;
        let shape = 'circle';
        let speed = 5;

        // ì¤‘ì•™ ì¥ì• ë¬¼ ì •ì˜
        const obstacle = {
            x: 300,
            y: 200,
            size: 50
        };

        // ì´ˆê¸°í™”
        function init() {
            particles = [];
            isRevealed = false;
            revealBtn.textContent = "ğŸ‘ï¸ ì •ë‹µ(ëª¨ì–‘) ê³µê°œ";
            feedbackBox.innerHTML = "ìƒˆë¡œìš´ ì‹¤í—˜ì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤.<br>ì…ìë¥¼ ë°œì‚¬í•´ ë³´ì´ì§€ ì•ŠëŠ” ëª¨ì–‘ì„ ë§ì¶°ë³´ì„¸ìš”!";
            draw();
        }

        // ì…ì í´ë˜ìŠ¤
        class Particle {
            constructor(y, velocity) {
                this.x = 0;
                this.y = y;
                this.vx = velocity;
                this.vy = 0;
                this.trail = [{x: this.x, y: this.y}];
                this.active = true;
                this.color = '#00ffcc'; // ì•ŒíŒŒ ì…ì ìƒ‰ìƒ (í˜•ê´‘)
            }

            update() {
                if (!this.active) return;

                this.x += this.vx;
                this.y += this.vy;
                this.trail.push({x: this.x, y: this.y});

                // í™”ë©´ ë°–ìœ¼ë¡œ ë‚˜ê°€ë©´ ë¹„í™œì„±í™”
                if (this.x > canvas.width || this.x < 0 || this.y > canvas.height || this.y < 0) {
                    this.active = false;
                }

                // ì¶©ëŒ ê°ì§€ ë° ì²˜ë¦¬
                this.checkCollision();
            }

            checkCollision() {
                // ë„í˜•ì— ë”°ë¼ ë‹¤ë¥¸ ì¶©ëŒ ë¡œì§
                if (shape === 'circle') {
                    const dx = this.x - obstacle.x;
                    const dy = this.y - obstacle.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);

                    if (distance < obstacle.size) {
                        this.reflect(dx, dy);
                    }
                } else if (shape === 'triangle') {
                    // ê°„ë‹¨í•œ ì‚¼ê°í˜• ì¶©ëŒ ë°•ìŠ¤ (ì¤‘ì‹¬ ê¸°ì¤€ ì •ì‚¼ê°í˜• ê·¼ì‚¬)
                    // ì‹¤ì œ ë¬¼ë¦¬ ì—”ì§„ë³´ë‹¤ëŠ” êµìœ¡ì  ì‹œê°í™”ë¥¼ ìœ„í•œ ê·¼ì‚¬ì¹˜ ì‚¬ìš©
                    if (this.x > obstacle.x - obstacle.size && 
                        this.x < obstacle.x + obstacle.size &&
                        this.y > obstacle.y - obstacle.size && 
                        this.y < obstacle.y + obstacle.size) {
                            
                        // ì¤‘ì‹¬ì—ì„œì˜ ìƒëŒ€ ìœ„ì¹˜ë¡œ ë°˜ì‚¬ê° ê³„ì‚°
                        const dx = this.x - obstacle.x;
                        const dy = this.y - obstacle.y;
                        this.reflect(dx, dy);
                    }
                } else if (shape === 'rect') {
                    if (this.x > obstacle.x - obstacle.size && 
                        this.x < obstacle.x + obstacle.size &&
                        this.y > obstacle.y - obstacle.size/1.5 && 
                        this.y < obstacle.y + obstacle.size/1.5) {
                        
                        const dx = this.x - obstacle.x;
                        const dy = this.y - obstacle.y;
                        this.reflect(dx, dy);
                    }
                }
            }

            reflect(dx, dy) {
                // ë°˜ì‚¬ ë²¡í„° ê³„ì‚° (ê°„ëµí™”)
                const angle = Math.atan2(dy, dx);
                const speed = Math.sqrt(this.vx * this.vx + this.vy * this.vy);
                
                // ì…ìê°€ íŠ•ê²¨ ë‚˜ê°€ëŠ” íš¨ê³¼
                this.vx = Math.cos(angle) * speed;
                this.vy = Math.sin(angle) * speed;
                
                // í”¼ë“œë°± ì—…ë°ì´íŠ¸ (ìµœì´ˆ ì¶©ëŒ ì‹œ)
                if(this.active) {
                     feedbackBox.innerHTML = "ğŸ’¥ <b>ì¶©ëŒ ë°œìƒ!</b><br>ì…ìê°€ ë¬´ì–¸ê°€ì— ë§ê³  ê²½ë¡œê°€ íœ˜ì–´ì¡ŒìŠµë‹ˆë‹¤.<br>ì´ ìœ„ì¹˜ì— 'ì›ìí•µ'ì´ ìˆì„ í™•ë¥ ì´ ë†’ì•„ìš”.";
                }
            }

            draw() {
                ctx.beginPath();
                ctx.strokeStyle = `rgba(0, 255, 204, 0.5)`;
                ctx.lineWidth = 2;
                if (this.trail.length > 0) {
                    ctx.moveTo(this.trail[0].x, this.trail[0].y);
                    for (let point of this.trail) {
                        ctx.lineTo(point.x, point.y);
                    }
                }
                ctx.stroke();

                ctx.beginPath();
                ctx.fillStyle = '#fff';
                ctx.arc(this.x, this.y, 3, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function drawShape() {
            ctx.fillStyle = 'rgba(255, 99, 71, 0.8)'; // ì›ìí•µ ìƒ‰ìƒ
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 2;
            
            ctx.beginPath();
            if (shape === 'circle') {
                ctx.arc(obstacle.x, obstacle.y, obstacle.size, 0, Math.PI * 2);
            } else if (shape === 'triangle') {
                ctx.moveTo(obstacle.x, obstacle.y - obstacle.size);
                ctx.lineTo(obstacle.x + obstacle.size, obstacle.y + obstacle.size);
                ctx.lineTo(obstacle.x - obstacle.size, obstacle.y + obstacle.size);
                ctx.closePath();
            } else if (shape === 'rect') {
                ctx.rect(obstacle.x - obstacle.size, obstacle.y - obstacle.size/1.5, obstacle.size*2, obstacle.size*1.33);
            }
            ctx.fill();
            ctx.stroke();

            // í…ìŠ¤íŠ¸ í‘œì‹œ
            ctx.fillStyle = 'white';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText("ì›ìí•µ", obstacle.x, obstacle.y + 5);
        }

        function draw() {
            // ë°°ê²½ ì§€ìš°ê¸° (ì”ìƒ íš¨ê³¼ë¥¼ ìœ„í•´ íˆ¬ëª…ë„ ìˆëŠ” ê²€ì€ìƒ‰ ë®ê¸° ê°€ëŠ¥í•˜ë‚˜ ì—¬ê¸°ì„  ì™„ì „ ì‚­ì œ)
            ctx.fillStyle = '#222';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // íƒ€ê²Ÿ ê·¸ë¦¬ê¸° (ê³µê°œ ìƒíƒœì¼ ë•Œë§Œ)
            if (isRevealed) {
                drawShape();
            } else {
                // ìˆ¨ê²¨ì§„ ìƒíƒœ íŒíŠ¸ (ì„ íƒì‚¬í•­: ë¬¼ìŒí‘œ ë“±)
                ctx.fillStyle = 'rgba(255,255,255,0.05)';
                ctx.font = '50px Arial';
                ctx.textAlign = 'center';
                ctx.fillText("?", obstacle.x, obstacle.y + 15);
            }

            // ì…ì ê·¸ë¦¬ê¸°
            particles.forEach(p => {
                p.update();
                p.draw();
            });

            requestAnimationFrame(draw);
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        canvas.addEventListener('mousedown', (e) => {
            const rect = canvas.getBoundingClientRect();
            const y = e.clientY - rect.top;
            
            // ì…ì ë°œì‚¬
            particles.push(new Particle(y, parseFloat(speed)));
            
            if(particles.length === 1) {
                feedbackBox.innerHTML = "ğŸš€ ì…ìê°€ ë°œì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!<br>ê²½ë¡œë¥¼ ì˜ ê´€ì°°í•´ ë³´ì„¸ìš”.";
            }
        });

        resetBtn.addEventListener('click', init);

        revealBtn.addEventListener('click', () => {
            isRevealed = !isRevealed;
            if (isRevealed) {
                revealBtn.textContent = "ğŸ™ˆ ì •ë‹µ ìˆ¨ê¸°ê¸°";
                feedbackBox.innerHTML = "âœ¨ <b>ì •ë‹µ ê³µê°œ!</b><br>ì˜ˆì¸¡í•œ ëª¨ì–‘ê³¼ ì‹¤ì œ ì›ìí•µ ëª¨ì–‘ì´ ì¼ì¹˜í•˜ë‚˜ìš”?<br>ì´ ì‹¤í—˜ìœ¼ë¡œ ì›ì ì¤‘ì‹¬ì— ë­‰ì³ìˆëŠ” í•µì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤.";
            } else {
                revealBtn.textContent = "ğŸ‘ï¸ ì •ë‹µ(ëª¨ì–‘) ê³µê°œ";
            }
        });

        shapeSelect.addEventListener('change', (e) => {
            shape = e.target.value;
            init(); // ëª¨ì–‘ ë°”ê¾¸ë©´ ì´ˆê¸°í™”
        });

        speedRange.addEventListener('input', (e) => {
            speed = e.target.value;
            speedVal.textContent = speed;
        });

        // ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
        draw();

    </script>
</body>
</html>