<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°€ìƒ í™”í•™ ì‹¤í—˜ì‹¤: ì¦ê¸°ì•• ê³¡ì„  í•´ì„</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #f5f6fa;
            --accent-color: #e74c3c;
            --text-color: #2c3e50;
        }

        body {
            font-family: 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
            background-color: var(--secondary-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 1000px;
        }

        h1 { margin: 0; color: var(--primary-color); }
        p.subtitle { color: #7f8c8d; margin-top: 5px; }

        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            max-width: 1200px;
            width: 100%;
            justify-content: center;
        }

        .control-panel, .visual-panel, .info-panel {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        /* ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        .control-panel {
            flex: 1;
            min-width: 300px;
        }

        .control-group { margin-bottom: 20px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; }
        
        select, input[type="range"] {
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }

        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            width: 100%;
            margin-top: 10px;
            transition: background 0.3s;
        }
        button:hover { background-color: #357abd; }

        /* ì‹œê°í™” íŒ¨ë„ */
        .visual-panel {
            flex: 2;
            min-width: 400px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #graph-container {
            width: 100%;
            height: 400px;
        }

        /* ì…ì ì• ë‹ˆë©”ì´ì…˜ ì˜ì—­ */
        #beaker-view {
            width: 200px;
            height: 250px;
            border: 3px solid #ccc;
            border-top: none;
            position: relative;
            margin-top: 20px;
            background: linear-gradient(to bottom, #e0f7fa 0%, #b2ebf2 100%);
            overflow: hidden;
            border-radius: 0 0 10px 10px;
        }

        .liquid-surface {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 60%;
            background: rgba(74, 144, 226, 0.3);
            border-top: 2px solid #4a90e2;
            transition: height 0.5s;
        }

        .particle {
            position: absolute;
            width: 8px;
            height: 8px;
            background-color: var(--primary-color);
            border-radius: 50%;
            opacity: 0.7;
        }

        .bubble {
            position: absolute;
            width: 15px;
            height: 15px;
            border: 2px solid white;
            border-radius: 50%;
            background: rgba(255,255,255,0.4);
            animation: rise 2s infinite linear;
            display: none;
        }

        @keyframes rise {
            0% { bottom: 0; opacity: 0; transform: scale(0.5); }
            50% { opacity: 1; }
            100% { bottom: 100%; opacity: 0; transform: scale(1.2); }
        }

        /* ì •ë³´ ë° í€´ì¦ˆ íŒ¨ë„ */
        .info-panel {
            width: 100%;
            max-width: 1000px;
        }

        .status-display {
            display: flex;
            justify-content: space-around;
            background: #ecf0f1;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .highlight { color: var(--accent-color); }
        
        .quiz-section {
            margin-top: 20px;
            border-top: 2px dashed #ddd;
            padding-top: 20px;
        }

        .feedback {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            display: none;
        }
        .feedback.correct { background-color: #d4edda; color: #155724; }
        .feedback.wrong { background-color: #f8d7da; color: #721c24; }

    </style>
</head>
<body>

<header>
    <h1>ğŸ§ª ì¦ê¸°ì•• ê³¡ì„ ê³¼ ë“ëŠ”ì  ì‹¤í—˜ì‹¤</h1>
    <p class="subtitle">ì˜¨ë„ì™€ ì••ë ¥ì„ ì¡°ì ˆí•˜ì—¬ ë¬¼ì§ˆì˜ ìƒíƒœ ë³€í™”ë¥¼ ê´€ì°°í•´ë³´ì„¸ìš”.</p>
</header>

<div class="container">
    <div class="control-panel">
        <h3>âš™ï¸ ì‹¤í—˜ ì„¤ì •</h3>
        
        <div class="control-group">
            <label for="substance-select">ğŸ§ª ë¬¼ì§ˆ ì„ íƒ</label>
            <select id="substance-select" onchange="updateSimulation()">
                <option value="ether">ë‹¤ì´ì—í‹¸ ì—í…Œë¥´</option>
                <option value="ethanol">ì—íƒ„ì˜¬</option>
                <option value="water" selected>ë¬¼</option>
                <option value="mercury">ìˆ˜ì€ (ì°¸ê³ ìš©)</option>
            </select>
        </div>

        <div class="control-group">
            <label for="pressure-select">âš–ï¸ ì™¸ë¶€ ì••ë ¥ ($P_{ext}$)</label>
            <select id="pressure-select" onchange="updateSimulation()">
                <option value="0.5">0.5 ê¸°ì•• (ë†’ì€ ì‚°)</option>
                <option value="1.0" selected>1.0 ê¸°ì•• (í‘œì¤€)</option>
                <option value="2.0">2.0 ê¸°ì•• (ì••ë ¥ì†¥)</option>
            </select>
        </div>

        <div class="control-group">
            <label>ğŸŒ¡ï¸ ì˜¨ë„ ì¡°ì ˆ: <span id="temp-display">25</span>Â°C</label>
            <input type="range" id="temp-slider" min="0" max="150" value="25" oninput="updateSimulation()">
        </div>

        <div class="control-group">
            <button onclick="resetExperiment()">ğŸ”„ ì‹¤í—˜ ì´ˆê¸°í™”</button>
            <button onclick="window.print()">ğŸ“„ ë³´ê³ ì„œ ì¸ì‡„ (PDF)</button>
        </div>
    </div>

    <div class="visual-panel">
        <div class="status-display">
            <span>í˜„ì¬ ì¦ê¸°ì••: <span id="vp-display" class="highlight">0</span> atm</span>
            <span>ìƒíƒœ: <span id="state-display">ì•¡ì²´</span></span>
        </div>

        <div id="graph-container"></div>

        <div id="beaker-view">
            <div class="liquid-surface" id="liquid"></div>
            </div>
        <p style="font-size: 0.9em; color: #666;">*ì…ìì˜ ì†ë„ëŠ” ì˜¨ë„ë¥¼, ê¸°í¬ëŠ” ë“ìŒì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</p>
    </div>
</div>

<div class="container">
    <div class="info-panel">
        <h3>ğŸ§  ê°œë… í™•ì¸ í€´ì¦ˆ</h3>
        <div class="quiz-section">
            <p><strong>Q. í˜„ì¬ ì„ íƒëœ ë¬¼ì§ˆì˜ 1ê¸°ì•• ê¸°ì¤€ ì •ìƒ ë“ëŠ”ì ì€ ë¶„ì ê°„ ì¸ë ¥ê³¼ ì–´ë–¤ ê´€ê³„ê°€ ìˆë‚˜ìš”?</strong></p>
            <div style="display: flex; gap: 10px;">
                <button onclick="checkQuiz(1)">ë“ëŠ”ì ì´ ë†’ì„ìˆ˜ë¡ ì¸ë ¥ì´ ì•½í•˜ë‹¤.</button>
                <button onclick="checkQuiz(2)">ë“ëŠ”ì ì´ ë†’ì„ìˆ˜ë¡ ì¸ë ¥ì´ ê°•í•˜ë‹¤.</button>
            </div>
            <div id="quiz-feedback" class="feedback"></div>
        </div>
        
        <div style="margin-top: 20px;">
            <h4>ğŸ“ ì‹¤í—˜ ë…¸íŠ¸</h4>
            <p id="experiment-note">ì‹¤í—˜ì„ ì‹œì‘í•˜ì—¬ ê²°ê³¼ë¥¼ ê´€ì°°í•˜ì„¸ìš”.</p>
        </div>
    </div>
</div>

<script>
    // ë¬¼ì§ˆë³„ Antoine ìƒìˆ˜ (ê·¼ì‚¬ì¹˜, P in mmHg -> convert to atm, T in Celsius)
    // log10(P) = A - B / (T + C)
    const substances = {
        ether: { name: "ë‹¤ì´ì—í‹¸ ì—í…Œë¥´", A: 6.9203, B: 1064.07, C: 228.8, color: "#e74c3c", bp_1atm: 34.6 },
        ethanol: { name: "ì—íƒ„ì˜¬", A: 8.20417, B: 1642.89, C: 230.3, color: "#2ecc71", bp_1atm: 78.3 },
        water: { name: "ë¬¼", A: 8.07131, B: 1730.63, C: 233.426, color: "#3498db", bp_1atm: 100.0 },
        mercury: { name: "ìˆ˜ì€", A: 7.9620, B: 3300.0, C: 273.0, color: "#95a5a6", bp_1atm: 356.7 } // ìˆ˜ì€ì€ ë°ì´í„° ê·¼ì‚¬
    };

    let particles = [];
    const beaker = document.getElementById('beaker-view');

    // ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    window.onload = function() {
        createParticles();
        initGraph();
        updateSimulation();
    };

    function getVaporPressure(substanceKey, tempC) {
        const s = substances[substanceKey];
        // ìˆ˜ì€ì˜ ê²½ìš° ë²”ìœ„ê°€ ë‹¬ë¼ ë‹¨ìˆœí™”ëœ ì‹ ì‚¬ìš© í˜¹ì€ ë²”ìœ„ ì œí•œ
        if(substanceKey === 'mercury' && tempC < 100) return 0.001; 

        // Antoine Equation: P(mmHg)
        const p_mmHg = Math.pow(10, s.A - (s.B / (tempC + s.C)));
        return p_mmHg / 760.0; // Convert to atm
    }

    function initGraph() {
        const layout = {
            title: 'ì¦ê¸°ì•• ê³¡ì„  (P vs T)',
            xaxis: { title: 'ì˜¨ë„ (Â°C)', range: [0, 150] },
            yaxis: { title: 'ì••ë ¥ (atm)', range: [0, 2.5] },
            margin: { t: 40, r: 20, b: 40, l: 50 },
            showlegend: true
        };
        Plotly.newPlot('graph-container', [], layout, {displayModeBar: false});
    }

    function updateSimulation() {
        const subKey = document.getElementById('substance-select').value;
        const temp = parseFloat(document.getElementById('temp-slider').value);
        const extP = parseFloat(document.getElementById('pressure-select').value);
        const subData = substances[subKey];

        // 1. í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        document.getElementById('temp-display').textContent = temp;
        
        // 2. ì¦ê¸°ì•• ê³„ì‚°
        let currentVP = getVaporPressure(subKey, temp);
        document.getElementById('vp-display').textContent = currentVP.toFixed(3);

        // 3. ìƒíƒœ íŒë‹¨ (ë“ìŒ ì—¬ë¶€)
        const isBoiling = currentVP >= extP;
        const stateText = isBoiling ? "ë“ëŠ” ì¤‘ (ê¸°í¬ ë°œìƒ!)" : "ì•¡ì²´ (ì¦ë°œ ì¤‘)";
        const stateDisplay = document.getElementById('state-display');
        stateDisplay.textContent = stateText;
        stateDisplay.style.color = isBoiling ? "red" : "black";
        stateDisplay.style.fontWeight = isBoiling ? "bold" : "normal";

        // 4. ê·¸ë˜í”„ ì—…ë°ì´íŠ¸
        updateGraph(subKey, temp, extP, currentVP);

        // 5. ì• ë‹ˆë©”ì´ì…˜ ì—…ë°ì´íŠ¸
        updateParticles(temp, isBoiling);

        // 6. ë…¸íŠ¸ ì—…ë°ì´íŠ¸
        updateNote(subData.name, temp, currentVP, extP, isBoiling);
    }

    function updateGraph(subKey, currentTemp, extP, currentVP) {
        // ê³¡ì„  ë°ì´í„° ìƒì„± (0~150ë„)
        const xData = [];
        const yData = [];
        for(let t=0; t<=150; t+=5) {
            xData.push(t);
            yData.push(getVaporPressure(subKey, t));
        }

        // ì¦ê¸°ì•• ê³¡ì„  íŠ¸ë ˆì´ìŠ¤
        const curveTrace = {
            x: xData,
            y: yData,
            mode: 'lines',
            name: substances[subKey].name,
            line: { color: substances[subKey].color, width: 3 }
        };

        // ì™¸ë¶€ ì••ë ¥ ì„  (ìˆ˜í‰ì„ )
        const pressureLine = {
            x: [0, 150],
            y: [extP, extP],
            mode: 'lines',
            name: 'ì™¸ë¶€ ì••ë ¥',
            line: { color: 'black', dash: 'dash', width: 1 }
        };

        // í˜„ì¬ ìƒíƒœ ì 
        const currentPoint = {
            x: [currentTemp],
            y: [currentVP],
            mode: 'markers',
            name: 'í˜„ì¬ ìƒíƒœ',
            marker: { size: 10, color: 'red' }
        };

        const layout = {
            title: `${substances[subKey].name}ì˜ ì¦ê¸°ì•• ê³¡ì„ `,
            xaxis: { title: 'ì˜¨ë„ (Â°C)', range: [0, 150] },
            yaxis: { title: 'ì••ë ¥ (atm)', range: [0, 2.2] },
            annotations: [{
                x: 140, y: extP,
                xref: 'x', yref: 'y',
                text: `${extP} atm`,
                showarrow: false,
                yshift: 10
            }]
        };

        Plotly.react('graph-container', [curveTrace, pressureLine, currentPoint], layout);
    }

    // ê°„ë‹¨í•œ ì…ì ì‹œìŠ¤í…œ
    function createParticles() {
        for(let i=0; i<20; i++) {
            const p = document.createElement('div');
            p.className = 'particle';
            p.style.left = Math.random() * 180 + 'px';
            p.style.bottom = Math.random() * 100 + 'px';
            beaker.appendChild(p);
            particles.push({ el: p, vx: Math.random()-0.5, vy: Math.random()-0.5 });
        }
        
        // ê¸°í¬ ìƒì„± (ìˆ¨ê²¨ë‘ )
        for(let i=0; i<5; i++) {
            const b = document.createElement('div');
            b.className = 'bubble';
            b.style.left = Math.random() * 180 + 'px';
            beaker.appendChild(b);
        }
    }

    function updateParticles(temp, isBoiling) {
        // ì˜¨ë„ì— ë”°ë¥¸ ì…ì ì†ë„ ì¡°ì ˆ (ì‹œê°ì  íš¨ê³¼)
        const speedFactor = (temp + 20) / 100; // 0ë„ì¼ë•Œë„ ì•½ê°„ ì›€ì§ì„
        
        // ê¸°í¬ í‘œì‹œ ì œì–´
        const bubbles = document.querySelectorAll('.bubble');
        bubbles.forEach(b => {
            b.style.display = isBoiling ? 'block' : 'none';
            b.style.animationDuration = (2.5 - speedFactor) + 's'; // ì˜¨ë„ê°€ ë†’ìœ¼ë©´ ë¹¨ë¦¬ ì˜¬ë¼ê°
        });

        // ìƒ‰ìƒ ë³€ê²½ (ì˜¨ë„ê°)
        const liquid = document.getElementById('liquid');
        if(temp > 80) liquid.style.background = 'rgba(231, 76, 60, 0.3)';
        else liquid.style.background = 'rgba(74, 144, 226, 0.3)';
    }

    function updateNote(name, temp, vp, extP, isBoiling) {
        const note = document.getElementById('experiment-note');
        let msg = `${name}ì˜ í˜„ì¬ ì˜¨ë„ëŠ” ${temp}Â°C ì´ë©°, ì¦ê¸°ì••ì€ ì•½ ${vp.toFixed(2)}ê¸°ì••ì…ë‹ˆë‹¤.<br>`;
        if (isBoiling) {
            msg += `<strong>ğŸ”¥ ê²°ê³¼: ì¦ê¸°ì••ì´ ì™¸ë¶€ ì••ë ¥(${extP}ê¸°ì••)ë³´ë‹¤ ì»¤ì ¸ì„œ ë“ê³  ìˆìŠµë‹ˆë‹¤!</strong>`;
        } else {
            msg += `ê²°ê³¼: ì¦ê¸°ì••ì´ ì™¸ë¶€ ì••ë ¥ë³´ë‹¤ ë‚®ì•„ ì•„ì§ ë“ì§€ ì•ŠìŠµë‹ˆë‹¤. ì˜¨ë„ë¥¼ ë” ë†’ì—¬ë³´ì„¸ìš”.`;
        }
        note.innerHTML = msg;
    }

    function checkQuiz(answer) {
        const feedback = document.getElementById('quiz-feedback');
        feedback.style.display = 'block';
        
        if (answer === 2) {
            feedback.textContent = "ì •ë‹µì…ë‹ˆë‹¤! â­• ë¶„ì ê°„ ì¸ë ¥ì´ ê°•í• ìˆ˜ë¡ ì„œë¡œ ë–¨ì–´ì§€ê¸° ì‹«ì–´í•˜ë¯€ë¡œ ì¦ê¸°ì••ì´ ë‚®ê³ , ë“ëŠ”ì ì€ ë†’ì•„ì§‘ë‹ˆë‹¤.";
            feedback.className = "feedback correct";
        } else {
            feedback.textContent = "ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”. âŒ ì„œë¡œ ê°•í•˜ê²Œ ì¡ê³  ìˆë‹¤ë©´ ê¸°ì²´ê°€ ë˜ê¸°(ë“ê¸°) ì‰¬ìš¸ê¹Œìš”, ì–´ë ¤ìš¸ê¹Œìš”?";
            feedback.className = "feedback wrong";
        }
    }

    function resetExperiment() {
        document.getElementById('temp-slider').value = 25;
        document.getElementById('substance-select').value = "water";
        document.getElementById('pressure-select').value = "1.0";
        document.getElementById('quiz-feedback').style.display = 'none';
        updateSimulation();
    }
</script>

</body>
</html>