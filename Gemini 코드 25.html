<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³¼í•™ ë®¤ì§ë¹„ë””ì˜¤ ê°ë…: ìƒíƒœ ë³€í™” í¸</title>
    <style>
        :root {
            --primary: #6c5ce7;
            --secondary: #a29bfe;
            --accent: #fd79a8;
            --bg: #dfe6e9;
            --panel: #ffffff;
        }
        body {
            font-family: 'Malgun Gothic', sans-serif;
            background-color: var(--bg);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1 { color: #2d3436; margin-bottom: 10px; }
        .container {
            display: flex;
            gap: 20px;
            max-width: 1200px;
            width: 100%;
            flex-wrap: wrap;
        }
        .control-panel, .info-panel {
            flex: 1;
            background: var(--panel);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            min-width: 300px;
        }
        .stage-panel {
            flex: 2;
            background: #2d3436;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 400px;
            position: relative;
        }
        canvas {
            background: #000;
            border-radius: 10px;
            border: 2px solid #636e72;
        }
        button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            font-size: 1rem;
            transition: 0.2s;
        }
        button:hover { background: var(--secondary); }
        button.active { background: var(--accent); }
        
        .lyrics-box {
            margin-top: 15px;
            width: 100%;
            background: rgba(255,255,255,0.1);
            color: #fff;
            padding: 15px;
            border-radius: 10px;
            min-height: 100px;
            text-align: center;
            font-size: 1.2rem;
            line-height: 1.6;
        }
        .energy-indicator {
            margin-top: 10px;
            font-weight: bold;
            font-size: 1.2rem;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            width: 80%;
        }
        .heat-absorb { background: #ff7675; color: white; animation: pulse 2s infinite; }
        .heat-release { background: #74b9ff; color: white; animation: pulse 2s infinite; }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        .guide-text { font-size: 0.9rem; color: #636e72; margin-top: 10px; }
        select, textarea {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border-radius: 5px;
            border: 1px solid #b2bec3;
        }
    </style>
</head>
<body>

    <h1>ğŸ¬ ê³¼í•™ ë®¤ì§ë¹„ë””ì˜¤ ê°ë…: ë¬¼ì§ˆì˜ ìƒíƒœ ë³€í™”</h1>
    <p>ì…ì ëª¨í˜•ì„ ì—°ì¶œí•˜ê³ , ì—´ì—ë„ˆì§€ì˜ íë¦„ì„ ê°€ì‚¬ë¡œ í‘œí˜„í•´ë³´ì„¸ìš”!</p>

    <div class="container">
        <div class="control-panel">
            <h3>ğŸ›ï¸ ì—°ì¶œ ì„¤ì • (Director Mode)</h3>
            <p><strong>1. ìƒíƒœ ë³€í™” ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ</strong></p>
            <div id="buttons">
                <button onclick="changeMode('melting')">ìœµí•´ (ê³ ì²´â¡ì•¡ì²´)</button>
                <button onclick="changeMode('freezing')">ì‘ê³  (ì•¡ì²´â¡ê³ ì²´)</button>
                <button onclick="changeMode('vaporization')">ê¸°í™” (ì•¡ì²´â¡ê¸°ì²´)</button>
                <button onclick="changeMode('condensation')">ì•¡í™” (ê¸°ì²´â¡ì•¡ì²´)</button>
                <button onclick="changeMode('sublimation_heat')">ìŠ¹í™” (ê³ ì²´â¡ê¸°ì²´)</button>
            </div>
            
            <p><strong>2. ë°°ê²½ ìŒì•… (BGM)</strong></p>
            <select id="bgmSelect">
                <option>ì‹ ë‚˜ëŠ” íŒ (Pop)</option>
                <option>ì°¨ë¶„í•œ ë°œë¼ë“œ (Ballad)</option>
                <option>ê°•ë ¬í•œ ë½ (Rock)</option>
            </select>

            <div class="guide-text">
                * íŒ: ì…ìê°€ í™œë°œí•´ì§€ë©´(ì—´ í¡ìˆ˜) ì‹ ë‚˜ëŠ” ìŒì•…ì´, ì…ìê°€ ë‘”í•´ì§€ë©´(ì—´ ë°©ì¶œ) ì°¨ë¶„í•œ ìŒì•…ì´ ì–´ìš¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </div>
        </div>

        <div class="stage-panel">
            <h3 style="color:white; margin:0 0 10px 0;">ğŸ“º ë®¤ì§ë¹„ë””ì˜¤ ë¯¸ë¦¬ë³´ê¸° (On Air)</h3>
            <canvas id="particleCanvas" width="400" height="300"></canvas>
            
            <div id="energyDisplay" class="energy-indicator" style="display:none;"></div>
            
            <div class="lyrics-box" id="lyricsDisplay">
                "ë²„íŠ¼ì„ ëˆŒëŸ¬ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”."
            </div>
        </div>

        <div class="info-panel">
            <h3>ğŸ“ ê°€ì‚¬ & ê°œë… ë…¸íŠ¸</h3>
            <p><strong>í˜„ì¬ ìƒíƒœ ë³€í™”:</strong> <span id="statusName" style="color:var(--primary); font-weight:bold;">-</span></p>
            
            <p><strong>ì…ì ê°ë…ì˜ ì½”ë©˜íŠ¸:</strong></p>
            <div id="feedback" style="background:#f1f2f6; padding:10px; border-radius:5px; font-size:0.9rem;">
                ëŒ€ê¸° ì¤‘...
            </div>

            <p><strong>âœï¸ ë‚˜ë§Œì˜ ê°€ì‚¬ ì“°ê¸°:</strong></p>
            <textarea id="userLyrics" rows="4" placeholder="ì˜ˆ) ì–¼ìŒì´ ë…¹ì•„ ë¬¼ì´ ë˜ë„¤, ì—´ì„ ë°›ì•„ì„œ ì¶¤ì„ ì¶”ë„¤~"></textarea>
            <button onclick="applyLyrics()" style="width:100%; margin: 10px 0;">ê°€ì‚¬ ì ìš©í•˜ê¸°</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('particleCanvas');
        const ctx = canvas.getContext('2d');
        let particles = [];
        let animationId;
        let currentState = 'solid'; // solid, liquid, gas
        let targetState = 'solid';
        let transitionProgress = 0;
        
        // ì…ì í´ë˜ìŠ¤
        class Particle {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.baseX = x;
                this.baseY = y;
                this.vx = 0;
                this.vy = 0;
                this.speed = 0.5;
                this.range = 2; // ì§„ë™ ë²”ìœ„
                this.color = '#74b9ff'; // ì°¨ê°€ìš´ ìƒ‰
            }

            update(state) {
                if (state === 'solid') {
                    // ê³ ì²´: ì œìë¦¬ ì§„ë™, ê·œì¹™ì  ë°°ì—´ ìœ ì§€
                    this.x = this.baseX + (Math.random() - 0.5) * 2;
                    this.y = this.baseY + (Math.random() - 0.5) * 2;
                    this.color = '#74b9ff'; // íŒŒë‘ (ì €ì˜¨)
                } else if (state === 'liquid') {
                    // ì•¡ì²´: ë¹„êµì  ììœ ë¡œìš´ ì›€ì§ì„, ë°”ë‹¥ì— ê¹”ë¦¼
                    this.x += (Math.random() - 0.5) * 2;
                    this.y += (Math.random() - 0.5) * 2;
                    
                    // ë²½ ì¶©ëŒ (ìš©ê¸° ëª¨ì–‘ ìœ ì§€í•˜ë ¤ ë…¸ë ¥)
                    if(this.x < 10) this.x = 10;
                    if(this.x > canvas.width - 10) this.x = canvas.width - 10;
                    if(this.y < canvas.height / 2) this.y = canvas.height / 2; // ìœ„ìª½ ì œí•œ (ì¤‘ë ¥)
                    if(this.y > canvas.height - 10) this.y = canvas.height - 10;
                    
                    this.color = '#fdcb6e'; // ë…¸ë‘ (ì¤‘ì˜¨)
                } else if (state === 'gas') {
                    // ê¸°ì²´: ë§¤ìš° ë¹ ë¥´ê³  ììœ ë¡œì›€, ê³µê°„ ì „ì²´
                    this.x += (Math.random() - 0.5) * 10;
                    this.y += (Math.random() - 0.5) * 10;
                    
                    // ë²½ íŠ•ê¸°ê¸°
                    if(this.x < 0) this.x = canvas.width;
                    if(this.x > canvas.width) this.x = 0;
                    if(this.y < 0) this.y = canvas.height;
                    if(this.y > canvas.height) this.y = 0;
                    
                    this.color = '#ff7675'; // ë¹¨ê°• (ê³ ì˜¨)
                }
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, 8, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.closePath();
            }
        }

        // ì…ì ì´ˆê¸°í™” (ê³ ì²´ ë°°ì—´)
        function initParticles() {
            particles = [];
            const cols = 10;
            const rows = 8;
            const spacing = 30;
            const offsetX = (canvas.width - (cols * spacing)) / 2;
            const offsetY = canvas.height - (rows * spacing) - 20;

            for (let i = 0; i < cols; i++) {
                for (let j = 0; j < rows; j++) {
                    particles.push(new Particle(offsetX + i * spacing, offsetY + j * spacing));
                }
            }
        }

        function animate() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.2)'; // ì”ìƒ íš¨ê³¼
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            particles.forEach(p => {
                p.update(currentState);
                p.draw();
            });

            animationId = requestAnimationFrame(animate);
        }

        // ëª¨ë“œ ë³€ê²½ í•¨ìˆ˜
        function changeMode(mode) {
            const statusName = document.getElementById('statusName');
            const feedback = document.getElementById('feedback');
            const energyDisplay = document.getElementById('energyDisplay');
            const lyricsDisplay = document.getElementById('lyricsDisplay');
            
            let conceptText = "";
            let lyricsText = "";
            let energyClass = "";
            let energyText = "";

            if (mode === 'melting') {
                currentState = 'liquid';
                statusName.innerText = "ìœµí•´ (Melting)";
                conceptText = "ê³ ì²´ê°€ ì—´ì„ í¡ìˆ˜í•˜ì—¬ ì•¡ì²´ë¡œ ë³€í•©ë‹ˆë‹¤. ì…ìë“¤ì˜ ìš´ë™ì´ í™œë°œí•´ì§€ê³  ê·œì¹™ì„±ì´ ë¬´ë„ˆì§‘ë‹ˆë‹¤.";
                lyricsText = "ğŸ¶ ê½ê½ ì–¼ì–´ìˆë˜ ë‚´ ë§ˆìŒ(ê³ ì²´), ë„ˆì˜ ë”°ìŠ¤í•¨(ì—´)ì— ë…¹ì•„ë‚´ë ¤(ìœµí•´)~ ììœ ë¡­ê²Œ íë¥´ëŠ” ë¬¼ê²°ì²˜ëŸ¼(ì•¡ì²´)!";
                energyClass = "heat-absorb";
                energyText = "ğŸ”¥ ì—´ì—ë„ˆì§€ í¡ìˆ˜ ì¤‘ (ì£¼ë³€ ì˜¨ë„ ë‚®ì•„ì§)";
            } else if (mode === 'freezing') {
                currentState = 'solid';
                // ê°•ì œ ìœ„ì¹˜ ì¬ì •ë ¬ (ì‹œê°ì  íš¨ê³¼)
                initParticles(); 
                statusName.innerText = "ì‘ê³  (Freezing)";
                conceptText = "ì•¡ì²´ê°€ ì—´ì„ ìƒì–´ ê³ ì²´ë¡œ ë³€í•©ë‹ˆë‹¤. ì…ìë“¤ì´ ì œìë¦¬ì—ì„œ ì§„ë™í•˜ë©° ê·œì¹™ì ìœ¼ë¡œ ë°°ì—´ë©ë‹ˆë‹¤.";
                lyricsText = "ğŸ¶ ììœ ë¡­ë˜ ìš°ë¦¬(ì•¡ì²´), ì°¨ê°€ìš´ ë°”ëŒì— êµ³ì–´ê°€ë„¤(ì‘ê³ ). ì„œë¡œ ê½‰ ë¶™ì¡ê³ (ì¸ë ¥) ì œìë¦¬ì—ì„œ ë–¨ê³  ìˆì–´(ê³ ì²´).";
                energyClass = "heat-release";
                energyText = "â„ï¸ ì—´ì—ë„ˆì§€ ë°©ì¶œ ì¤‘ (ì£¼ë³€ ì˜¨ë„ ë†’ì•„ì§)";
            } else if (mode === 'vaporization') {
                currentState = 'gas';
                statusName.innerText = "ê¸°í™” (Vaporization)";
                conceptText = "ì•¡ì²´ê°€ ì—´ì„ í¡ìˆ˜í•´ ê¸°ì²´ê°€ ë©ë‹ˆë‹¤. ì…ì ì‚¬ì´ ê±°ë¦¬ê°€ ë§¤ìš° ë©€ì–´ì§€ê³  ë§¤ìš° ë¹ ë¥´ê²Œ ìš´ë™í•©ë‹ˆë‹¤.";
                lyricsText = "ğŸ¶ ë” ëœ¨ê²ê²Œ(ê°€ì—´)! ë‚œ ë‚ ì•„ê°ˆ ê±°ì•¼(ê¸°í™”). ì € ë„“ì€ ì„¸ìƒ ëê¹Œì§€ í¼ì ¸ë‚˜ê°€ëŠ”(í™•ì‚°) ììœ ë¡œìš´ ì˜í˜¼(ê¸°ì²´)!";
                energyClass = "heat-absorb";
                energyText = "ğŸ”¥ ì—´ì—ë„ˆì§€ í¡ìˆ˜ ì¤‘ (ì£¼ë³€ ì‹œì›í•´ì§)";
            } else if (mode === 'condensation') {
                currentState = 'liquid';
                statusName.innerText = "ì•¡í™” (Condensation)";
                conceptText = "ê¸°ì²´ê°€ ì—´ì„ ìƒì–´ ì•¡ì²´ê°€ ë©ë‹ˆë‹¤. ì…ì ìš´ë™ì´ ë‘”í•´ì§€ê³  ì„œë¡œ ê°€ê¹Œì›Œì§‘ë‹ˆë‹¤.";
                lyricsText = "ğŸ¶ ì°¨ê°€ìš´ ìœ ë¦¬ì°½ì— ë¶€ë”ªí˜€, í©ì–´ì§„ ë§ˆìŒ(ê¸°ì²´)ì´ ë‹¤ì‹œ ëª¨ì—¬ ëˆˆë¬¼(ì•¡ì²´)ì´ ë˜ë„¤.";
                energyClass = "heat-release";
                energyText = "â„ï¸ ì—´ì—ë„ˆì§€ ë°©ì¶œ ì¤‘ (ì£¼ë³€ ë”°ëœ»í•´ì§)";
            } else if (mode === 'sublimation_heat') {
                currentState = 'gas';
                statusName.innerText = "ìŠ¹í™” (Sublimation)";
                conceptText = "ê³ ì²´ì—ì„œ ë°”ë¡œ ê¸°ì²´ë¡œ ë³€í•©ë‹ˆë‹¤. ë“œë¼ì´ì•„ì´ìŠ¤ì²˜ëŸ¼ ì¤‘ê°„ ê³¼ì • ì—†ì´ ê¸‰ê²©íˆ ë³€í•©ë‹ˆë‹¤.";
                lyricsText = "ğŸ¶ ì‚¬ë¼ì§„ ì¤„ ì•Œì•˜ì§€? ë‚œ ìˆœì‹ê°„ì— ì—°ê¸°ê°€ ë˜ì–´(ìŠ¹í™”) ë„ˆë¥¼ ê°ì‹¸ì•ˆì•„.";
                energyClass = "heat-absorb";
                energyText = "ğŸ”¥ ì—´ì—ë„ˆì§€ ë‹¤ëŸ‰ í¡ìˆ˜";
            }

            feedback.innerHTML = conceptText;
            lyricsDisplay.innerText = lyricsText;
            
            energyDisplay.style.display = 'block';
            energyDisplay.className = 'energy-indicator ' + energyClass;
            energyDisplay.innerText = energyText;
        }

        function applyLyrics() {
            const userText = document.getElementById('userLyrics').value;
            if(userText.trim() === "") {
                alert("ê°€ì‚¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!");
                return;
            }
            document.getElementById('lyricsDisplay').innerText = "ğŸ¤ User Lyrics: " + userText;
            alert("ê°€ì‚¬ê°€ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤! ì‹œê°ì  íŒ¨í„´ê³¼ ì˜ ì–´ìš¸ë¦¬ëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”.");
        }

        // ì´ˆê¸° ì‹¤í–‰
        initParticles();
        animate();

    </script>
</body>
</html>