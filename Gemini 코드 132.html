<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì§ì‚°-ì§ì—¼ê¸° ì„¸ê¸° ë¹„êµ ê°€ìƒì‹¤í—˜</title>
    <style>
        :root {
            --primary: #4A90E2;
            --secondary: #50E3C2;
            --accent: #FF6B6B;
            --bg: #F5F7FA;
            --text: #2C3E50;
        }
        body {
            font-family: 'Pretendard', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        h1, h2, h3 { color: #333; }
        .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #eee; padding-bottom: 20px; }
        
        /* Controls */
        .control-panel {
            background: #eef2f7;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        select, button {
            padding: 10px 15px;
            border-radius: 5px;
            border: 1px solid #ddd;
            font-size: 16px;
            cursor: pointer;
        }
        button { background-color: var(--primary); color: white; border: none; font-weight: bold; }
        button:hover { background-color: #357ABD; }

        /* Visualization */
        .reaction-box {
            font-size: 1.2em;
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: #fff;
            border: 2px dashed var(--primary);
            border-radius: 10px;
        }
        .data-display {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        .card {
            background: #fafafa;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .card.acid { border-color: var(--accent); }
        .card.base { border-color: var(--secondary); }
        
        /* Bar Graphs */
        .bar-container {
            margin-top: 10px;
            background: #ddd;
            height: 20px;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        .bar { height: 100%; transition: width 1s ease-in-out; }
        .bar.acid { background-color: var(--accent); }
        .bar.base { background-color: var(--secondary); }

        /* Feedback Area */
        .feedback {
            margin-top: 20px;
            padding: 15px;
            background-color: #fff3cd;
            border: 1px solid #ffeeba;
            border-radius: 5px;
            display: none;
        }

        /* Quiz Section */
        .quiz-section {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #eee;
        }
        .quiz-options button {
            margin: 5px;
            background: #fff;
            color: var(--text);
            border: 1px solid var(--primary);
        }
        .quiz-options button:hover { background: #eef2f7; }

        /* Utility */
        .formula { font-family: 'Times New Roman', serif; font-style: italic; }
        .superscript { vertical-align: super; font-size: smaller; }
        .subscript { vertical-align: sub; font-size: smaller; }
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>âš—ï¸ ì§ì‚°-ì§ì—¼ê¸° ì„¸ê¸° ë¹„êµ ì‹¤í—˜ì‹¤</h1>
        <p>í™”í•™â…¡: ì‚°ê³¼ ì—¼ê¸°ì˜ í‰í˜• ìƒìˆ˜ ($K_a \times K_b = K_w$)</p>
    </div>

    <div class="control-panel">
        <label for="acidSelect"><strong>ğŸ§ª ì‚°(Acid) ì„ íƒ:</strong></label>
        <select id="acidSelect" onchange="runSimulation()">
            <option value="" disabled selected>ì‹¤í—˜í•  ì‚°ì„ ì„ íƒí•˜ì„¸ìš”</option>
            <option value="HNO3">ì§ˆì‚° (HNOâ‚ƒ) - ê°•ì‚°</option>
            <option value="CH3COOH">ì•„ì„¸íŠ¸ì‚° (CHâ‚ƒCOOH) - ì•½ì‚°</option>
            <option value="HCN">ì‚¬ì´ì•ˆí™”ìˆ˜ì†Œ (HCN) - ë§¤ìš° ì•½í•œ ì‚°</option>
            <option value="NH4">ì•”ëª¨ëŠ„ ì´ì˜¨ (NHâ‚„âº) - ì•½ì‚°</option>
        </select>
        <div>
            <span>ğŸŒ¡ï¸ ì˜¨ë„: <strong>25â„ƒ</strong> (ê³ ì •)</span>
        </div>
    </div>

    <div id="simulationArea" class="hidden">
        <h3>1. í™”í•™ ë°˜ì‘ì‹ ê´€ì°°</h3>
        <div class="reaction-box">
            <span id="reactionDisplay"></span>
        </div>

        <h3>2. ì •ëŸ‰ì  ë°ì´í„° ë¶„ì„</h3>
        <div class="data-display">
            <div class="card acid">
                <h4>ğŸ”¥ ì‚° (Acid)</h4>
                <p><strong>ì´ë¦„:</strong> <span id="acidName"></span></p>
                <p><strong>$K_a$:</strong> <span id="kaValue"></span></p>
                <p>ì„¸ê¸°: <span id="acidStrengthText"></span></p>
                <div class="bar-container">
                    <div id="acidBar" class="bar acid" style="width: 0%"></div>
                </div>
            </div>

            <div class="card base">
                <h4>ğŸ’§ ì§ì—¼ê¸° (Conjugate Base)</h4>
                <p><strong>ì´ë¦„:</strong> <span id="baseName"></span></p>
                <p><strong>$K_b$ ê³„ì‚°:</strong> $K_w / K_a$</p>
                <p><strong>$K_b$:</strong> <span id="kbValue" style="color:blue; font-weight:bold;"></span></p>
                <p>ì„¸ê¸°: <span id="baseStrengthText"></span></p>
                <div class="bar-container">
                    <div id="baseBar" class="bar base" style="width: 0%"></div>
                </div>
            </div>
        </div>

        <div class="feedback" id="analysisFeedback" style="display:block;">
            <strong>ğŸ’¡ AI ë¶„ì„:</strong> <span id="feedbackText"></span>
        </div>
    </div>

    <div class="quiz-section hidden" id="quizSection">
        <h3>ğŸ“ ê°œë… í™•ì¸ í€´ì¦ˆ</h3>
        <p id="quizQuestion">ìœ„ ì‹¤í—˜ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ íŒë‹¨í•´ë³´ì„¸ìš”. ì´ ì‚°ì˜ ì§ì—¼ê¸°ëŠ” ê°•ì—¼ê¸°ì¸ê°€ìš”, ì•½ì—¼ê¸°ì¸ê°€ìš”?</p>
        <div class="quiz-options">
            <button onclick="checkAnswer('strong')">ê°•ì—¼ê¸°ë‹¤</button>
            <button onclick="checkAnswer('weak')">ì•½ì—¼ê¸°ë‹¤</button>
            <button onclick="checkAnswer('neutral')">ì¤‘ì„±ì´ë‹¤</button>
        </div>
        <p id="quizResult"></p>
    </div>
</div>

<script>
    // ê³¼í•™ì  í‘œê¸°ë²• ë³€í™˜ ìœ í‹¸ë¦¬í‹°
    function toSci(num) {
        if (num >= 10) return num.toFixed(1); // í° ìˆ˜ëŠ” ê·¸ëƒ¥ í‘œì‹œ
        return num.toExponential(1).replace("e+", " Ã— 10^").replace("e-", " Ã— 10â»");
    }

    // ë°ì´í„°ë² ì´ìŠ¤ (êµê³¼ì„œ ê¸°ë°˜ ê·¼ì‚¬ê°’)
    const acids = {
        "HNO3": {
            name: "ì§ˆì‚° (HNOâ‚ƒ)",
            formula: "HNOâ‚ƒ + Hâ‚‚O â‡„ Hâ‚ƒOâº + NOâ‚ƒâ»",
            ka: 20, // ì‚¬ì‹¤ìƒ ë¬´í•œëŒ€ì´ë‚˜ ì‹œê°í™”ë¥¼ ìœ„í•´ í° ê°’ ì„¤ì •
            conjugate: "NOâ‚ƒâ»",
            strength: "ê°•ì‚°"
        },
        "CH3COOH": {
            name: "ì•„ì„¸íŠ¸ì‚° (CHâ‚ƒCOOH)",
            formula: "CHâ‚ƒCOOH + Hâ‚‚O â‡„ Hâ‚ƒOâº + CHâ‚ƒCOOâ»",
            ka: 1.8e-5,
            conjugate: "CHâ‚ƒCOOâ»",
            strength: "ì•½ì‚°"
        },
        "HCN": {
            name: "ì‚¬ì´ì•ˆí™”ìˆ˜ì†Œ (HCN)",
            formula: "HCN + Hâ‚‚O â‡„ Hâ‚ƒOâº + CNâ»",
            ka: 6.2e-10,
            conjugate: "CNâ»",
            strength: "ë§¤ìš° ì•½í•œ ì‚°"
        },
        "NH4": {
            name: "ì•”ëª¨ëŠ„ ì´ì˜¨ (NHâ‚„âº)",
            formula: "NHâ‚„âº + Hâ‚‚O â‡„ Hâ‚ƒOâº + NHâ‚ƒ",
            ka: 5.6e-10,
            conjugate: "NHâ‚ƒ",
            strength: "ì•½ì‚°"
        }
    };

    const Kw = 1.0e-14;
    let currentAcid = null;

    function runSimulation() {
        const select = document.getElementById('acidSelect');
        const key = select.value;
        currentAcid = acids[key];
        
        if(!currentAcid) return;

        // UI í™œì„±í™”
        document.getElementById('simulationArea').classList.remove('hidden');
        document.getElementById('quizSection').classList.remove('hidden');
        document.getElementById('quizResult').innerHTML = "";

        // 1. ê¸°ë³¸ ì •ë³´ ì—…ë°ì´íŠ¸
        document.getElementById('reactionDisplay').innerHTML = formatFormula(currentAcid.formula);
        document.getElementById('acidName').innerText = currentAcid.name;
        document.getElementById('kaValue').innerText = currentAcid.ka >= 1 ? "ë§¤ìš° í¼ (> 1)" : toSci(currentAcid.ka);
        document.getElementById('acidStrengthText').innerText = currentAcid.strength;

        // 2. Kb ê³„ì‚° ë° ì—…ë°ì´íŠ¸
        const kb = Kw / currentAcid.ka;
        document.getElementById('baseName').innerText = formatFormula(currentAcid.conjugate);
        document.getElementById('kbValue').innerText = toSci(kb);

        // 3. ì§ì—¼ê¸° ì„¸ê¸° í…ìŠ¤íŠ¸ íŒë³„
        let baseStrength = "";
        if (kb < 1e-10) baseStrength = "ë§¤ìš° ì•½í•œ ì—¼ê¸°";
        else if (kb < 1e-4) baseStrength = "ì•½ì—¼ê¸°";
        else baseStrength = "ë¹„êµì  ê°•í•œ ì—¼ê¸°";
        
        document.getElementById('baseStrengthText').innerText = baseStrength;

        // 4. ê·¸ë˜í”„ ì‹œê°í™” (ë¡œê·¸ ìŠ¤ì¼€ì¼ ë§¤í•‘)
        // pKa ë²”ìœ„ ëŒ€ëµ -2 ~ 14 ë¡œ ê°€ì •í•˜ì—¬ ë°” ê¸¸ì´ ì¡°ì ˆ
        let pKa = -Math.log10(currentAcid.ka);
        let pKb = -Math.log10(kb);
        
        // ì‹œê°ì  ì—°ì¶œì„ ìœ„í•œ ì •ê·œí™” (0~100%)
        let acidWidth = Math.max(5, Math.min(100, (14 - pKa) / 14 * 100)); // pKaê°€ ì‘ì„ìˆ˜ë¡(ê°•ì‚°) í¼
        let baseWidth = Math.max(5, Math.min(100, (14 - pKb) / 14 * 100)); // pKbê°€ ì‘ì„ìˆ˜ë¡(ê°•ì—¼ê¸°) í¼

        // ê°•ì‚° ì˜ˆì™¸ì²˜ë¦¬
        if(currentAcid.ka >= 1) { acidWidth = 100; baseWidth = 5; }

        document.getElementById('acidBar').style.width = acidWidth + "%";
        document.getElementById('baseBar').style.width = baseWidth + "%";

        // 5. AI í”¼ë“œë°± ìƒì„±
        let feedback = "";
        if (currentAcid.ka >= 1) {
            feedback = `${currentAcid.name}ì€ <strong>ê°•ì‚°</strong>ì…ë‹ˆë‹¤. $K_a$ê°€ ë§¤ìš° í¬ê¸° ë•Œë¬¸ì—, $K_a \\times K_b = K_w$ ê´€ê³„ì— ì˜í•´ ì§ì—¼ê¸°(${currentAcid.conjugate})ì˜ $K_b$ëŠ” ë§¤ìš° ì‘ì•„ì§‘ë‹ˆë‹¤. ì¦‰, ê±°ì˜ ì—¼ê¸°ë¡œ ì‘ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.`;
        } else if (currentAcid.ka < 1e-7) {
            feedback = `${currentAcid.name}ì€ $K_a$ê°€ ë§¤ìš° ì‘ì€ <strong>ì•½ì‚°</strong>ì…ë‹ˆë‹¤. ë°˜ëŒ€ë¡œ ì§ì—¼ê¸°ëŠ” ìƒëŒ€ì ìœ¼ë¡œ ë¬¼ê³¼ ë°˜ì‘í•˜ë ¤ëŠ” ê²½í–¥($K_b$)ì´ ë” ì»¤ì§‘ë‹ˆë‹¤.`;
        } else {
            feedback = `ì´ ì‚°ì€ ì ë‹¹íˆ ì•½í•œ ì‚°ì…ë‹ˆë‹¤. $K_a$ì™€ $K_b$ì˜ ê³±ì€ í•­ìƒ ì¼ì •($1.0 \\times 10^{-14}$)í•˜ë‹¤ëŠ” ê²ƒì„ í™•ì¸í•˜ì„¸ìš”.`;
        }
        document.getElementById('feedbackText').innerHTML = feedback;
    }

    // í™”í•™ì‹ í…ìŠ¤íŠ¸ ì„œì‹ ì ìš© í•¨ìˆ˜
    function formatFormula(text) {
        return text.replace(/(\d+)/g, '<sub>$1</sub>')
                   .replace(/\+/g, '<sup>+</sup>')
                   .replace(/â»/g, '<sup>-</sup>');
    }

    // í€´ì¦ˆ ì •ë‹µ í™•ì¸
    function checkAnswer(answer) {
        const resultBox = document.getElementById('quizResult');
        const kb = Kw / currentAcid.ka;
        let isCorrect = false;
        let explanation = "";

        // ê°•ì‚°ì˜ ì§ì—¼ê¸° -> ë§¤ìš° ì•½í•¨ (ì‚¬ì‹¤ìƒ ì¤‘ì„± ì·¨ê¸‰ì´ë‚˜ ì•½ì—¼ê¸° ì„ íƒë„ ë§¥ë½ìƒ í—ˆìš©ë  ìˆ˜ ìˆìŒ, ì—¬ê¸°ì„  ë…¼ë¦¬ì  ì—„ë°€í•¨ ì¶”êµ¬)
        // ì•½ì‚°ì˜ ì§ì—¼ê¸° -> ì•½ì—¼ê¸° (ìƒëŒ€ì ìœ¼ë¡œ ê°•í•¨)

        if (currentAcid.ka >= 1) {
            // ê°•ì‚°ì˜ ê²½ìš°
            if (answer === 'weak' || answer === 'neutral') {
                isCorrect = true;
                explanation = "ì •ë‹µì…ë‹ˆë‹¤! ê°•ì‚°ì˜ ì§ì—¼ê¸°ëŠ” ì–‘ì„±ìë¥¼ ë°›ì„ ëŠ¥ë ¥ì´ ê±°ì˜ ì—†ëŠ” 'ë§¤ìš° ì•½í•œ ì—¼ê¸°'ì…ë‹ˆë‹¤.";
            } else {
                explanation = "ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”. $K_a$ê°€ ë§¤ìš° í¬ë©´ $K_b$ëŠ” ë§¤ìš° ì‘ì•„ì§‘ë‹ˆë‹¤.";
            }
        } else {
            // ì•½ì‚°ì˜ ê²½ìš°
            if (answer === 'weak') { // ì¼ë°˜ì ì¸ ì•½ì‚°ì˜ ì§ì—¼ê¸°ëŠ” ì•½ì—¼ê¸°
                isCorrect = true;
                explanation = "ë§ìŠµë‹ˆë‹¤! ì•½ì‚°ì˜ ì§ì—¼ê¸°ëŠ” ë¹„êµì  ê°•í•œ 'ì•½ì—¼ê¸°'ë¡œ ì‘ìš©í•©ë‹ˆë‹¤. (ê°•ì—¼ê¸°ê¹Œì§„ ì•„ë‹˜)";
            } else if (answer === 'strong' && kb > 1e-5) {
                // íŠ¹ì • ì¡°ê±´ì—ì„œ ìƒëŒ€ì  ë¹„êµ ì¸ì •
                 isCorrect = false;
                 explanation = "ì•½ì‚°ì˜ ì§ì—¼ê¸°ê°€ ìƒëŒ€ì ìœ¼ë¡œ ì„¸ì§€ê¸´ í•˜ì§€ë§Œ, OH- ì²˜ëŸ¼ ì™„ì „íˆ í•´ë¦¬ë˜ëŠ” 'ê°•ì—¼ê¸°'ëŠ” ì•„ë‹™ë‹ˆë‹¤. ì—¬ì „íˆ 'ì•½ì—¼ê¸°' ë²”ì£¼ì— ë“­ë‹ˆë‹¤.";
            } else {
                explanation = "ì•„ë‹™ë‹ˆë‹¤. $K_a$ì™€ $K_b$ëŠ” ë°˜ë¹„ë¡€ ê´€ê³„ì…ë‹ˆë‹¤. ì‚°ì´ ì•½í• ìˆ˜ë¡ ì§ì—¼ê¸°ëŠ” ìƒëŒ€ì ìœ¼ë¡œ ê°•í•´ì§‘ë‹ˆë‹¤.";
            }
        }

        resultBox.innerHTML = isCorrect 
            ? `<span style="color:green; font-weight:bold;">â­• ${explanation}</span>` 
            : `<span style="color:red; font-weight:bold;">âŒ ${explanation}</span>`;
    }
</script>

</body>
</html>