<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë™ìœ„ì›ì†Œ ê°€ìƒ ì‹¤í—˜ì‹¤ - Isotope Lab</title>
    <style>
        :root {
            --primary: #4A90E2;
            --secondary: #50E3C2;
            --accent: #FF6B6B;
            --bg: #F5F7FA;
            --panel: #FFFFFF;
            --text: #333333;
        }
        body {
            font-family: 'Pretendard', 'Malgun Gothic', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1, h2 { text-align: center; color: #2c3e50; }
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            max-width: 1200px;
            width: 100%;
            justify-content: center;
        }
        /* Panels */
        .panel {
            background: var(--panel);
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 20px;
            flex: 1;
            min-width: 300px;
        }
        .canvas-container {
            flex: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 400px;
        }
        canvas {
            background: radial-gradient(circle at center, #ffffff 0%, #e6f7ff 100%);
            border-radius: 50%;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.05);
            border: 2px solid #ddd;
        }
        
        /* Controls */
        .control-group {
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
        }
        .control-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
        }
        .btn-group {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        button {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.1s;
        }
        button:active { transform: scale(0.95); }
        .btn-add { background: var(--primary); color: white; }
        .btn-remove { background: #e74c3c; color: white; }
        .btn-reset { background: #95a5a6; color: white; width: 100%; margin-top: 10px; }
        .btn-target { background: var(--secondary); color: #005f4d; border: 1px solid #005f4d; }
        
        /* Stats */
        .stat-box {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .stat-value { font-weight: bold; font-size: 1.2em; color: var(--primary); }
        
        /* Legend */
        .legend { display: flex; gap: 15px; font-size: 0.9em; margin-top: 10px; }
        .dot { width: 12px; height: 12px; border-radius: 50%; display: inline-block; margin-right: 5px; }
        
        /* Feedback */
        #feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            font-size: 0.95em;
            line-height: 1.5;
        }

        /* Average Mass Section */
        .avg-mass-section {
            width: 100%;
            max-width: 1200px;
            margin-top: 30px;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .slider-container { margin: 20px 0; }
        input[type=range] { width: 100%; }
        .bar-chart {
            display: flex;
            height: 40px;
            border-radius: 20px;
            overflow: hidden;
            margin: 20px 0;
            font-weight: bold;
            color: white;
            text-align: center;
            line-height: 40px;
        }
        
    </style>
</head>
<body>

    <h1>âš›ï¸ ë™ìœ„ì›ì†Œ ì œì‘ì†Œ & í‰ê·  ì›ìëŸ‰ ì‹¤í—˜</h1>
    <p>ì¤‘ì„±ì ìˆ˜ë¥¼ ì¡°ì ˆí•˜ì—¬ ë™ìœ„ì›ì†Œë¥¼ ë§Œë“¤ê³ , í‰ê·  ì›ìëŸ‰ì˜ ë¹„ë°€ì„ ë°í˜€ë³´ì„¸ìš”.</p>

    <div class="container">
        <div class="panel">
            <h2>ğŸ› ï¸ ì‹¤í—˜ ì¡°ì‘</h2>
            
            <div class="control-group">
                <label>ëª©í‘œ ì›ì†Œ ì„ íƒ</label>
                <div class="btn-group">
                    <button class="btn-target" onclick="setTarget('H')">ìˆ˜ì†Œ (H)</button>
                    <button class="btn-target" onclick="setTarget('C')">íƒ„ì†Œ (C)</button>
                </div>
            </div>

            <div class="control-group">
                <label>ì…ì ì¡°ì ˆ</label>
                <div class="stat-box">
                    <span>ğŸ”´ ì–‘ì„±ì (Proton)</span>
                    <div>
                        <button class="btn-remove" onclick="updateParticle('p', -1)">-</button>
                        <span id="p-count" class="stat-value">1</span>
                        <button class="btn-add" onclick="updateParticle('p', 1)">+</button>
                    </div>
                </div>
                <div class="stat-box">
                    <span>ğŸŸ¡ ì¤‘ì„±ì (Neutron)</span>
                    <div>
                        <button class="btn-remove" onclick="updateParticle('n', -1)">-</button>
                        <span id="n-count" class="stat-value">0</span>
                        <button class="btn-add" onclick="updateParticle('n', 1)">+</button>
                    </div>
                </div>
                <div class="stat-box">
                    <span>âšª ì „ì (Electron)</span>
                    <div>
                        <button class="btn-remove" onclick="updateParticle('e', -1)">-</button>
                        <span id="e-count" class="stat-value">1</span>
                        <button class="btn-add" onclick="updateParticle('e', 1)">+</button>
                    </div>
                </div>
            </div>

            <button class="btn-reset" onclick="resetExperiment()">ì‹¤í—˜ ì´ˆê¸°í™”</button>
        </div>

        <div class="panel canvas-container">
            <canvas id="atomCanvas" width="400" height="400"></canvas>
            <div class="legend">
                <span><span class="dot" style="background:red;"></span>ì–‘ì„±ì</span>
                <span><span class="dot" style="background:gold;"></span>ì¤‘ì„±ì</span>
                <span><span class="dot" style="background:#ddd; border:1px solid #999;"></span>ì „ì</span>
            </div>
        </div>

        <div class="panel">
            <h2>ğŸ“Š ê´€ì°° ê²°ê³¼</h2>
            <div class="stat-box">
                <span>ì§ˆëŸ‰ìˆ˜ (Mass Number)</span>
                <span id="mass-num" class="stat-value">1</span>
            </div>
            <div class="stat-box">
                <span>ì›ì í‘œê¸°</span>
                <span id="symbol-display" class="stat-value" style="font-family: serif; font-size: 1.5em;"><sup>1</sup>H</span>
            </div>
            
            <div id="feedback">
                <strong>ğŸ’¡ í•™ìŠµ ë„ìš°ë¯¸</strong><br>
                ìˆ˜ì†Œ ì›ìí•µì—ëŠ” ì–‘ì„±ìê°€ 1ê°œ ìˆìŠµë‹ˆë‹¤. ì¤‘ì„±ìë¥¼ ì¶”ê°€í•´ë³´ë©° ì–´ë–¤ ë³€í™”ê°€ ìƒê¸°ëŠ”ì§€ ê´€ì°°í•´ë³´ì„¸ìš”.
            </div>

            <div style="margin-top: 20px; border-top: 1px solid #eee; padding-top:10px;">
                <h3>ğŸ“ í€µ í€´ì¦ˆ</h3>
                <p id="quiz-question">í˜„ì¬ ìƒíƒœëŠ” ì–´ë–¤ ë™ìœ„ì›ì†Œì¸ê°€ìš”?</p>
                <button onclick="checkAnswer()" style="background:#6c5ce7; color:white; width:100%;">ì •ë‹µ í™•ì¸í•˜ê¸°</button>
            </div>
        </div>
    </div>

    <div class="panel avg-mass-section">
        <h2>âš–ï¸ í‰ê·  ì›ìëŸ‰ ì‹œë®¬ë ˆì´í„° (ì—¼ì†Œ: Cl)</h2>
        <p>ìì—°ê³„ì— ì¡´ì¬í•˜ëŠ” ì—¼ì†Œì˜ ë™ìœ„ì›ì†Œ ë¹„ìœ¨ì„ ì¡°ì ˆí•˜ì—¬ í‰ê·  ì›ìëŸ‰ì„ ê³„ì‚°í•´ë´…ì‹œë‹¤.</p>
        
        <div class="slider-container">
            <label>Cl-35 ì¡´ì¬ë¹„: <span id="ratio-35">75</span>%</label>
            <input type="range" id="abundanceSlider" min="0" max="100" value="75" oninput="updateAvgMass()">
            <label style="margin-top:5px; color:#666;">(Cl-37 ì¡´ì¬ë¹„ëŠ” ìë™ìœ¼ë¡œ <span id="ratio-37">25</span>%ê°€ ë©ë‹ˆë‹¤)</label>
        </div>

        <div class="bar-chart">
            <div id="bar-35" style="width: 75%; background: #4A90E2;">Cl-35</div>
            <div id="bar-37" style="width: 25%; background: #FF6B6B;">Cl-37</div>
        </div>

        <div class="stat-box" style="justify-content: center; background: #e8f4fd;">
            <span style="font-size: 1.2em; margin-right: 10px;">ê³„ì‚°ëœ í‰ê·  ì›ìëŸ‰: </span>
            <span id="avg-mass-result" class="stat-value" style="font-size: 2em; color: #2c3e50;">35.50</span> amu
        </div>
        <p style="text-align: center; color: #555; font-size: 0.9em;">
            ê³µì‹: (35 Ã— ì¡´ì¬ë¹„%) + (37 Ã— ì¡´ì¬ë¹„%) / 100
        </p>
    </div>

    <script>
        // --- State Management ---
        let particles = { p: 1, n: 0, e: 1 };
        let targetElement = 'H'; // 'H' or 'C'

        // --- Canvas Setup ---
        const canvas = document.getElementById('atomCanvas');
        const ctx = canvas.getContext('2d');
        const center = { x: canvas.width / 2, y: canvas.height / 2 };

        // --- Interaction Logic ---
        function setTarget(el) {
            targetElement = el;
            if (el === 'H') {
                particles = { p: 1, n: 0, e: 1 };
                document.getElementById('feedback').innerHTML = "<strong>ìˆ˜ì†Œ(H)</strong> ì„ íƒë¨. ê°€ì¥ ê°€ë²¼ìš´ ì›ì†Œì…ë‹ˆë‹¤. ì¤‘ì„±ìê°€ ì—†ëŠ” ìˆ˜ì†Œë„ ìˆì„ê¹Œìš”?";
            } else {
                particles = { p: 6, n: 6, e: 6 };
                document.getElementById('feedback').innerHTML = "<strong>íƒ„ì†Œ(C)</strong> ì„ íƒë¨. ìƒëª…ì²´ì˜ ê¸°ë³¸ ìš”ì†Œì…ë‹ˆë‹¤. íƒ„ì†Œ-12, 13, 14ì˜ ì°¨ì´ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”.";
            }
            updateUI();
        }

        function updateParticle(type, change) {
            const newVal = particles[type] + change;
            if (newVal < 0) return;
            if (type === 'e' && newVal > 10) return; // Limit electrons for visual simplicity
            if (type === 'p' && newVal > 10) return;
            
            particles[type] = newVal;
            updateUI();
            generateFeedback();
        }

        function resetExperiment() {
            setTarget(targetElement);
        }

        // --- Drawing Logic ---
        function drawAtom() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // 1. Draw Nucleus (Protons & Neutrons)
            const nucleusParticles = [];
            for (let i = 0; i < particles.p; i++) nucleusParticles.push({ color: 'red', type: 'p' });
            for (let i = 0; i < particles.n; i++) nucleusParticles.push({ color: 'gold', type: 'n' });

            // Shuffle for random cluster look
            nucleusParticles.sort(() => Math.random() - 0.5);

            // Simple spiral packing for nucleus
            nucleusParticles.forEach((p, index) => {
                const angle = index * 137.5; // Golden angle
                const r = 6 * Math.sqrt(index); // Spread factor
                const x = center.x + r * Math.cos(angle);
                const y = center.y + r * Math.sin(angle);
                
                ctx.beginPath();
                ctx.arc(x, y, 8, 0, Math.PI * 2);
                ctx.fillStyle = p.color;
                ctx.fill();
                ctx.strokeStyle = '#333';
                ctx.stroke();
                
                // Add text for colorblind accessibility
                ctx.fillStyle = 'black';
                ctx.font = '8px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(p.type === 'p' ? '+' : 'n', x, y);
            });

            // 2. Draw Electrons (Simple Shells)
            const shellRadii = [60, 100, 140];
            let eRemaining = particles.e;
            let shellIdx = 0;

            const electronsPerShell = [2, 8, 8];

            while (eRemaining > 0 && shellIdx < shellRadii.length) {
                const countInShell = Math.min(eRemaining, electronsPerShell[shellIdx]);
                const radius = shellRadii[shellIdx];

                // Draw Shell Path
                ctx.beginPath();
                ctx.arc(center.x, center.y, radius, 0, Math.PI * 2);
                ctx.strokeStyle = '#ddd';
                ctx.stroke();

                // Draw Electrons
                const time = Date.now() / 1000; // For animation
                for (let i = 0; i < countInShell; i++) {
                    const angle = (Math.PI * 2 * i / countInShell) + (time * (shellIdx % 2 === 0 ? 1 : -1));
                    const ex = center.x + radius * Math.cos(angle);
                    const ey = center.y + radius * Math.sin(angle);

                    ctx.beginPath();
                    ctx.arc(ex, ey, 5, 0, Math.PI * 2);
                    ctx.fillStyle = '#fff';
                    ctx.fill();
                    ctx.strokeStyle = '#999';
                    ctx.stroke();
                }

                eRemaining -= countInShell;
                shellIdx++;
            }

            requestAnimationFrame(drawAtom);
        }

        // --- Logic & Feedback ---
        function updateUI() {
            document.getElementById('p-count').innerText = particles.p;
            document.getElementById('n-count').innerText = particles.n;
            document.getElementById('e-count').innerText = particles.e;

            const massNum = particles.p + particles.n;
            document.getElementById('mass-num').innerText = massNum;

            // Update Symbol: e.g., 12C
            let symbol = '?';
            if (particles.p === 1) symbol = 'H';
            else if (particles.p === 6) symbol = 'C';
            else if (particles.p === 2) symbol = 'He'; // Just in case user plays around
            else symbol = 'X';

            document.getElementById('symbol-display').innerHTML = `<sup>${massNum}</sup>${symbol}`;
        }

        function generateFeedback() {
            const massNum = particles.p + particles.n;
            const feedbackEl = document.getElementById('feedback');
            
            if (targetElement === 'H') {
                if (particles.p !== 1) {
                    feedbackEl.innerHTML = "<span style='color:red'>âš ï¸ ì£¼ì˜:</span> ìˆ˜ì†Œ ì›ìëŠ” ì–‘ì„±ìê°€ í•­ìƒ 1ê°œì—¬ì•¼ í•©ë‹ˆë‹¤!";
                    return;
                }
                if (particles.n === 0) feedbackEl.innerHTML = "<strong>ìˆ˜ì†Œ-1 (ê²½ìˆ˜ì†Œ):</strong> ê°€ì¥ í”í•œ ìˆ˜ì†Œì…ë‹ˆë‹¤. ì–‘ì„±ì 1ê°œë§Œìœ¼ë¡œ í•µì´ êµ¬ì„±ë©ë‹ˆë‹¤.";
                else if (particles.n === 1) feedbackEl.innerHTML = "<strong>ìˆ˜ì†Œ-2 (ì¤‘ìˆ˜ì†Œ):</strong> ì¤‘ì„±ìê°€ í•˜ë‚˜ ë”í•´ì ¸ ë¬´ê±°ì›Œì¡ŒìŠµë‹ˆë‹¤. ìì—°ê³„ì— ê·¹ì†ŒëŸ‰ ì¡´ì¬í•©ë‹ˆë‹¤.";
                else if (particles.n === 2) feedbackEl.innerHTML = "<strong>ìˆ˜ì†Œ-3 (ì‚¼ì¤‘ìˆ˜ì†Œ):</strong> ë§¤ìš° ë¶ˆì•ˆì •í•œ ë°©ì‚¬ì„± ë™ìœ„ì›ì†Œì…ë‹ˆë‹¤.";
                else feedbackEl.innerHTML = "ì´ë¡ ì ìœ¼ë¡œ ê°€ëŠ¥í•  ìˆ˜ ìˆìœ¼ë‚˜ ë§¤ìš° ë¶ˆì•ˆì •í•œ ìƒíƒœì…ë‹ˆë‹¤.";
            } else if (targetElement === 'C') {
                 if (particles.p !== 6) {
                    feedbackEl.innerHTML = "<span style='color:red'>âš ï¸ ì£¼ì˜:</span> íƒ„ì†Œ ì›ìëŠ” ì–‘ì„±ìê°€ í•­ìƒ 6ê°œì—¬ì•¼ í•©ë‹ˆë‹¤!";
                    return;
                }
                if (particles.n === 6) feedbackEl.innerHTML = "<strong>íƒ„ì†Œ-12:</strong> ìì—°ê³„ íƒ„ì†Œì˜ ì•½ 99%ë¥¼ ì°¨ì§€í•˜ëŠ” ê°€ì¥ ì•ˆì •í•œ ë™ìœ„ì›ì†Œì…ë‹ˆë‹¤.";
                else if (particles.n === 7) feedbackEl.innerHTML = "<strong>íƒ„ì†Œ-13:</strong> ì•½ 1% ì •ë„ ì¡´ì¬í•˜ëŠ” ë™ìœ„ì›ì†Œì…ë‹ˆë‹¤. í™”í•™ì  ì„±ì§ˆì€ íƒ„ì†Œ-12ì™€ ê°™ìŠµë‹ˆë‹¤.";
                else if (particles.n === 8) feedbackEl.innerHTML = "<strong>íƒ„ì†Œ-14:</strong> ë°©ì‚¬ì„± ë™ìœ„ì›ì†Œë¡œ, ì—°ëŒ€ ì¸¡ì •ì— ì‚¬ìš©ë©ë‹ˆë‹¤.";
                else feedbackEl.innerHTML = `ì§ˆëŸ‰ìˆ˜ ${massNum}ì¸ íƒ„ì†Œ ë™ìœ„ì›ì†Œë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.`;
            }
        }

        function checkAnswer() {
            const massNum = particles.p + particles.n;
            let answer = "";
            if(particles.p === 1) answer = `ìˆ˜ì†Œ-${massNum}`;
            else if(particles.p === 6) answer = `íƒ„ì†Œ-${massNum}`;
            else answer = "ì•Œ ìˆ˜ ì—†ëŠ” ì›ì†Œ";
            
            alert(`ì •ë‹µ: ì´ê²ƒì€ ${answer} ì…ë‹ˆë‹¤.\n(ì–‘ì„±ì ìˆ˜: ${particles.p}, ì¤‘ì„±ì ìˆ˜: ${particles.n})`);
        }

        // --- Average Mass Calculator ---
        function updateAvgMass() {
            const p35 = parseInt(document.getElementById('abundanceSlider').value);
            const p37 = 100 - p35;
            
            document.getElementById('ratio-35').innerText = p35;
            document.getElementById('ratio-37').innerText = p37;
            
            document.getElementById('bar-35').style.width = p35 + '%';
            document.getElementById('bar-37').style.width = p37 + '%';
            
            if(p35 === 0) { document.getElementById('bar-35').style.display = 'none'; } else { document.getElementById('bar-35').style.display = 'block'; }
            if(p37 === 0) { document.getElementById('bar-37').style.display = 'none'; } else { document.getElementById('bar-37').style.display = 'block'; }

            // Calculation Logic
            const avg = (35 * p35 + 37 * p37) / 100;
            document.getElementById('avg-mass-result').innerText = avg.toFixed(2);
        }

        // Initialize
        drawAtom();
        updateUI();
        
    </script>
</body>
</html>