<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ê°€ìƒ ì‹¤í—˜: ìˆœë¬¼ì§ˆê³¼ í˜¼í•©ë¬¼ì˜ ì˜¨ë„ ë³€í™”</title>
    <style>
        :root { --primary: #4A90E2; --secondary: #E74C3C; --bg: #f4f7f6; --panel: #ffffff; }
        body { font-family: 'Pretendard', sans-serif; background: var(--bg); margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        h1 { color: #333; margin-bottom: 10px; }
        .container { display: grid; grid-template-columns: 250px 1fr 300px; gap: 20px; max-width: 1200px; width: 100%; }
        
        /* Controls */
        .panel { background: var(--panel); padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .control-group { margin-bottom: 20px; }
        label { display: block; font-weight: bold; margin-bottom: 8px; font-size: 14px; color: #555; }
        select, input[type="range"], button { width: 100%; padding: 8px; margin-bottom: 5px; border-radius: 6px; border: 1px solid #ddd; }
        button { background: var(--primary); color: white; border: none; cursor: pointer; font-weight: bold; transition: 0.2s; }
        button:hover { opacity: 0.9; }
        button.reset { background: #95a5a6; margin-top: 10px; }
        
        /* Visualization */
        .visual-area { display: flex; flex-direction: column; align-items: center; justify-content: center; background: #fff; border-radius: 12px; padding: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); position: relative; }
        .beaker { width: 150px; height: 200px; border: 4px solid #333; border-top: none; position: relative; background: linear-gradient(to bottom, rgba(255,255,255,0.5), rgba(74, 144, 226, 0.2)); border-radius: 0 0 15px 15px; overflow: hidden; }
        .liquid { position: absolute; bottom: 0; left: 0; right: 0; height: 70%; background: rgba(74, 144, 226, 0.4); transition: height 1s; }
        .particles { position: absolute; width: 100%; height: 100%; }
        .particle { position: absolute; border-radius: 50%; transition: top 0.5s, left 0.5s; }
        .water-p { width: 10px; height: 10px; background: #3498db; }
        .salt-p { width: 12px; height: 12px; background: #e74c3c; border: 1px solid #c0392b; }
        
        .thermometer { width: 20px; height: 220px; background: #eee; border: 2px solid #333; border-radius: 10px; position: absolute; right: 40px; top: 10px; }
        .mercury { width: 100%; background: #e74c3c; position: absolute; bottom: 0; border-radius: 0 0 8px 8px; transition: height 0.2s; }
        .temp-display { position: absolute; top: -30px; right: 20px; font-size: 24px; font-weight: bold; color: #333; }
        
        /* Graph */
        .graph-area { background: #fff; border-radius: 12px; padding: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); display: flex; flex-direction: column; }
        canvas { width: 100%; height: 300px; background: #fdfdfd; border: 1px solid #eee; }
        .status-box { margin-top: 10px; padding: 10px; background: #ecf0f1; border-radius: 8px; font-size: 14px; line-height: 1.4; }

        /* Animation Classes */
        @keyframes boil { 0% { transform: translateY(0); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0); } }
        .boiling .particle { animation: boil 0.5s infinite ease-in-out; }
        .freezing .particle { transition: all 1s; transform: scale(0.9); }
    </style>
</head>
<body>

    <h1>âš—ï¸ ê°€ìƒ ì‹¤í—˜ì‹¤: ë¬¼ì§ˆì˜ íŠ¹ì„±</h1>

    <div class="container">
        <div class="panel">
            <h3>ğŸ›ï¸ ì‹¤í—˜ ì„¤ì •</h3>
            <div class="control-group">
                <label>ì‹¤í—˜ ëª¨ë“œ</label>
                <select id="experimentMode">
                    <option value="boil">ê°€ì—´ (ë“ëŠ”ì )</option>
                    <option value="freeze">ëƒ‰ê° (ì–´ëŠ”ì )</option>
                </select>
            </div>
            <div class="control-group">
                <label>ë¬¼ì§ˆ ì„ íƒ</label>
                <select id="substanceType" onchange="updateUI()">
                    <option value="water">ìˆœìˆ˜í•œ ë¬¼</option>
                    <option value="saltwater">ì†Œê¸ˆë¬¼ (í˜¼í•©ë¬¼)</option>
                </select>
            </div>
            <div class="control-group" id="concentrationGroup" style="display:none;">
                <label>ì†Œê¸ˆë¬¼ ë†ë„: <span id="concVal">10</span>%</label>
                <input type="range" id="concentration" min="5" max="20" step="5" value="10" oninput="document.getElementById('concVal').innerText = this.value">
            </div>
            <div class="control-group">
                <label>ì§„í–‰ ì†ë„</label>
                <input type="range" id="speed" min="1" max="5" value="2">
            </div>
            <button onclick="startSimulation()">â–¶ ì‹¤í—˜ ì‹œì‘</button>
            <button class="reset" onclick="resetSimulation()">â†º ì´ˆê¸°í™”</button>
        </div>

        <div class="visual-area">
            <div class="temp-display" id="tempDisplay">25.0Â°C</div>
            <div class="beaker" id="beaker">
                <div class="liquid">
                    <div class="particles" id="particleContainer"></div>
                </div>
            </div>
            <div class="thermometer"><div class="mercury" id="mercury" style="height: 25%;"></div></div>
        </div>

        <div class="graph-area">
            <h3>ğŸ“ˆ ì˜¨ë„ ë³€í™” ê·¸ë˜í”„</h3>
            <canvas id="graphCanvas"></canvas>
            <div class="status-box" id="statusMessage">
                ì‹¤í—˜ ì„¤ì •ì„ ë§ˆì¹˜ê³  'ì‹¤í—˜ ì‹œì‘' ë²„íŠ¼ì„ ëˆŒëŸ¬ë³´ì„¸ìš”.
            </div>
        </div>
    </div>

<script>
    let timer = null;
    let time = 0;
    let temperature = 25;
    let isRunning = false;
    let dataPoints = [];
    const canvas = document.getElementById('graphCanvas');
    const ctx = canvas.getContext('2d');
    
    // Canvas Setup
    canvas.width = 300;
    canvas.height = 300;

    function updateUI() {
        const type = document.getElementById('substanceType').value;
        const concGroup = document.getElementById('concentrationGroup');
        concGroup.style.display = type === 'saltwater' ? 'block' : 'none';
        drawParticlesInternal();
    }

    function drawParticlesInternal() {
        const container = document.getElementById('particleContainer');
        container.innerHTML = '';
        const type = document.getElementById('substanceType').value;
        const conc = parseInt(document.getElementById('concentration').value);
        
        // Add Water Particles
        for(let i=0; i<20; i++) {
            let p = document.createElement('div');
            p.className = 'particle water-p';
            p.style.top = Math.random() * 80 + 10 + '%';
            p.style.left = Math.random() * 80 + 10 + '%';
            container.appendChild(p);
        }

        // Add Salt Particles
        if(type === 'saltwater') {
            let count = conc / 2; // Simple visual representation
            for(let i=0; i<count; i++) {
                let p = document.createElement('div');
                p.className = 'particle salt-p';
                p.style.top = Math.random() * 80 + 10 + '%';
                p.style.left = Math.random() * 80 + 10 + '%';
                container.appendChild(p);
            }
        }
    }

    function startSimulation() {
        if(isRunning) return;
        resetSimulation(false);
        isRunning = true;
        
        const mode = document.getElementById('experimentMode').value;
        const type = document.getElementById('substanceType').value;
        const conc = parseInt(document.getElementById('concentration').value);
        const speedMultiplier = parseInt(document.getElementById('speed').value);

        // Set Initial Temp
        temperature = mode === 'boil' ? 25 : 20;

        timer = setInterval(() => {
            time++;
            let step = 0.5 * speedMultiplier;

            // Physics Logic (Simplified for Education)
            if (mode === 'boil') {
                let boilingPoint = type === 'water' ? 100 : 100 + (conc * 0.5);
                
                if (temperature < boilingPoint) {
                    temperature += step;
                } else {
                    // Phase Change Logic
                    if(type === 'water') {
                        temperature = 100 + (Math.random() * 0.2); // Almost constant
                        document.getElementById('statusMessage').innerHTML = "<strong>ê´€ì°° í¬ì¸íŠ¸:</strong><br>ë¬¼ì´ ë“ê³  ìˆìŠµë‹ˆë‹¤. ì˜¨ë„ê°€ 100Â°Cì—ì„œ ì¼ì •í•˜ê²Œ ìœ ì§€ë˜ëŠ” í‰íƒ„í•œ êµ¬ê°„ì´ ë³´ì´ë‚˜ìš”?";
                    } else {
                        temperature += (step * 0.1); // Continues to rise slowly
                        document.getElementById('statusMessage').innerHTML = `<strong>ê´€ì°° í¬ì¸íŠ¸:</strong><br>ì†Œê¸ˆë¬¼ì´ ë“ê³  ìˆìŠµë‹ˆë‹¤. <br>ìˆœë¬¼ì§ˆê³¼ ë‹¬ë¦¬ ì˜¨ë„ê°€ ${boilingPoint.toFixed(1)}Â°Cë¥¼ ë„˜ì–´ ì¡°ê¸ˆì”© ê³„ì† ì˜¬ë¼ê°€ê³  ìˆìŠµë‹ˆë‹¤.`;
                    }
                    document.getElementById('beaker').classList.add('boiling');
                }
            } else { // Freezing
                let freezingPoint = type === 'water' ? 0 : 0 - (conc * 0.5);
                
                if (temperature > freezingPoint) {
                    temperature -= step;
                } else {
                     if(type === 'water') {
                        temperature = 0 - (Math.random() * 0.2);
                         document.getElementById('statusMessage').innerHTML = "<strong>ê´€ì°° í¬ì¸íŠ¸:</strong><br>ë¬¼ì´ ì–¼ê³  ìˆìŠµë‹ˆë‹¤. 0Â°Cì—ì„œ ì˜¨ë„ê°€ ë³€í•˜ì§€ ì•ŠëŠ” êµ¬ê°„ì„ í™•ì¸í•˜ì„¸ìš”.";
                    } else {
                        temperature -= (step * 0.1); // Continues to drop
                        document.getElementById('statusMessage').innerHTML = `<strong>ê´€ì°° í¬ì¸íŠ¸:</strong><br>ì†Œê¸ˆë¬¼ì´ ì–¼ê³  ìˆìŠµë‹ˆë‹¤. <br>ì–´ëŠ”ì (${freezingPoint.toFixed(1)}Â°C) ì´í•˜ë¡œ ì˜¨ë„ê°€ ê³„ì† ë‚´ë ¤ê°‘ë‹ˆë‹¤.`;
                    }
                    document.getElementById('beaker').classList.add('freezing');
                }
            }

            dataPoints.push(temperature);
            updateVisuals();
            drawGraph(mode);

            if (time > 150) {
                clearInterval(timer);
                isRunning = false;
                document.getElementById('statusMessage').innerHTML += "<br>âœ… ì‹¤í—˜ì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.";
            }

        }, 100);
    }

    function updateVisuals() {
        document.getElementById('tempDisplay').innerText = temperature.toFixed(1) + "Â°C";
        // Map temp -10 to 110 to height 0 to 100
        let h = ((temperature + 10) / 120) * 100;
        if(h < 0) h = 0; if(h > 100) h = 100;
        document.getElementById('mercury').style.height = h + "%";
    }

    function drawGraph(mode) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Draw Axis
        ctx.beginPath();
        ctx.strokeStyle = '#888';
        ctx.moveTo(30, 10); ctx.lineTo(30, 270); // Y
        ctx.moveTo(30, 150); ctx.lineTo(290, 150); // X (Center for Freezing)
        if(mode === 'boil') {
             ctx.moveTo(30, 270); ctx.lineTo(290, 270); // X (Bottom for Boiling)
        }
        ctx.stroke();

        // Plot Data
        ctx.beginPath();
        ctx.strokeStyle = '#e74c3c';
        ctx.lineWidth = 2;
        
        let startY = mode === 'boil' ? 270 : 150; // Visual offset
        
        dataPoints.forEach((temp, index) => {
            let x = 30 + (index * 2);
            let y = 0;
            if(mode === 'boil') {
                y = 270 - (temp * 2); // Scale fit
            } else {
                y = 150 - (temp * 5);
            }
            
            if(index === 0) ctx.moveTo(x, y);
            else ctx.lineTo(x, y);
        });
        ctx.stroke();
    }

    function resetSimulation(clearGraph = true) {
        clearInterval(timer);
        isRunning = false;
        time = 0;
        if(clearGraph) dataPoints = [];
        document.getElementById('beaker').classList.remove('boiling', 'freezing');
        document.getElementById('statusMessage').innerText = "ì¤€ë¹„ ì™„ë£Œ. ì„¤ì • í›„ ì‹œì‘ ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.";
        drawParticlesInternal();
        // Clear Canvas
        if(clearGraph) ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

    // Init
    updateUI();
</script>
</body>
</html>