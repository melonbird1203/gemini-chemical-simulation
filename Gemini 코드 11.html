<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°€ìƒ ì‹¤í—˜: ì˜¤ì¤Œì‹¸ê°œ ì¸í˜•ê³¼ ê¸°ì²´ì˜ ë¶€í”¼</title>
    <style>
        :root {
            --primary-color: #4a90e2;
            --hot-color: #ff6b6b;
            --cold-color: #48dbfb;
            --text-color: #333;
            --bg-color: #f4f7f6;
        }

        body {
            font-family: 'Nanum Gothic', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
        }

        h1 {
            margin: 0;
            color: var(--primary-color);
        }

        .subtitle {
            font-size: 0.9rem;
            color: #666;
        }

        /* ë©”ì¸ ë ˆì´ì•„ì›ƒ */
        .container {
            display: flex;
            gap: 20px;
            max-width: 1000px;
            width: 100%;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* ì™¼ìª½: ì‹¤í—˜ í™”ë©´ */
        .experiment-panel {
            flex: 2;
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 300px;
        }

        canvas#mainCanvas {
            border: 1px solid #ddd;
            background: #fff;
            border-radius: 10px;
            cursor: pointer;
        }

        /* ì˜¤ë¥¸ìª½: ì…ì ëª¨í˜• ë° ì œì–´ */
        .sidebar {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
            min-width: 250px;
        }

        .particle-view {
            background: white;
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
        }

        canvas#particleCanvas {
            background: #222;
            border-radius: 8px;
            margin-top: 10px;
        }

        .controls {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        button {
            width: 100%;
            padding: 12px;
            margin: 5px 0;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            background-color: #e0e0e0;
            color: #555;
        }

        button.active {
            background-color: var(--primary-color);
            color: white;
            box-shadow: 0 4px 10px rgba(74, 144, 226, 0.3);
        }

        button:hover:not(:disabled) {
            transform: translateY(-2px);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .status-box {
            margin-top: 15px;
            padding: 15px;
            background: #eef2f5;
            border-left: 5px solid var(--primary-color);
            border-radius: 4px;
        }

        .status-box h3 { margin-top: 0; font-size: 1rem; }
        .status-box p { font-size: 0.9rem; line-height: 1.4; margin-bottom: 0; }

        .temp-indicator {
            font-size: 1.2rem;
            font-weight: bold;
            text-align: center;
            margin: 10px 0;
        }

        .hot { color: var(--hot-color); }
        .cold { color: var(--cold-color); }

    </style>
</head>
<body>

<header>
    <h1>ğŸ§ª ì˜¤ì¤Œì‹¸ê°œ ì¸í˜• ì‹¤í—˜ì‹¤</h1>
    <div class="subtitle">ì¤‘1 ê³¼í•™ > ê¸°ì²´ì˜ ì„±ì§ˆ > ìƒ¤ë¥¼ì˜ ë²•ì¹™</div>
</header>

<div class="container">
    <div class="experiment-panel">
        <canvas id="mainCanvas" width="500" height="400"></canvas>
        <div class="status-box" id="explanationBox">
            <h3>ì‹¤í—˜ ì¤€ë¹„ ì™„ë£Œ</h3>
            <p>ì˜¤ë¥¸ìª½ì˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì‹¤í—˜ì„ ë‹¨ê³„ë³„ë¡œ ì§„í–‰í•´ë³´ì„¸ìš”.</p>
        </div>
    </div>

    <div class="sidebar">
        <div class="particle-view">
            <h3>ğŸ” ì¸í˜• ë‚´ë¶€ ê¸°ì²´ ì…ì</h3>
            <div class="temp-indicator" id="tempDisplay">25Â°C</div>
            <canvas id="particleCanvas" width="200" height="150"></canvas>
            <p style="font-size: 0.8rem; color: #666;">*ì˜¨ë„ê°€ ë†’ì„ìˆ˜ë¡ ì…ìê°€ ë¹¨ë¼ì ¸ìš”!</p>
        </div>

        <div class="controls">
            <h3>ì‹¤í—˜ ë‹¨ê³„</h3>
            <button id="btnStep1" onclick="startStep(1)">1. ëœ¨ê±°ìš´ ë¬¼ì— ë„£ê¸° (ê°€ì—´)</button>
            <button id="btnStep2" onclick="startStep(2)" disabled>2. ì°¬ë¬¼ì— ë„£ê¸° (ëƒ‰ê°)</button>
            <button id="btnStep3" onclick="startStep(3)" disabled>3. ëœ¨ê±°ìš´ ë¬¼ ë¶“ê¸° (ë°œì‚¬!)</button>
            <button onclick="resetExperiment()" style="background-color: #666; color: white; margin-top: 15px;">ğŸ”„ ì‹¤í—˜ ì´ˆê¸°í™”</button>
        </div>
    </div>
</div>

<script>
    /* =========================================
       1. ì „ì—­ ë³€ìˆ˜ ë° ìƒíƒœ ê´€ë¦¬
       ========================================= */
    const mainCanvas = document.getElementById('mainCanvas');
    const mCtx = mainCanvas.getContext('2d');
    const particleCanvas = document.getElementById('particleCanvas');
    const pCtx = particleCanvas.getContext('2d');
    const explainBox = document.getElementById('explanationBox');
    const tempDisplay = document.getElementById('tempDisplay');

    let currentStep = 0; // 0: ì´ˆê¸°, 1: ê°€ì—´, 2: ëƒ‰ê°, 3: ë°œì‚¬
    let temperature = 25; // ì„­ì”¨
    let waterInDoll = 0; // ì¸í˜• ì† ë¬¼ì˜ ì–‘ (0 ~ 100)
    let bubbles = []; // ê¸°í¬ ë°°ì—´
    let waterStream = []; // ë¬¼ì¤„ê¸° ì…ì ë°°ì—´
    
    // ì…ì ì‹œë®¬ë ˆì´ì…˜ ë³€ìˆ˜
    const particles = [];
    const NUM_PARTICLES = 30;

    /* =========================================
       2. ì…ì(Particle) í´ë˜ìŠ¤ ì •ì˜
       ========================================= */
    class Particle {
        constructor() {
            this.x = Math.random() * particleCanvas.width;
            this.y = Math.random() * particleCanvas.height;
            this.vx = (Math.random() - 0.5) * 2;
            this.vy = (Math.random() - 0.5) * 2;
            this.radius = 3;
        }

        update(tempFactor) {
            // ì˜¨ë„ê°€ ë†’ì„ìˆ˜ë¡ ì†ë„ ì¦ê°€
            this.x += this.vx * tempFactor;
            this.y += this.vy * tempFactor;

            // ë²½ ì¶©ëŒ (íŠ•ê¸°ê¸°)
            if (this.x < 0 || this.x > particleCanvas.width) this.vx *= -1;
            if (this.y < 0 || this.y > particleCanvas.height) this.vy *= -1;
        }

        draw(ctx, color) {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
            ctx.fillStyle = color;
            ctx.fill();
        }
    }

    // ì´ˆê¸° ì…ì ìƒì„±
    for (let i = 0; i < NUM_PARTICLES; i++) {
        particles.push(new Particle());
    }

    /* =========================================
       3. ë©”ì¸ ê·¸ë¦¬ê¸° í•¨ìˆ˜ (Main Drawing)
       ========================================= */
    function drawScene() {
        mCtx.clearRect(0, 0, mainCanvas.width, mainCanvas.height);

        // ë°°ê²½ (ì±…ìƒ)
        mCtx.fillStyle = '#e0e0e0';
        mCtx.fillRect(0, 300, 500, 100);

        // ë¹„ì»¤ ê·¸ë¦¬ê¸° (ìœ„ì¹˜ ë° ìƒíƒœì— ë”°ë¼ ë‹¤ë¥´ê²Œ)
        if (currentStep === 1) {
            drawBeaker(250, 280, '#ffdede', 'ëœ¨ê±°ìš´ ë¬¼ (80Â°C)', true); // ì¸í˜• í¬í•¨
        } else if (currentStep === 2) {
            drawBeaker(250, 280, '#def6ff', 'ì°¨ê°€ìš´ ë¬¼ (5Â°C)', true); // ì¸í˜• í¬í•¨
        } else if (currentStep === 3) {
            drawDoll(250, 250, false); // ë¹„ì»¤ ì—†ì´ ì¸í˜•ë§Œ ì„œ ìˆìŒ
            drawWaterStream(); // ë¬¼ì¤„ê¸°
        } else {
            drawDoll(250, 250, false); // ì´ˆê¸° ìƒíƒœ
        }

        // ê¸°í¬ ì• ë‹ˆë©”ì´ì…˜ (1ë‹¨ê³„)
        if (currentStep === 1) {
            drawBubbles();
        }
    }

    function drawBeaker(x, y, color, label, hasDoll) {
        // ë¹„ì»¤ ë³¸ì²´
        mCtx.fillStyle = color;
        mCtx.fillRect(x - 60, y - 100, 120, 120);
        mCtx.strokeStyle = '#aaa';
        mCtx.lineWidth = 2;
        mCtx.strokeRect(x - 60, y - 100, 120, 120);
        
        // ë¼ë²¨
        mCtx.fillStyle = '#333';
        mCtx.font = '14px sans-serif';
        mCtx.textAlign = 'center';
        mCtx.fillText(label, x, y + 40);

        if (hasDoll) {
            // ì¸í˜•ì´ ë¬¼ ì†ì— ì ê¹€
            drawDoll(x, y - 40, true);
        }
    }

    function drawDoll(x, y, isSubmerged) {
        // ì¸í˜• ëª¸í†µ (ë‹¨ìˆœí™”ëœ í˜•íƒœ)
        mCtx.fillStyle = '#f8c291'; // ì‚´êµ¬ìƒ‰
        mCtx.beginPath();
        mCtx.arc(x, y, 30, 0, Math.PI * 2); // ë¨¸ë¦¬
        mCtx.fill();
        
        mCtx.beginPath(); // ëª¸í†µ
        mCtx.ellipse(x, y + 40, 35, 45, 0, 0, Math.PI * 2);
        mCtx.fill();

        // ëˆˆ
        mCtx.fillStyle = 'black';
        mCtx.beginPath();
        mCtx.arc(x - 10, y - 5, 2, 0, Math.PI * 2);
        mCtx.arc(x + 10, y - 5, 2, 0, Math.PI * 2);
        mCtx.fill();

        // ì… (êµ¬ë©)
        mCtx.fillStyle = '#555';
        mCtx.beginPath();
        mCtx.arc(x, y + 10, 3, 0, Math.PI * 2); // ì… êµ¬ë©
        mCtx.fill();

        // ë‚´ë¶€ ë¬¼ ì‹œê°í™” (ë°˜íˆ¬ëª… íŒŒë€ìƒ‰)
        if (waterInDoll > 0) {
            mCtx.save();
            mCtx.globalAlpha = 0.6;
            mCtx.fillStyle = '#00a8ff';
            // ë¬¼ì´ ì°¨ì˜¤ë¥´ëŠ” ë†’ì´ ê³„ì‚°
            let height = (waterInDoll / 100) * 40;
            mCtx.beginPath();
            mCtx.arc(x, y + 40 + (40-height), height, 0, Math.PI * 2); // ëŒ€ì¶© ë‚´ë¶€ì— ë¬¼ ì°¸
            mCtx.fill();
            mCtx.restore();
        }
    }

    // ê¸°í¬ ë¡œì§ (1ë‹¨ê³„)
    function createBubble() {
        if(Math.random() > 0.9) {
            bubbles.push({x: 250, y: 250, r: 2 + Math.random()*3, speed: 1 + Math.random()});
        }
    }

    function drawBubbles() {
        createBubble();
        mCtx.fillStyle = 'rgba(255, 255, 255, 0.7)';
        mCtx.strokeStyle = '#fff';
        
        for (let i = 0; i < bubbles.length; i++) {
            let b = bubbles[i];
            mCtx.beginPath();
            mCtx.arc(b.x, b.y, b.r, 0, Math.PI * 2);
            mCtx.fill();
            mCtx.stroke();
            
            b.y -= b.speed; // ìœ„ë¡œ ìƒìŠ¹
            b.x += (Math.random() - 0.5) * 2; // ì¢Œìš° í”ë“¤ë¦¼

            // í™”ë©´ ë°–ìœ¼ë¡œ ë‚˜ê°€ë©´ ì œê±°
            if (b.y < 180) { 
                bubbles.splice(i, 1);
                i--;
            }
        }
    }

    // ë¬¼ì¤„ê¸° ë¡œì§ (3ë‹¨ê³„)
    function drawWaterStream() {
        // ë¬¼ì´ ìˆìœ¼ë©´ ì˜ê¸°
        if (waterInDoll > 0) {
            mCtx.strokeStyle = '#00a8ff';
            mCtx.lineWidth = 4;
            mCtx.beginPath();
            mCtx.moveTo(250, 260); // ì… ìœ„ì¹˜
            
            // í¬ë¬¼ì„  ê·¸ë¦¬ê¸°
            mCtx.quadraticCurveTo(250 + 50, 200, 250 + 150, 300);
            mCtx.stroke();

            // ë¬¼ ê°ì†Œ
            waterInDoll -= 0.5;
            
            // ë¨¸ë¦¬ì— ëœ¨ê±°ìš´ ë¬¼ ë¶“ëŠ” íš¨ê³¼
            mCtx.fillStyle = 'rgba(255,0,0,0.3)';
            mCtx.fillRect(220, 200, 60, 20);
            mCtx.fillStyle = 'red';
            mCtx.font = "12px sans-serif";
            mCtx.fillText("ëœ¨ê±°ìš´ ë¬¼ ë¶“ëŠ” ì¤‘!", 250, 190);
        } else {
            // ë¬¼ ë‹¤ ì¨
            mCtx.fillStyle = '#333';
            mCtx.fillText("ë°œì‚¬ ì™„ë£Œ!", 250, 150);
        }
    }

    /* =========================================
       4. ì…ì ì‹œë®¬ë ˆì´ì…˜ ë° ì• ë‹ˆë©”ì´ì…˜ ë£¨í”„
       ========================================= */
    function animate() {
        drawScene();

        // ì…ì ìº”ë²„ìŠ¤ ê·¸ë¦¬ê¸°
        pCtx.fillStyle = 'rgba(0, 0, 0, 0.2)'; // ì”ìƒ íš¨ê³¼
        pCtx.fillRect(0, 0, particleCanvas.width, particleCanvas.height);

        let speedFactor = 1;
        let particleColor = '#fff';

        if (temperature > 50) {
            speedFactor = 4.0; // ë¹ ë¦„
            particleColor = '#ff6b6b'; // ë¹¨ê°•
        } else if (temperature < 15) {
            speedFactor = 0.5; // ëŠë¦¼
            particleColor = '#48dbfb'; // íŒŒë‘
        } else {
            speedFactor = 1.5; // ë³´í†µ
            particleColor = '#fff';
        }

        particles.forEach(p => {
            p.update(speedFactor);
            p.draw(pCtx, particleColor);
        });

        requestAnimationFrame(animate);
    }

    /* =========================================
       5. ì‹¤í—˜ ì œì–´ ë¡œì§ (Button Handlers)
       ========================================= */
    function startStep(step) {
        currentStep = step;
        
        // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
        document.querySelectorAll('button').forEach(b => b.classList.remove('active'));
        document.getElementById(`btnStep${step}`).classList.add('active');

        // ë‹¤ìŒ ë‹¨ê³„ ë²„íŠ¼ í™œì„±í™” ë¡œì§
        if(step === 1) {
            temperature = 80;
            updateUI("ğŸŒ¡ï¸ ê°€ì—´ ì¤‘ (80Â°C)", "hot", 
                "<h3>1ë‹¨ê³„: ê°€ì—´ (íŒ½ì°½)</h3><p>ê¸°ì²´ ì˜¨ë„ê°€ ì˜¬ë¼ê°€ ì…ì ìš´ë™ì´ <b>í™œë°œ</b>í•´ì§‘ë‹ˆë‹¤.<br>ë¶€í”¼ê°€ ì»¤ì ¸ì„œ ê³µê¸°ê°€ ë°–ìœ¼ë¡œ <b>ë°©ìš¸ë°©ìš¸</b> ë¹ ì ¸ë‚˜ê°‘ë‹ˆë‹¤.</p>");
            document.getElementById('btnStep2').disabled = false;
        } 
        else if (step === 2) {
            temperature = 5;
            waterInDoll = 50; // ë¬¼ì´ ì°¨ì˜¤ë¦„ (ì‹œë®¬ë ˆì´ì…˜ìƒ ì¦‰ì‹œ í• ë‹¹)
            updateUI("â„ï¸ ëƒ‰ê° ì¤‘ (5Â°C)", "cold", 
                "<h3>2ë‹¨ê³„: ëƒ‰ê° (ìˆ˜ì¶•)</h3><p>ê¸°ì²´ ì˜¨ë„ê°€ ë‚´ë ¤ê°€ ì…ì ìš´ë™ì´ <b>ë‘”í•´</b>ì§‘ë‹ˆë‹¤.<br>ë¶€í”¼ê°€ ì¤„ì–´ë“¤ë©° ë¹ˆ ê³µê°„ìœ¼ë¡œ <b>ë¬¼ì´ ë¹¨ë ¤ ë“¤ì–´ì˜µë‹ˆë‹¤.</b></p>");
            document.getElementById('btnStep3').disabled = false;
        } 
        else if (step === 3) {
            temperature = 90;
            updateUI("ğŸ”¥ ê¸‰ê°€ì—´ ì¤‘ (90Â°C)", "hot", 
                "<h3>3ë‹¨ê³„: ì¬ê°€ì—´ (ë°œì‚¬!)</h3><p>ê°‘ìê¸° ëœ¨ê±°ì›Œì§€ë©´ ê¸°ì²´ê°€ <b>ê¸‰ê²©íˆ íŒ½ì°½</b>í•©ë‹ˆë‹¤.<br>ì»¤ì§„ ê¸°ì²´ ë¶€í”¼ê°€ ë¬¼ì„ ë°€ì–´ë‚´ì–´ <b>ë¬¼ì¤„ê¸°ê°€ ë°œì‚¬</b>ë©ë‹ˆë‹¤!</p>");
        }
    }

    function updateUI(tempText, tempClass, explainHtml) {
        tempDisplay.innerText = tempText;
        tempDisplay.className = `temp-indicator ${tempClass}`;
        explainBox.innerHTML = explainHtml;
    }

    function resetExperiment() {
        currentStep = 0;
        temperature = 25;
        waterInDoll = 0;
        bubbles = [];
        
        document.getElementById('btnStep1').classList.remove('active');
        document.getElementById('btnStep2').classList.remove('active');
        document.getElementById('btnStep3').classList.remove('active');
        document.getElementById('btnStep2').disabled = true;
        document.getElementById('btnStep3').disabled = true;

        updateUI("25Â°C", "", 
            "<h3>ì‹¤í—˜ ì¤€ë¹„ ì™„ë£Œ</h3><p>ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ 1ë‹¨ê³„ë¶€í„° ì‹œì‘í•´ë³´ì„¸ìš”.</p>");
    }

    // ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
    animate();

</script>

</body>
</html>