<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°€ìƒ í™”í•™ ì‹¤í—˜ì‹¤: ë¬¼ì§ˆì˜ ìƒíƒœì™€ 1ëª°ì˜ ì–‘</title>
    <style>
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #50e3c2;
            --accent-color: #f5a623;
            --bg-color: #f4f7f6;
            --text-color: #333;
            --card-bg: #ffffff;
        }
        body {
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .container {
            max-width: 1000px;
            width: 100%;
        }
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        header h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        header p {
            font-size: 1.1em;
            color: #666;
        }
        .lab-bench {
            background: var(--card-bg);
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 30px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
            justify-content: center;
            align-items: center;
        }
        select, button {
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
            font-size: 1rem;
            cursor: pointer;
        }
        button.action-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            font-weight: bold;
        }
        button.action-btn:hover {
            background-color: #357abd;
        }
        
        /* Experiment Area */
        .experiment-area {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            min-height: 400px;
        }
        .visual-stage {
            flex: 2;
            background: #eef2f5;
            border-radius: 10px;
            position: relative;
            height: 400px;
            display: flex;
            justify-content: center;
            align-items: flex-end; /* Bottom align for gravity feel */
            overflow: hidden;
            margin-right: 20px;
            border: 2px solid #ddd;
        }
        .data-panel {
            flex: 1;
            background: #fafafa;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #eee;
        }
        .data-item {
            margin-bottom: 15px;
        }
        .data-label {
            font-size: 0.9em;
            color: #777;
        }
        .data-value {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--primary-color);
        }

        /* Visual Elements */
        .scale-label {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(255,255,255,0.8);
            padding: 5px;
            border-radius: 4px;
            font-size: 0.8em;
        }
        
        /* Substance Styles */
        #substance-visual {
            transition: all 0.5s ease;
        }
        /* Solid: Cube */
        .solid-cube {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #b87333, #d4a373); /* Copper like */
            border: 2px solid #8c5626;
            box-shadow: 5px 5px 10px rgba(0,0,0,0.3);
            margin-bottom: 50px; /* Sitting on a surface */
            position: relative;
        }
        .solid-cube::after {
            content: "Cu";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
        }

        /* Liquid: Beaker */
        .beaker {
            width: 80px;
            height: 100px;
            border: 3px solid #ccc;
            border-top: none;
            border-radius: 0 0 10px 10px;
            position: relative;
            background: rgba(255,255,255,0.2);
            margin-bottom: 50px;
        }
        .liquid-content {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 40px; /* Dynamic */
            background: rgba(74, 144, 226, 0.6);
            border-radius: 0 0 7px 7px;
            transition: height 1s ease;
        }
        
        /* Gas: Balloon */
        .balloon-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
        }
        .balloon {
            width: 20px; /* Start small */
            height: 20px;
            background: rgba(245, 166, 35, 0.7);
            border-radius: 50%;
            transition: all 1s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
            box-shadow: inset -10px -10px 20px rgba(0,0,0,0.1);
        }
        
        .particle-text {
            margin-top: 10px;
            font-size: 0.8rem;
            color: #666;
            animation: fadeIn 2s;
        }

        /* Quiz Section */
        .quiz-section {
            margin-top: 30px;
            background: #fff3e0;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid var(--accent-color);
        }
        .quiz-question {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .feedback {
            margin-top: 10px;
            font-weight: bold;
        }
        .correct { color: green; }
        .wrong { color: red; }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Safety Note */
        .safety-note {
            margin-top: 20px;
            font-size: 0.85em;
            color: #888;
            text-align: center;
            background: #fff;
            padding: 10px;
            border: 1px dashed #ccc;
        }

        .hidden { display: none; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸ§ª ê°€ìƒ ì‹¤í—˜ì‹¤: 1ëª°(Mole) ë¹„êµ ì²´í—˜</h1>
        <p>ê³ ì²´, ì•¡ì²´, ê¸°ì²´ ìƒíƒœì˜ ë¬¼ì§ˆ 1ëª°ì€ ì–¼ë§ˆë‚˜ ì°¨ì´ê°€ ë‚ ê¹Œìš”?</p>
    </header>

    <div class="lab-bench">
        <div class="controls">
            <label>1. ìƒíƒœ ì„ íƒ: 
                <select id="stateSelect" onchange="updateSubstanceOptions()">
                    <option value="" disabled selected>--ì„ íƒí•˜ì„¸ìš”--</option>
                    <option value="solid">ê³ ì²´ (Solid)</option>
                    <option value="liquid">ì•¡ì²´ (Liquid)</option>
                    <option value="gas">ê¸°ì²´ (Gas)</option>
                </select>
            </label>

            <label>2. ë¬¼ì§ˆ ì„ íƒ: 
                <select id="substanceSelect" disabled onchange="resetExperiment()">
                    <option>ë¨¼ì € ìƒíƒœë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                </select>
            </label>

            <label id="tempControl" class="hidden">3. ì˜¨ë„ ì„¤ì •: 
                <select id="tempSelect" onchange="runExperiment()">
                    <option value="0">0Â°C (í‘œì¤€ ìƒíƒœ)</option>
                    <option value="25">25Â°C (ìƒì˜¨)</option>
                </select>
            </label>

            <button class="action-btn" onclick="runExperiment()">ì‹¤í—˜ ì‹œì‘ (1ëª° ì¸¡ì •)</button>
        </div>

        <div class="experiment-area">
            <div class="visual-stage" id="visualStage">
                <div class="scale-label" id="scaleLabel">ëŒ€ê¸° ìƒíƒœ...</div>
                <div id="substance-visual"></div>
            </div>

            <div class="data-panel">
                <h3>ğŸ“Š ì¸¡ì • ê²°ê³¼ (1ëª° ê¸°ì¤€)</h3>
                <div class="data-item">
                    <div class="data-label">í™”í•™ì‹ëŸ‰ (ë¶„ìëŸ‰/ì›ìëŸ‰)</div>
                    <div class="data-value" id="molarMassDisplay">- g/mol</div>
                </div>
                <div class="data-item">
                    <div class="data-label">ì¸¡ì •ëœ ì§ˆëŸ‰</div>
                    <div class="data-value" id="massDisplay">- g</div>
                </div>
                <div class="data-item">
                    <div class="data-label">ì°¨ì§€í•˜ëŠ” ë¶€í”¼</div>
                    <div class="data-value" id="volumeDisplay">-</div>
                </div>
                <div class="data-item">
                    <div class="data-label">ì…ì ìˆ˜ (ì•„ë³´ê°€ë“œë¡œ ìˆ˜)</div>
                    <div class="data-value" style="font-size: 1em;">6.02 Ã— 10Â²Â³ ê°œ</div>
                </div>
                <div id="particle-msg" class="particle-text"></div>
            </div>
        </div>

        <div class="quiz-section">
            <h3>ğŸ“ í•™ìŠµ í™•ì¸ í€´ì¦ˆ</h3>
            <div id="quiz-content">
                <p>ì‹¤í—˜ì„ ë¨¼ì € ì§„í–‰í•´ì£¼ì„¸ìš”.</p>
            </div>
        </div>
    </div>

    <div class="safety-note">
        âš ï¸ <strong>ì•ˆì „ ì£¼ì˜:</strong> ê°€ìƒ ì‹¤í—˜ì´ì§€ë§Œ ì‹¤ì œ ì‹¤í—˜ì‹¤ì—ì„œëŠ” í™”í•™ ë¬¼ì§ˆì„ ë‹¤ë£° ë•Œ ë°˜ë“œì‹œ ë³´ì•ˆê²½ê³¼ ì¥ê°‘ì„ ì°©ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ê¸°ì²´ë¥¼ ë‹¤ë£° ë•ŒëŠ” í™˜ê¸°ê°€ ì˜ ë˜ëŠ” ê³³ì—ì„œ ì‹¤í—˜í•˜ì„¸ìš”.
    </div>
</div>

<script>
    // ë¬¼ì§ˆ ë°ì´í„°ë² ì´ìŠ¤
    const substances = {
        solid: [
            { name: "êµ¬ë¦¬ (Cu)", mass: 63.5, density: 8.96, color: "#b87333", type: "atom" },
            { name: "ì²  (Fe)", mass: 55.8, density: 7.87, color: "#5c5c5c", type: "atom" },
            { name: "ì•Œë£¨ë¯¸ëŠ„ (Al)", mass: 27.0, density: 2.70, color: "#d1d1d1", type: "atom" }
        ],
        liquid: [
            { name: "ë¬¼ (Hâ‚‚O)", mass: 18.0, density: 1.0, color: "rgba(74, 144, 226, 0.6)", type: "molecule" },
            { name: "ì—íƒ„ì˜¬ (Câ‚‚Hâ‚…OH)", mass: 46.0, density: 0.789, color: "rgba(200, 200, 200, 0.4)", type: "molecule" }
        ],
        gas: [
            { name: "ì´ì‚°í™”íƒ„ì†Œ (COâ‚‚)", mass: 44.0, color: "#f5a623", type: "molecule" },
            { name: "í—¬ë¥¨ (He)", mass: 4.0, color: "#e0e0e0", type: "atom" },
            { name: "ì‚°ì†Œ (Oâ‚‚)", mass: 32.0, color: "#7ed6df", type: "molecule" }
        ]
    };

    let currentSubstance = null;
    let currentState = "";

    function updateSubstanceOptions() {
        const stateSelect = document.getElementById("stateSelect");
        const subSelect = document.getElementById("substanceSelect");
        const tempControl = document.getElementById("tempControl");
        
        currentState = stateSelect.value;
        subSelect.innerHTML = "";
        subSelect.disabled = false;

        // ì˜¨ë„ ì œì–´ í‘œì‹œ ì—¬ë¶€
        if (currentState === 'gas') {
            tempControl.classList.remove('hidden');
        } else {
            tempControl.classList.add('hidden');
        }

        // ì˜µì…˜ ì±„ìš°ê¸°
        substances[currentState].forEach((sub, index) => {
            const option = document.createElement("option");
            option.value = index;
            option.text = sub.name;
            subSelect.add(option);
        });
        
        resetExperiment();
    }

    function resetExperiment() {
        document.getElementById("visualStage").innerHTML = '<div class="scale-label">ì¤€ë¹„ ì™„ë£Œ</div>';
        document.getElementById("molarMassDisplay").innerText = "- g/mol";
        document.getElementById("massDisplay").innerText = "- g";
        document.getElementById("volumeDisplay").innerText = "-";
        document.getElementById("particle-msg").innerText = "";
        document.getElementById("quiz-content").innerHTML = "<p>ì‹¤í—˜ ì‹œì‘ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</p>";
    }

    function runExperiment() {
        const subSelect = document.getElementById("substanceSelect");
        if (subSelect.disabled) return;

        const index = subSelect.value;
        currentSubstance = substances[currentState][index];
        
        // ë°ì´í„° í‘œì‹œ
        document.getElementById("molarMassDisplay").innerText = `${currentSubstance.mass} g/mol`;
        document.getElementById("massDisplay").innerText = `${currentSubstance.mass} g`;
        
        const visualStage = document.getElementById("visualStage");
        visualStage.innerHTML = ""; // ì´ˆê¸°í™”

        let volumeText = "";
        let visualElement = document.createElement("div");

        // ìƒíƒœë³„ ë¡œì§
        if (currentState === 'solid') {
            // ë¶€í”¼ ê³„ì‚° V = m / d
            const volume = (currentSubstance.mass / currentSubstance.density).toFixed(2);
            volumeText = `${volume} cmÂ³ (mL)`;
            
            // ì‹œê°í™”: íë¸Œ
            visualElement.className = "solid-cube";
            visualElement.style.background = `linear-gradient(135deg, ${currentSubstance.color}, #333)`;
            // ìƒëŒ€ì  í¬ê¸° ì¡°ì ˆ (ë§¤ìš° ì‘ê²Œ)
            visualElement.style.width = "40px"; 
            visualElement.style.height = "40px";
            
            visualStage.innerHTML = `<div class="scale-label">í™•ëŒ€ ë°°ìœ¨: 5x (ì‹¤ì œë¡œëŠ” ë§¤ìš° ì‘ìŠµë‹ˆë‹¤)</div>`;
            visualStage.appendChild(visualElement);
            
            generateQuiz("solid", volume);

        } else if (currentState === 'liquid') {
            const volume = (currentSubstance.mass / currentSubstance.density).toFixed(2);
            volumeText = `${volume} mL`;

            // ì‹œê°í™”: ë¹„ì»¤
            visualElement.className = "beaker";
            const liquid = document.createElement("div");
            liquid.className = "liquid-content";
            liquid.style.height = `${Math.min(volume * 2, 90)}px`; // ë¹„ì»¤ ë‚´ ë†’ì´ ì‹œë®¬ë ˆì´ì…˜
            liquid.style.background = currentSubstance.color;
            
            visualElement.appendChild(liquid);
            visualStage.innerHTML = `<div class="scale-label">í™•ëŒ€ ë°°ìœ¨: 5x</div>`;
            visualStage.appendChild(visualElement);
            
            generateQuiz("liquid", volume);

        } else if (currentState === 'gas') {
            const temp = parseInt(document.getElementById("tempSelect").value);
            // ìƒ¤ë¥¼ì˜ ë²•ì¹™ V2 = V1 * (T2/T1) -> TëŠ” ì ˆëŒ€ì˜¨ë„
            // 0ë„ì¼ ë•Œ 22.4L
            let volume = 22.4;
            if (temp === 25) {
                volume = 22.4 * (298 / 273);
            }
            volume = volume.toFixed(1);
            volumeText = `${volume} L`;

            // ì‹œê°í™”: í’ì„ 
            visualStage.innerHTML = `<div class="scale-label">ì¶•ì†Œ ë°°ìœ¨: 0.1x (ê³ ì²´/ì•¡ì²´ë³´ë‹¤ 1000ë°° ì´ìƒ í½ë‹ˆë‹¤!)</div>`;
            const balloonContainer = document.createElement("div");
            balloonContainer.className = "balloon-container";
            
            visualElement.className = "balloon";
            visualElement.style.backgroundColor = currentSubstance.color;
            
            // í¬ê¸° ì• ë‹ˆë©”ì´ì…˜ (í”½ì…€ ë‹¨ìœ„ë¡œ í™˜ì‚°í•˜ì—¬ ê³¼ì¥)
            // 22.4LëŠ” ë§¤ìš° í¬ë¯€ë¡œ í™”ë©´ ê½‰ ì°¨ê²Œ ì„¤ì •
            const size = temp === 0 ? 250 : 280; 
            
            balloonContainer.appendChild(visualElement);
            visualStage.appendChild(balloonContainer);

            // ì• ë‹ˆë©”ì´ì…˜ íŠ¸ë¦¬ê±°
            setTimeout(() => {
                visualElement.style.width = `${size}px`;
                visualElement.style.height = `${size}px`;
                visualElement.innerText = currentSubstance.name;
            }, 100);

            generateQuiz("gas", volume);
        }

        document.getElementById("volumeDisplay").innerText = volumeText;
        document.getElementById("particle-msg").innerText = 
            `ğŸ’¡ ìƒíƒœëŠ” ë‹¬ë¼ë„ ì…ìì˜ ê°œìˆ˜ëŠ” 6.02 Ã— 10Â²Â³ ê°œë¡œ ëª¨ë‘ ë™ì¼í•©ë‹ˆë‹¤!`;
    }

    function generateQuiz(state, volumeVal) {
        const quizBox = document.getElementById("quiz-content");
        let html = "";

        if (state === 'gas') {
            // ê¸°ì²´ìš© í€´ì¦ˆ: ë°˜ì§€ë¦„ ê³„ì‚° ë„ì „
            html = `
                <div class="quiz-question">Q. ${currentSubstance.name} 1ëª°(ì•½ ${volumeVal}L)ì´ ë“¤ì–´ìˆëŠ” í’ì„ ì„ ì™„ë²½í•œ 'êµ¬(Sphere)'ë¼ê³  ê°€ì •í•  ë•Œ, ì´ í’ì„ ì˜ ì§€ë¦„ì€ ëŒ€ëµ ì–¼ë§ˆì¼ê¹Œìš”?</div>
                <input type="number" id="quizInput" placeholder="cm ë‹¨ìœ„ ì…ë ¥">
                <button onclick="checkQuiz('gas', ${volumeVal})">ì •ë‹µ í™•ì¸</button>
                <p id="quizFeedback" class="feedback"></p>
                <small>íŒíŠ¸: 1000L = 1mÂ³, êµ¬ì˜ ë¶€í”¼ V = 4/3Ï€rÂ³ ì…ë‹ˆë‹¤. (ëŒ€ëµ 30~40cm ì‚¬ì´ì…ë‹ˆë‹¤)</small>
            `;
        } else {
            // ê³ ì²´/ì•¡ì²´ìš© í€´ì¦ˆ
            html = `
                <div class="quiz-question">Q. ê¸°ì²´ 1ëª°(22.4L)ì— ë¹„í•´ ${currentSubstance.name} 1ëª°ì˜ ë¶€í”¼ëŠ” ì™œ ì´ë ‡ê²Œ ì‘ì„ê¹Œìš”?</div>
                <textarea id="quizInput" rows="2" style="width:100%" placeholder="ì´ìœ ë¥¼ ì ì–´ë³´ì„¸ìš”"></textarea>
                <button onclick="checkQuiz('other', 0)">í™•ì¸</button>
                <p id="quizFeedback" class="feedback"></p>
            `;
        }
        quizBox.innerHTML = html;
    }

    function checkQuiz(type, val) {
        const input = document.getElementById("quizInput").value;
        const feedback = document.getElementById("quizFeedback");
        
        if (type === 'gas') {
            // 22.4L -> 22400 cm^3
            // r = cbrt(V * 3 / (4 * PI))
            // r approx 17.5 cm -> d approx 35 cm
            const volCm3 = val * 1000;
            const radius = Math.cbrt((volCm3 * 3) / (4 * Math.PI));
            const diameter = radius * 2;
            
            if (input >= diameter - 5 && input <= diameter + 5) {
                feedback.innerHTML = `<span class="correct">ì •ë‹µì…ë‹ˆë‹¤! ì•½ ${diameter.toFixed(1)}cm ì…ë‹ˆë‹¤. ë†êµ¬ê³µë³´ë‹¤ í›¨ì”¬ í¬ì£ ?</span>`;
            } else {
                feedback.innerHTML = `<span class="wrong">ì•„ì‰½ë„¤ìš”. ì •ë‹µì€ ì•½ ${diameter.toFixed(1)}cm ì…ë‹ˆë‹¤. ë‹¤ì‹œ ê³„ì‚°í•´ë³´ì„¸ìš”!</span>`;
            }
        } else {
            if (input.length > 10) {
                feedback.innerHTML = `<span class="correct">í›Œë¥­í•©ë‹ˆë‹¤! í•µì‹¬ì€ 'ì…ì ì‚¬ì´ì˜ ê±°ë¦¬'ì…ë‹ˆë‹¤. ê³ ì²´/ì•¡ì²´ëŠ” ì…ìê°€ ë‹¤ë‹¥ë‹¤ë‹¥ ë¶™ì–´ìˆì§€ë§Œ, ê¸°ì²´ëŠ” ì„œë¡œ ë©€ë¦¬ ë–¨ì–´ì ¸ ìˆìŠµë‹ˆë‹¤.</span>`;
            } else {
                feedback.innerHTML = `<span class="wrong">ì¡°ê¸ˆ ë” êµ¬ì²´ì ìœ¼ë¡œ ì ì–´ë³¼ê¹Œìš”? 'ì…ì ê°„ ê±°ë¦¬'ë¥¼ ìƒê°í•´ë³´ì„¸ìš”.</span>`;
            }
        }
    }
</script>

</body>
</html>