<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ê°€ìƒ ì‹¤í—˜ì‹¤: ë¬¼ì˜ ê¸°í™”ì™€ ì•¡í™”</title>
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f0f4f8; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .container { bg-white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 800px; width: 100%; display: flex; gap: 20px; flex-wrap: wrap; }
        .canvas-area { position: relative; width: 400px; height: 400px; background: #e0e0e0; border-radius: 10px; overflow: hidden; border: 2px solid #ccc; }
        canvas { display: block; }
        .controls { flex: 1; display: flex; flex-direction: column; gap: 15px; }
        h1 { color: #2c3e50; margin-bottom: 10px; }
        .control-group { background: #fff; padding: 15px; border-radius: 8px; border: 1px solid #ddd; }
        label { font-weight: bold; display: block; margin-bottom: 5px; color: #555; }
        input[type="range"] { width: 100%; }
        button { background: #3498db; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; font-size: 14px; transition: 0.3s; }
        button:hover { background: #2980b9; }
        button.active { background: #27ae60; }
        .feedback-box { margin-top: 20px; padding: 15px; background: #fff3cd; border-left: 5px solid #ffc107; border-radius: 4px; line-height: 1.6; }
        .status-bar { display: flex; justify-content: space-between; font-size: 0.9em; color: #666; margin-top: 5px; }
        
        /* ì‹œê°ì  ìš”ì†Œ ìŠ¤íƒ€ì¼ */
        .watch-glass { position: absolute; top: 50px; left: 50px; width: 300px; height: 20px; background: rgba(255,255,255,0.6); border: 2px solid #aaa; border-radius: 50% 50% 0 0; display: none; text-align: center; line-height: 20px; font-size: 12px; color: #333; pointer-events: none; }
        .paper { position: absolute; top: 20px; right: 20px; width: 60px; height: 80px; background: #a2d2ff; border: 1px solid #666; transition: background 1s; display: flex; align-items: center; justify-content: center; font-size: 10px; text-align: center; cursor: grab; }
        .paper.dry { background: #a2d2ff; } /* í‘¸ë¥¸ìƒ‰ (ê±´ì¡°) */
        .paper.wet { background: #ffadad; } /* ë¶‰ì€ìƒ‰ (ë¬¼ ë°˜ì‘) */
    </style>
</head>
<body>

    <h1>ğŸ’§ ë¬¼ì˜ ìƒíƒœ ë³€í™” ì‹¤í—˜ì‹¤</h1>

    <div class="container">
        <div class="canvas-area">
            <canvas id="simCanvas" width="400" height="400"></canvas>
            <div id="watchGlass" class="watch-glass">ì‹œê³„ ì ‘ì‹œ (ì°¨ê°€ì›€)</div>
            <div id="cobaltPaper" class="paper dry" draggable="true" style="display:none;">ì—¼í™”<br>ì½”ë°œíŠ¸<br>ì¢…ì´</div>
        </div>

        <div class="controls">
            <div class="control-group">
                <label for="tempSlider">ğŸ”¥ ì˜¨ë„ ì¡°ì ˆ: <span id="tempVal">25</span>â„ƒ</label>
                <input type="range" id="tempSlider" min="10" max="100" value="25">
                <div class="status-bar">
                    <span>ì°¨ê°€ì›€</span>
                    <span>ë“ëŠ”ì (100â„ƒ)</span>
                </div>
            </div>

            <div class="control-group">
                <label>ğŸ› ï¸ ì‹¤í—˜ ë„êµ¬</label>
                <div style="display:flex; gap:10px;">
                    <button id="btnWatchGlass" onclick="toggleWatchGlass()">ì‹œê³„ ì ‘ì‹œ ë®ê¸°</button>
                    <button id="btnPaper" onclick="togglePaper()">ì—¼í™” ì½”ë°œíŠ¸ ì¢…ì´</button>
                </div>
            </div>

            <div class="control-group">
                <label>ğŸ“Š ìƒíƒœ ê´€ì°°</label>
                <p id="stateDesc">í˜„ì¬ ë¬¼ì€ <strong>ì•¡ì²´</strong> ìƒíƒœì…ë‹ˆë‹¤. ì…ìë“¤ì´ ì„œë¡œ ë­‰ì³ ìˆìŠµë‹ˆë‹¤.</p>
            </div>

            <button onclick="resetSim()" style="background:#e74c3c;">ğŸ”„ ì‹¤í—˜ ì´ˆê¸°í™”</button>
        </div>
    </div>

    <div class="feedback-box" id="feedback">
        ğŸ‘¨â€ğŸ« <strong>ì„ ìƒë‹˜:</strong> ë¹„ì»¤ì— ë¬¼ì´ ë‹´ê²¨ ìˆìŠµë‹ˆë‹¤. ì˜¨ë„ë¥¼ ì²œì²œíˆ ì˜¬ë ¤ë³´ë©° ì…ìë“¤ì˜ ì›€ì§ì„ì´ ì–´ë–»ê²Œ ë³€í•˜ëŠ”ì§€ ê´€ì°°í•´ë³´ì„¸ìš”!
    </div>

    <script>
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        const tempSlider = document.getElementById('tempSlider');
        const tempVal = document.getElementById('tempVal');
        const feedback = document.getElementById('feedback');
        const watchGlassEl = document.getElementById('watchGlass');
        const cobaltPaper = document.getElementById('cobaltPaper');

        let particles = [];
        let temperature = 25;
        let isCovered = false;
        let isPaperActive = false;
        let waterLevel = 300; // Y coordinate
        
        // ì…ì í´ë˜ìŠ¤
        class Particle {
            constructor() {
                this.x = Math.random() * 200 + 100; // ë¹„ì»¤ ë‚´ë¶€
                this.y = Math.random() * 100 + 250; // ì•¡ì²´ ì˜ì—­
                this.vx = (Math.random() - 0.5) * 2;
                this.vy = (Math.random() - 0.5) * 2;
                this.state = 'liquid'; // liquid, gas, condensed
                this.radius = 4;
            }

            update() {
                // ì˜¨ë„ì— ë”°ë¥¸ ì†ë„ ê³„ìˆ˜
                let speedFactor = temperature / 30;
                
                // ìƒíƒœë³„ ì›€ì§ì„
                if (this.state === 'liquid') {
                    this.x += this.vx * speedFactor * 0.5;
                    this.y += this.vy * speedFactor * 0.5;

                    // ë¹„ì»¤ ë²½ ì¶©ëŒ (ì•¡ì²´)
                    if (this.x < 100 || this.x > 300) this.vx *= -1;
                    if (this.y > 380) this.vy *= -1; // ë°”ë‹¥
                    
                    // í‘œë©´ ì¥ë ¥ / ê¸°í™” ë¡œì§
                    if (this.y < waterLevel) {
                        // ì˜¨ë„ê°€ ë†’ì„ìˆ˜ë¡ íƒˆì¶œ í™•ë¥  ì¦ê°€ (ê¸°í™”)
                        if (Math.random() * 100 < (temperature - 50)) {
                            this.state = 'gas';
                        } else {
                            this.y = waterLevel;
                            this.vy *= -1;
                        }
                    }
                } else if (this.state === 'gas') {
                    this.x += this.vx * speedFactor * 1.5;
                    this.y += this.vy * speedFactor * 1.5 - 1; // ìœ„ë¡œ ìƒìŠ¹ ê²½í–¥

                    // ë²½ ì¶©ëŒ (ê¸°ì²´ëŠ” ììœ ë¡œì›€)
                    if (this.x < 20 || this.x > 380) this.vx *= -1;
                    if (this.y < 20) this.vy *= -1; // ì²œì¥

                    // ì‹œê³„ ì ‘ì‹œ(ì•¡í™”) ë¡œì§
                    if (isCovered && this.y < 80 && this.x > 50 && this.x < 350) {
                         this.state = 'condensed';
                         this.y = 80; // ì ‘ì‹œì— ë¶™ìŒ
                    }
                } else if (this.state === 'condensed') {
                    // ë§ºí˜€ìˆë‹¤ê°€ ë–¨ì–´ì§
                    if (Math.random() < 0.02) {
                        this.state = 'liquid'; // ë‹¤ì‹œ ì•¡ì²´ë¡œ ë–¨ì–´ì§
                        this.vy = 2; 
                    }
                }
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                if (this.state === 'liquid') ctx.fillStyle = '#3498db'; // ì§„í•œ íŒŒë‘
                else if (this.state === 'gas') ctx.fillStyle = 'rgba(52, 152, 219, 0.4)'; // ì—°í•œ íŒŒë‘ (ìˆ˜ì¦ê¸°)
                else ctx.fillStyle = '#2980b9'; // ë§ºíŒ ë¬¼ë°©ìš¸
                ctx.fill();
                ctx.closePath();
            }
        }

        // ì´ˆê¸°í™”
        function init() {
            particles = [];
            for (let i = 0; i < 80; i++) {
                particles.push(new Particle());
            }
        }

        function drawBeaker() {
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(100, 50);
            ctx.lineTo(100, 380);
            ctx.lineTo(300, 380);
            ctx.lineTo(300, 50);
            ctx.stroke();
            
            // í•«í”Œë ˆì´íŠ¸
            ctx.fillStyle = temperature > 50 ? '#e74c3c' : '#bdc3c7';
            ctx.fillRect(80, 385, 240, 15);
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            drawBeaker();
            
            particles.forEach(p => {
                p.update();
                p.draw();
            });

            // ì‹œê³„ ì ‘ì‹œ ë¬¼ë°©ìš¸ íš¨ê³¼
            if(isCovered) {
                let condensedCount = particles.filter(p => p.state === 'condensed').length;
                if(condensedCount > 5) {
                   feedback.innerHTML = "ğŸ‘¨â€ğŸ« <strong>ê´€ì°° í¬ì¸íŠ¸:</strong> ì°¨ê°€ìš´ ì‹œê³„ ì ‘ì‹œì— ê¸°ì²´ ì…ìê°€ ë¶€ë”ªí˜€ ì—ë„ˆì§€ë¥¼ ìƒê³  ë‹¤ì‹œ <strong>ì•¡ì²´(ë¬¼ë°©ìš¸)</strong>ë¡œ ë³€í•˜ê³  ìˆì–´ìš”! ì´ê²ƒì´ <strong>ì•¡í™”</strong>ì…ë‹ˆë‹¤.";
                }
            }

            // ì—¼í™” ì½”ë°œíŠ¸ ì¢…ì´ íš¨ê³¼
            if(isPaperActive) {
                // ê¸°ì²´ ì…ìê°€ ì¢…ì´ ê·¼ì²˜(ìš°ìƒë‹¨)ì— ë§ìœ¼ë©´ ìƒ‰ ë³€í™”
                let gasNearPaper = particles.filter(p => p.state === 'gas' && p.y < 150).length;
                if(gasNearPaper > 3 || (isCovered && particles.some(p=>p.state==='condensed'))) {
                     cobaltPaper.className = 'paper wet';
                     cobaltPaper.innerHTML = "ë¶‰ì€ìƒ‰<br>(ë¬¼ í™•ì¸)";
                } else {
                     cobaltPaper.className = 'paper dry';
                     cobaltPaper.innerHTML = "í‘¸ë¥¸ìƒ‰<br>(ê±´ì¡°)";
                }
            }

            requestAnimationFrame(animate);
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        tempSlider.addEventListener('input', (e) => {
            temperature = parseInt(e.target.value);
            tempVal.innerText = temperature;
            
            if(temperature < 50) {
                document.getElementById('stateDesc').innerHTML = "ìƒíƒœ: <strong>ì•¡ì²´</strong> ìœ„ì£¼. ì…ì ì›€ì§ì„ì´ ë‘”í•©ë‹ˆë‹¤.";
            } else if(temperature < 90) {
                document.getElementById('stateDesc').innerHTML = "ìƒíƒœ: <strong>ê¸°í™” í™œë°œ</strong>. í‘œë©´ì˜ ì…ìê°€ ê³µê¸° ì¤‘ìœ¼ë¡œ ë‚ ì•„ê°‘ë‹ˆë‹¤.";
                 feedback.innerHTML = "ğŸ‘¨â€ğŸ« <strong>ì„ ìƒë‹˜:</strong> ì˜¨ë„ê°€ ì˜¬ë¼ê°€ë‹ˆ ì…ìë“¤ì´ ì—ë„ˆì§€ë¥¼ ì–»ì–´ í™œë°œí•´ì¡Œì£ ? í‘œë©´ì—ì„œ íŠ€ì–´ ë‚˜ê°€ëŠ” ì…ìê°€ ë°”ë¡œ <strong>ìˆ˜ì¦ê¸°</strong>ì…ë‹ˆë‹¤.";
            } else {
                document.getElementById('stateDesc').innerHTML = "ìƒíƒœ: <strong>ë“ìŒ</strong>. ë‚´ë¶€ì—ì„œë„ ê¸°í™”ê°€ ì¼ì–´ë‚©ë‹ˆë‹¤.";
            }
        });

        function toggleWatchGlass() {
            isCovered = !isCovered;
            watchGlassEl.style.display = isCovered ? 'block' : 'none';
            document.getElementById('btnWatchGlass').classList.toggle('active');
            if(isCovered) {
                feedback.innerHTML = "ğŸ‘¨â€ğŸ« ì‹œê³„ ì ‘ì‹œë¥¼ ë®ì—ˆìŠµë‹ˆë‹¤. ìœ„ë¡œ ì˜¬ë¼ê°„ ì…ìë“¤ì´ ì–´ë–»ê²Œ ë˜ëŠ”ì§€ ì§€ì¼œë³´ì„¸ìš”.";
            }
        }

        function togglePaper() {
            isPaperActive = !isPaperActive;
            cobaltPaper.style.display = isPaperActive ? 'flex' : 'none';
            document.getElementById('btnPaper').classList.toggle('active');
            if(isPaperActive) {
                feedback.innerHTML = "ğŸ‘¨â€ğŸ« ì—¼í™” ì½”ë°œíŠ¸ ì¢…ì´ë¥¼ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤. ë¬¼ê³¼ ë‹¿ìœ¼ë©´ <strong>í‘¸ë¥¸ìƒ‰</strong>ì—ì„œ <strong>ë¶‰ì€ìƒ‰</strong>ìœ¼ë¡œ ë³€í•©ë‹ˆë‹¤.";
            }
        }

        function resetSim() {
            temperature = 25;
            tempSlider.value = 25;
            tempVal.innerText = 25;
            isCovered = false;
            isPaperActive = false;
            watchGlassEl.style.display = 'none';
            cobaltPaper.style.display = 'none';
            document.getElementById('btnWatchGlass').classList.remove('active');
            document.getElementById('btnPaper').classList.remove('active');
            feedback.innerHTML = "ğŸ‘¨â€ğŸ« <strong>ì„ ìƒë‹˜:</strong> ì²˜ìŒ ìƒíƒœë¡œ ëŒì•„ì™”ìŠµë‹ˆë‹¤.";
            init();
        }

        init();
        animate();
    </script>
</body>
</html>