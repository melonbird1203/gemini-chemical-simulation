<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°€ìƒ ì‹¤í—˜: ì´‰ë§¤ì™€ ê³¼ì‚°í™”ìˆ˜ì†Œ ë¶„í•´</title>
    <style>
        :root {
            --primary-color: #4A90E2;
            --secondary-color: #50E3C2;
            --danger-color: #FF6B6B;
            --bg-color: #F7F9FC;
            --glass-color: rgba(255, 255, 255, 0.8);
        }

        body {
            font-family: 'Malgun Gothic', sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 20px;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 { color: #2C3E50; margin-bottom: 10px; }
        .subtitle { color: #7F8C8D; margin-bottom: 30px; }

        /* ë ˆì´ì•„ì›ƒ */
        .lab-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            max-width: 1000px;
            width: 100%;
            justify-content: center;
        }

        .panel {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            flex: 1;
            min-width: 300px;
        }

        /* ì œì–´ íŒ¨ë„ */
        .control-group { margin-bottom: 20px; }
        label { display: block; font-weight: bold; margin-bottom: 8px; }
        select, button {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ddd;
            font-size: 16px;
            margin-bottom: 10px;
        }
        button {
            cursor: pointer;
            font-weight: bold;
            transition: 0.2s;
        }
        .btn-start { background-color: var(--primary-color); color: white; border: none; }
        .btn-start:hover { background-color: #357ABD; }
        .btn-reset { background-color: #95A5A6; color: white; border: none; }
        
        /* ì‹¤í—˜ ì‹œê°í™” (ë¹„ì»¤ & ê±°í’ˆ) */
        .visualization-area {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            height: 300px;
            background: #E0E6ED;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
            border-bottom: 4px solid #BDC3C7;
        }

        .test-tube {
            width: 80px;
            height: 250px;
            background: linear-gradient(to right, rgba(255,255,255,0.4), rgba(255,255,255,0.1));
            border: 2px solid rgba(255,255,255,0.6);
            border-top: none;
            border-radius: 0 0 20px 20px;
            position: relative;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .liquid {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 40px; /* ì´ˆê¸° ì•¡ì²´ ë†’ì´ */
            background-color: rgba(74, 144, 226, 0.3);
            transition: height 0.5s;
            z-index: 1;
        }

        .foam {
            position: absolute;
            bottom: 40px; /* ì•¡ì²´ ìœ„ */
            width: 100%;
            height: 0px;
            background: repeating-linear-gradient(
                45deg,
                rgba(255, 255, 255, 0.8),
                rgba(255, 255, 255, 0.8) 5px,
                rgba(236, 240, 241, 0.8) 5px,
                rgba(236, 240, 241, 0.8) 10px
            );
            transition: height 0.2s linear;
            z-index: 2;
            opacity: 0.9;
        }

        /* ê±°í’ˆ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ */
        @keyframes bubble {
            0% { transform: translateY(0); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateY(-100px); opacity: 0; }
        }
        .particle {
            position: absolute;
            background: white;
            border-radius: 50%;
            opacity: 0.6;
            animation: bubble 2s infinite ease-in;
            bottom: 10px;
        }

        /* ê·¸ë˜í”„ ì˜ì—­ */
        canvas {
            width: 100%;
            height: 200px;
            border: 1px solid #eee;
            margin-top: 10px;
        }

        /* ê²°ê³¼ ë° í€´ì¦ˆ */
        .result-box {
            margin-top: 20px;
            padding: 15px;
            background-color: #FFF3CD;
            border-radius: 8px;
            display: none;
        }
        .quiz-section { margin-top: 20px; display: none;}
        .quiz-option {
            display: block;
            margin: 5px 0;
            padding: 8px;
            background: #f1f1f1;
            border-radius: 5px;
            cursor: pointer;
        }
        .quiz-option:hover { background: #e2e2e2; }
        .correct { background: #D4EDDA !important; color: #155724; }
        .wrong { background: #F8D7DA !important; color: #721C24; }

    </style>
</head>
<body>

    <h1>âš—ï¸ ê°€ìƒ ì‹¤í—˜ì‹¤: ê³¼ì‚°í™”ìˆ˜ì†Œ ë¶„í•´ì™€ ì´‰ë§¤</h1>
    <p class="subtitle">ì´‰ë§¤ì˜ ì¢…ë¥˜ì— ë”°ë¼ ì‚°ì†Œ ê±°í’ˆì´ ì–¼ë§ˆë‚˜ ë¹ ë¥´ê²Œ ìƒê¸°ëŠ”ì§€ ê´€ì°°í•´ ë´…ì‹œë‹¤.</p>

    <div class="lab-container">
        <div class="panel">
            <h3>ğŸ›ï¸ ì‹¤í—˜ ì¡°ê±´ ì„¤ì •</h3>
            <div class="control-group">
                <label for="catalyst-select">ì´‰ë§¤ ì„ íƒ</label>
                <select id="catalyst-select">
                    <option value="none">ì´‰ë§¤ ì—†ìŒ (ëŒ€ì¡°êµ°)</option>
                    <option value="potato">ê°ì ì¡°ê° (ì¹´íƒˆë ˆì´ìŠ¤ - ìƒì²´ ì •ì´‰ë§¤)</option>
                    <option value="ki">ì•„ì´ì˜¤ë”˜í™” ì¹¼ë¥¨ (KI - ë¬´ê¸° ì •ì´‰ë§¤)</option>
                    <option value="acid">ì¸ì‚° (ë¶€ì´‰ë§¤)</option>
                </select>
            </div>
            <div class="control-group">
                <label>í˜„ì¬ ìƒíƒœ</label>
                <div id="status-text" style="color: var(--primary-color); font-weight:bold;">ì¤€ë¹„ë¨</div>
            </div>
            <button class="btn-start" onclick="startExperiment()">ì‹¤í—˜ ì‹œì‘ â–¶</button>
            <button class="btn-reset" onclick="resetExperiment()">ì´ˆê¸°í™” â†º</button>
            
            <div class="result-box" id="feedback-box">
                <strong>ğŸ’¡ ì‹¤í—˜ ë¶„ì„:</strong>
                <p id="feedback-text"></p>
            </div>
        </div>

        <div class="panel" style="flex: 1.5;">
            <h3>ğŸ‘€ ì‹¤í—˜ ê´€ì°° (ì‹œí—˜ê´€)</h3>
            <div class="visualization-area" id="vis-area">
                <div class="test-tube">
                    <div class="liquid" id="liquid"></div>
                    <div class="foam" id="foam"></div>
                    </div>
            </div>
            <div style="text-align: center; margin-top: 10px; font-size: 0.9em; color: #666;">
                â–² ë°œìƒí•œ ì‚°ì†Œ ê±°í’ˆì˜ ë†’ì´
            </div>
        </div>

        <div class="panel">
            <h3>ğŸ“ˆ ê²°ê³¼ ê·¸ë˜í”„ (ì‹œê°„ vs ê±°í’ˆ ë†’ì´)</h3>
            <canvas id="chartCanvas"></canvas>
            
            <div class="quiz-section" id="quiz-section">
                <h4>ğŸ§  ê°œë… í€´ì¦ˆ</h4>
                <p id="quiz-question"></p>
                <div id="quiz-options"></div>
                <p id="quiz-feedback" style="margin-top:10px; font-weight:bold;"></p>
            </div>
        </div>
    </div>

    <script>
        // ë³€ìˆ˜ ì„¤ì •
        let timer = null;
        let time = 0;
        let foamHeight = 0;
        let isRunning = false;
        const maxTime = 20; // ì‹¤í—˜ ì‹œê°„ (ì´ˆ)
        const canvas = document.getElementById('chartCanvas');
        const ctx = canvas.getContext('2d');
        
        // ì´‰ë§¤ë³„ ë°˜ì‘ ì†ë„ ë°ì´í„° (ê°€ìƒ ê³„ìˆ˜)
        const catalysts = {
            'none': { rate: 0.2, name: 'ì´‰ë§¤ ì—†ìŒ', type: 'none', desc: 'ë°˜ì‘ì´ ë§¤ìš° ëŠë¦¬ê²Œ ì¼ì–´ë‚©ë‹ˆë‹¤.' },
            'potato': { rate: 2.5, name: 'ê°ì(ì¹´íƒˆë ˆì´ìŠ¤)', type: 'positive', desc: 'íš¨ì†Œ(ìƒì²´ ì´‰ë§¤)ì— ì˜í•´ ê±°í’ˆì´ ë¹ ë¥´ê²Œ ë°œìƒí•©ë‹ˆë‹¤.' },
            'ki': { rate: 4.5, name: 'ì•„ì´ì˜¤ë”˜í™” ì¹¼ë¥¨(KI)', type: 'positive', desc: 'ë¬´ê¸° ì •ì´‰ë§¤ë¡œ ì¸í•´ ë§¤ìš° ê²©ë ¬í•˜ê²Œ ë°˜ì‘í•©ë‹ˆë‹¤.' },
            'acid': { rate: 0.05, name: 'ì¸ì‚°', type: 'negative', desc: 'ë¶€ì´‰ë§¤ë¡œ ì¸í•´ ë°˜ì‘ ì†ë„ê°€ ëŠë ¤ì§‘ë‹ˆë‹¤.' }
        };

        let currentData = []; // ê·¸ë˜í”„ìš© ë°ì´í„°

        // ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
        function initChart() {
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ì¶• ê·¸ë¦¬ê¸°
            ctx.beginPath();
            ctx.moveTo(30, 10);
            ctx.lineTo(30, canvas.height - 20); // Yì¶•
            ctx.lineTo(canvas.width - 10, canvas.height - 20); // Xì¶•
            ctx.strokeStyle = '#333';
            ctx.stroke();
            
            ctx.fillStyle = '#666';
            ctx.font = '10px Arial';
            ctx.fillText("0", 15, canvas.height - 15);
            ctx.fillText("ì‹œê°„(s)", canvas.width - 40, canvas.height - 5);
            ctx.fillText("ë†’ì´", 5, 20);
        }

        initChart();

        function startExperiment() {
            if (isRunning) return;
            
            const type = document.getElementById('catalyst-select').value;
            const config = catalysts[type];
            
            isRunning = true;
            document.getElementById('status-text').innerText = "ë°˜ì‘ ì§„í–‰ ì¤‘...";
            document.getElementById('feedback-box').style.display = "none";
            document.getElementById('quiz-section').style.display = "none";
            
            // ê±°í’ˆ íŒŒí‹°í´ íš¨ê³¼ ì‹œì‘
            if (config.rate > 0.1) startBubbles(config.rate);

            timer = setInterval(() => {
                time += 0.5;
                
                // ë°˜ì‘ ì†ë„ì— ë”°ë¥¸ ë†’ì´ ê³„ì‚° (ë‹¨ìˆœ ì„ í˜• + ì•½ê°„ì˜ ëœë¤ì„±)
                let increment = config.rate * 2; 
                foamHeight += increment;
                
                if (foamHeight > 180) foamHeight = 180; // ìµœëŒ€ ë†’ì´ ì œí•œ
                if (time >= maxTime) {
                    endExperiment(config);
                }

                updateVisuals(foamHeight);
                drawGraph(time, foamHeight);

            }, 500); // 0.5ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸
        }

        function updateVisuals(height) {
            const foam = document.getElementById('foam');
            foam.style.height = height + 'px';
        }

        function drawGraph(t, h) {
            // ë°ì´í„° ì €ì¥
            currentData.push({t: t, h: h});

            // ìŠ¤ì¼€ì¼ë§
            const xScale = (canvas.width - 40) / maxTime;
            const yScale = (canvas.height - 30) / 200; // ìµœëŒ€ ë†’ì´ 200 ê¸°ì¤€

            ctx.beginPath();
            ctx.strokeStyle = '#E74C3C';
            ctx.lineWidth = 2;

            if (currentData.length > 1) {
                const prev = currentData[currentData.length - 2];
                const curr = currentData[currentData.length - 1];
                
                ctx.moveTo(30 + prev.t * xScale, canvas.height - 20 - prev.h * yScale);
                ctx.lineTo(30 + curr.t * xScale, canvas.height - 20 - curr.h * yScale);
                ctx.stroke();
            }
        }

        function startBubbles(rate) {
            const tube = document.querySelector('.test-tube');
            const particleInterval = 1000 / (rate * 5); // ì†ë„ì— ë”°ë¼ ìƒì„± ë¹ˆë„ ì¡°ì ˆ
            
            const createBubble = setInterval(() => {
                if (!isRunning) {
                    clearInterval(createBubble);
                    return;
                }
                const bubble = document.createElement('div');
                bubble.className = 'particle';
                bubble.style.left = Math.random() * 60 + 10 + 'px';
                bubble.style.width = Math.random() * 5 + 3 + 'px';
                bubble.style.height = bubble.style.width;
                tube.appendChild(bubble);

                // ì• ë‹ˆë©”ì´ì…˜ ëë‚˜ë©´ ì œê±°
                setTimeout(() => { bubble.remove(); }, 2000);
            }, particleInterval);
        }

        function endExperiment(config) {
            clearInterval(timer);
            isRunning = false;
            document.getElementById('status-text').innerText = "ë°˜ì‘ ì¢…ë£Œ";
            
            // í”¼ë“œë°± í‘œì‹œ
            const fbBox = document.getElementById('feedback-box');
            const fbText = document.getElementById('feedback-text');
            fbBox.style.display = 'block';
            fbText.innerHTML = `ì„ íƒí•œ <b>${config.name}</b>: ${config.desc}<br>í™œì„±í™” ì—ë„ˆì§€ê°€ ${config.type === 'positive' ? 'ë‚®ì•„ì ¸' : (config.type === 'negative' ? 'ë†’ì•„ì ¸' : 'ë³€í•˜ì§€ ì•Šì•„')} ë°˜ì‘ ì†ë„ê°€ ${config.type === 'positive' ? 'ë¹¨ë¼ì¡ŒìŠµë‹ˆë‹¤' : (config.type === 'negative' ? 'ëŠë ¤ì¡ŒìŠµë‹ˆë‹¤' : 'ì¼ì •í•©ë‹ˆë‹¤')}.`;

            // í€´ì¦ˆ í‘œì‹œ
            showQuiz(config.type);
        }

        function resetExperiment() {
            clearInterval(timer);
            isRunning = false;
            time = 0;
            foamHeight = 0;
            currentData = [];
            
            document.getElementById('foam').style.height = '0px';
            document.getElementById('status-text').innerText = "ì¤€ë¹„ë¨";
            document.getElementById('feedback-box').style.display = "none";
            document.getElementById('quiz-section').style.display = "none";
            
            // ìº”ë²„ìŠ¤ í´ë¦¬ì–´
            initChart();
            
            // ì”ì—¬ ë²„ë¸” ì œê±°
            document.querySelectorAll('.particle').forEach(e => e.remove());
        }

        function showQuiz(type) {
            const quizSec = document.getElementById('quiz-section');
            const qTitle = document.getElementById('quiz-question');
            const qOptions = document.getElementById('quiz-options');
            const qFeed = document.getElementById('quiz-feedback');
            
            quizSec.style.display = 'block';
            qOptions.innerHTML = '';
            qFeed.innerText = '';

            let qData = {};
            if (type === 'positive') {
                qData = {
                    q: "ì´ ì´‰ë§¤ëŠ” í™œì„±í™” ì—ë„ˆì§€($E_a$)ë¥¼ ì–´ë–»ê²Œ ë³€í™”ì‹œì¼°ë‚˜ìš”?",
                    opts: ["ì¦ê°€ì‹œì¼°ë‹¤", "ê°ì†Œì‹œì¼°ë‹¤", "ë³€í™” ì—†ë‹¤"],
                    ans: 1
                };
            } else if (type === 'negative') {
                qData = {
                    q: "ì¸ì‚°ì„ ë„£ì—ˆì„ ë•Œ ë°˜ì‘ ì†ë„ê°€ ëŠë ¤ì§„ ì´ìœ ëŠ”?",
                    opts: ["í™œì„±í™” ì—ë„ˆì§€ê°€ ë‚®ì•„ì ¸ì„œ", "í™œì„±í™” ì—ë„ˆì§€ê°€ ë†’ì•„ì ¸ì„œ", "ë°˜ì‘ì—´ì´ ê°ì†Œí•´ì„œ"],
                    ans: 1
                };
            } else {
                qData = {
                    q: "ì´‰ë§¤ê°€ ì—†ì„ ë•Œ ë°˜ì‘ì´ ëŠë¦° ì£¼ëœ ì´ìœ ëŠ”?",
                    opts: ["í™œì„±í™” ì—ë„ˆì§€ê°€ ë„ˆë¬´ ë†’ì•„ì„œ", "ë°˜ì‘ì—´ì´ í¡ì—´ ë°˜ì‘ì´ë¼ì„œ", "ê³¼ì‚°í™”ìˆ˜ì†Œ ë†ë„ê°€ ë‚®ì•„ì„œ"],
                    ans: 0
                };
            }

            qTitle.innerText = "Q. " + qData.q;
            
            qData.opts.forEach((opt, idx) => {
                const btn = document.createElement('div');
                btn.className = 'quiz-option';
                btn.innerText = (idx+1) + ". " + opt;
                btn.onclick = () => {
                    if (idx === qData.ans) {
                        btn.classList.add('correct');
                        qFeed.innerText = "ì •ë‹µì…ë‹ˆë‹¤! ğŸ‰ ì •ì´‰ë§¤ëŠ” í™œì„±í™” ì—ë„ˆì§€ë¥¼ ë‚®ì¶¥ë‹ˆë‹¤.";
                        qFeed.style.color = "green";
                    } else {
                        btn.classList.add('wrong');
                        qFeed.innerText = "ë‹¤ì‹œ ìƒê°í•´ ë³´ì„¸ìš”. ğŸ¤”";
                        qFeed.style.color = "red";
                    }
                };
                qOptions.appendChild(btn);
            });
        }
    </script>
</body>
</html>