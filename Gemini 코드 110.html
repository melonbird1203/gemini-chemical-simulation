<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°€ìƒ ì‹¤í—˜: ë§ˆê·¸ë„¤ìŠ˜ì˜ ì—°ì†Œì™€ ì‚°í™”Â·í™˜ì›</title>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; background-color: #f0f4f8; margin: 0; padding: 20px; color: #333; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #2c3e50; }
        .lab-bench { display: flex; flex-wrap: wrap; gap: 20px; margin-top: 20px; }
        
        /* Controls */
        .controls { flex: 1; background: #e8f4fd; padding: 20px; border-radius: 10px; min-width: 250px; }
        .control-group { margin-bottom: 15px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; }
        input[type="range"], select { width: 100%; padding: 5px; }
        button { width: 100%; padding: 12px; background-color: #3498db; color: white; border: none; border-radius: 5px; font-size: 16px; cursor: pointer; transition: 0.3s; }
        button:hover { background-color: #2980b9; }
        button:disabled { background-color: #bdc3c7; cursor: not-allowed; }
        .reset-btn { background-color: #e74c3c; margin-top: 10px; }
        .reset-btn:hover { background-color: #c0392b; }

        /* Visualization Area */
        .display-area { flex: 2; display: flex; flex-direction: column; gap: 15px; min-width: 300px; }
        .macro-view { height: 200px; background: #333; border-radius: 10px; position: relative; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        .micro-view { height: 250px; background: #2c3e50; border-radius: 10px; position: relative; color: white; padding: 10px; }
        
        /* Animation Elements */
        #mg-ribbon { width: 100px; height: 10px; background: silver; position: absolute; bottom: 20px; transition: width 0.3s; }
        #flame { width: 0; height: 0; background: radial-gradient(circle, white 40%, rgba(255,255,255,0.5) 80%, transparent 100%); position: absolute; bottom: 25px; border-radius: 50%; box-shadow: 0 0 20px 10px rgba(255,255,255,0.8); opacity: 0; transition: opacity 0.2s; }
        .ash { background: #ecf0f1 !important; } /* White MgO ash */

        /* Micro View Elements */
        .particle-container { position: relative; width: 100%; height: 100%; }
        .atom { width: 40px; height: 40px; border-radius: 50%; display: flex; justify-content: center; align-items: center; position: absolute; font-weight: bold; font-size: 14px; border: 2px solid white; transition: all 1s; }
        .mg-atom { background: #95a5a6; left: 20%; top: 40%; color: black; }
        .o-atom { background: #e74c3c; right: 20%; top: 40%; }
        .electron { width: 10px; height: 10px; background: yellow; border-radius: 50%; position: absolute; box-shadow: 0 0 5px yellow; display: none; }
        
        /* Info & Quiz */
        .info-panel { background: #fff3cd; padding: 15px; border-radius: 10px; margin-top: 20px; border-left: 5px solid #ffc107; }
        .quiz-section { margin-top: 20px; padding: 20px; background: #fdfefe; border: 1px solid #ddd; border-radius: 10px; display: none; }
        .quiz-options button { width: auto; margin: 5px; background: #95a5a6; }
        .quiz-options button.selected { background: #3498db; }
        .feedback { margin-top: 10px; font-weight: bold; }
        .correct { color: #27ae60; }
        .wrong { color: #e74c3c; }

        /* Oxidation Number Display */
        .ox-number { position: absolute; top: -20px; width: 100%; text-align: center; color: yellow; font-size: 12px; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ”¥ ë§ˆê·¸ë„¤ìŠ˜ì˜ ì—°ì†Œì™€ ì‚°í™”Â·í™˜ì›</h1>
    <p>ì„¤ì •ê°’ì„ ì¡°ì ˆí•˜ê³  <strong>ì í™”</strong> ë²„íŠ¼ì„ ëˆŒëŸ¬ ì‚°í™”Â·í™˜ì› ë°˜ì‘ì„ ê´€ì°°í•˜ì„¸ìš”.</p>

    <div class="lab-bench">
        <div class="controls">
            <h3>ğŸ›ï¸ ì‹¤í—˜ ì¡°ê±´ ì„¤ì •</h3>
            <div class="control-group">
                <label for="mgLength">ë§ˆê·¸ë„¤ìŠ˜ ë¦¬ë³¸ ê¸¸ì´ (cm)</label>
                <select id="mgLength">
                    <option value="5">5 cm</option>
                    <option value="10" selected>10 cm</option>
                    <option value="15">15 cm</option>
                </select>
            </div>
            <div class="control-group">
                <label for="oxygenLevel">ì‚°ì†Œ ë†ë„ (%) : <span id="oxVal">21</span>%</label>
                <input type="range" id="oxygenLevel" min="10" max="100" value="21" step="1">
            </div>
            <button id="igniteBtn" onclick="startExperiment()">ğŸ”¥ ì í™” (ë°˜ì‘ ì‹œì‘)</button>
            <button class="reset-btn" onclick="resetExperiment()">ğŸ”„ ì‹¤í—˜ ì´ˆê¸°í™”</button>
        </div>

        <div class="display-area">
            <div class="macro-view">
                <div style="color: white; position: absolute; top: 10px; left: 10px;">ê±°ì‹œì  ê´€ì°° (ì‹¤ì œ ëª¨ìŠµ)</div>
                <div id="mg-ribbon"></div>
                <div id="flame"></div>
            </div>

            <div class="micro-view">
                <div style="position: absolute; top: 10px; left: 10px;">ë¯¸ì‹œì  ê´€ì°° (ì „ì ì´ë™ ëª¨í˜•)</div>
                <div class="particle-container" id="microScene">
                    </div>
                <div style="position: absolute; bottom: 10px; width: 100%; text-align: center;">
                    <span id="reaction-eq" style="font-size: 1.2em;">2Mg + Oâ‚‚ â†’ ???</span>
                </div>
            </div>
        </div>
    </div>

    <div class="info-panel" id="statusPanel">
        ì¤€ë¹„ ìƒíƒœ: ë§ˆê·¸ë„¤ìŠ˜ ë¦¬ë³¸ê³¼ ì‚°ì†Œê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤. ì í™” ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.
    </div>

    <div class="quiz-section" id="quizSection">
        <h3>ğŸ“ ê°œë… í™•ì¸ í€´ì¦ˆ</h3>
        <p>1. ì´ ë°˜ì‘ì—ì„œ <strong>ì‚°í™”ëœ ë¬¼ì§ˆ</strong>ì€ ë¬´ì—‡ì…ë‹ˆê¹Œ?</p>
        <div class="quiz-options">
            <button onclick="checkAnswer('Mg')">ë§ˆê·¸ë„¤ìŠ˜ (Mg)</button>
            <button onclick="checkAnswer('O2')">ì‚°ì†Œ (Oâ‚‚)</button>
            <button onclick="checkAnswer('MgO')">ì‚°í™”ë§ˆê·¸ë„¤ìŠ˜ (MgO)</button>
        </div>
        <p>2. ë§ˆê·¸ë„¤ìŠ˜ì˜ ì‚°í™”ìˆ˜ëŠ” ì–´ë–»ê²Œ ë³€í–ˆìŠµë‹ˆê¹Œ?</p>
        <div class="quiz-options">
            <button onclick="checkOxAnswer(0, -2)">0 ì—ì„œ -2</button>
            <button onclick="checkOxAnswer(0, 2)">0 ì—ì„œ +2</button>
            <button onclick="checkOxAnswer(2, 0)">+2 ì—ì„œ 0</button>
        </div>
        <div class="feedback" id="quizFeedback"></div>
    </div>
</div>

<script>
    const oxRange = document.getElementById('oxygenLevel');
    const oxVal = document.getElementById('oxVal');
    const igniteBtn = document.getElementById('igniteBtn');
    const mgRibbon = document.getElementById('mg-ribbon');
    const flame = document.getElementById('flame');
    const microScene = document.getElementById('microScene');
    const statusPanel = document.getElementById('statusPanel');
    const quizSection = document.getElementById('quizSection');
    const reactionEq = document.getElementById('reaction-eq');

    let isBurned = false;

    // Initialize Micro View
    function initMicroView() {
        microScene.innerHTML = `
            <div class="atom mg-atom" id="atomMg">
                <span class="ox-number">0</span>Mg
            </div>
            <div class="atom o-atom" id="atomO">
                <span class="ox-number">0</span>O
            </div>
            <div class="electron" id="elec1"></div>
            <div class="electron" id="elec2"></div>
        `;
    }
    initMicroView();

    oxRange.addEventListener('input', (e) => {
        oxVal.innerText = e.target.value;
    });

    function startExperiment() {
        if(isBurned) return;
        
        igniteBtn.disabled = true;
        oxRange.disabled = true;
        document.getElementById('mgLength').disabled = true;

        const oxygen = parseInt(oxRange.value);
        const length = parseInt(document.getElementById('mgLength').value);
        
        // Simulation Logic
        statusPanel.innerText = `ë°˜ì‘ ì¤‘... (ì‚°ì†Œ ë†ë„: ${oxygen}%) - ê²©ë ¬í•œ ë¹›ê³¼ ì—´ì´ ë°œìƒí•©ë‹ˆë‹¤!`;
        
        // Flame effect intensity based on Oxygen
        let brightness = 0.5 + (oxygen / 200); 
        let duration = (length * 100) + 1000; // burning time based on length

        flame.style.width = '120px';
        flame.style.height = '120px';
        flame.style.opacity = brightness;
        flame.style.boxShadow = `0 0 ${40 + oxygen}px ${20 + oxygen/2}px rgba(255,255,255,0.9)`;

        // Electron Animation Trigger
        animateElectrons();

        setTimeout(() => {
            finishExperiment();
        }, duration); // Burn duration
    }

    function animateElectrons() {
        const e1 = document.getElementById('elec1');
        const e2 = document.getElementById('elec2');
        const mg = document.getElementById('atomMg');
        const o = document.getElementById('atomO');

        e1.style.display = 'block';
        e2.style.display = 'block';
        
        // Start positions (from Mg)
        e1.style.left = '25%'; e1.style.top = '45%';
        e2.style.left = '25%'; e2.style.top = '55%';

        // Animate to O
        setTimeout(() => {
            e1.style.transition = 'all 1.5s ease-in-out';
            e2.style.transition = 'all 1.5s ease-in-out';
            e1.style.left = '75%';
            e2.style.left = '75%';
        }, 100);

        setTimeout(() => {
            // Change Atoms to Ions
            mg.innerHTML = '<span class="ox-number" style="color:red">+2</span>MgÂ²âº';
            mg.style.background = '#bdc3c7'; // lighter grey
            
            o.innerHTML = '<span class="ox-number" style="color:red">-2</span>OÂ²â»';
            o.style.border = '2px dashed yellow'; // satisfied shell visual cue
            
            // Move atoms together to form MgO
            mg.style.left = '40%';
            o.style.right = '40%';
            
            e1.style.display = 'none';
            e2.style.display = 'none';

            reactionEq.innerHTML = "2Mg + Oâ‚‚ â†’ <strong style='color:#f39c12'>2MgO</strong> (ì‚°í™”ë§ˆê·¸ë„¤ìŠ˜)";
        }, 1600);
    }

    function finishExperiment() {
        flame.style.opacity = 0;
        flame.style.width = 0;
        flame.style.height = 0;
        mgRibbon.classList.add('ash'); // Turn into white ash
        
        statusPanel.innerHTML = "<strong>ë°˜ì‘ ì™„ë£Œ!</strong> ì€ë°±ìƒ‰ì˜ ë§ˆê·¸ë„¤ìŠ˜ì´ íƒ€ì„œ 'í°ìƒ‰ ê°€ë£¨(ì‚°í™”ë§ˆê·¸ë„¤ìŠ˜)'ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.<br>ì•„ë˜ í€´ì¦ˆë¥¼ í’€ì–´ë³´ì„¸ìš”.";
        isBurned = true;
        quizSection.style.display = 'block';
    }

    function resetExperiment() {
        isBurned = false;
        igniteBtn.disabled = false;
        oxRange.disabled = false;
        document.getElementById('mgLength').disabled = false;
        
        mgRibbon.classList.remove('ash');
        quizSection.style.display = 'none';
        document.getElementById('quizFeedback').innerText = "";
        reactionEq.innerHTML = "2Mg + Oâ‚‚ â†’ ???";
        statusPanel.innerText = "ì¤€ë¹„ ìƒíƒœ: ë§ˆê·¸ë„¤ìŠ˜ ë¦¬ë³¸ê³¼ ì‚°ì†Œê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤. ì í™” ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.";
        
        initMicroView();
    }

    function checkAnswer(ans) {
        const feedback = document.getElementById('quizFeedback');
        if (ans === 'Mg') {
            feedback.innerHTML = "<span class='correct'>ì •ë‹µì…ë‹ˆë‹¤!</span> ë§ˆê·¸ë„¤ìŠ˜(Mg)ì€ ì‚°ì†Œì™€ ê²°í•©í•˜ë©° ì „ìë¥¼ ìƒì—ˆìœ¼ë¯€ë¡œ <strong>ì‚°í™”</strong>ë˜ì—ˆìŠµë‹ˆë‹¤.";
        } else if (ans === 'O2') {
            feedback.innerHTML = "<span class='wrong'>í‹€ë ¸ìŠµë‹ˆë‹¤.</span> ì‚°ì†Œ(Oâ‚‚)ëŠ” ì „ìë¥¼ ì–»ì–´ í™˜ì›ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”!";
        } else {
            feedback.innerHTML = "<span class='wrong'>í‹€ë ¸ìŠµë‹ˆë‹¤.</span> ì‚°í™”ë§ˆê·¸ë„¤ìŠ˜(MgO)ì€ ìƒì„±ë¬¼ì…ë‹ˆë‹¤.";
        }
    }

    function checkOxAnswer(before, after) {
        const feedback = document.getElementById('quizFeedback');
        if (before === 0 && after === 2) {
             feedback.innerHTML += "<br><br><span class='correct'>ì •ë‹µì…ë‹ˆë‹¤!</span> í™‘ì›ì†Œ ë¬¼ì§ˆì¸ Mgì˜ ì‚°í™”ìˆ˜ëŠ” 0ì´ì—ˆìœ¼ë‚˜, ì „ìë¥¼ 2ê°œ ìƒê³  +2ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.";
        } else {
             feedback.innerHTML += "<br><br><span class='wrong'>í‹€ë ¸ìŠµë‹ˆë‹¤.</span> ë§ˆê·¸ë„¤ìŠ˜ì€ 2ì¡± ì›ì†Œë¡œ ì „ìë¥¼ 2ê°œ ìƒëŠ” ê²½í–¥ì´ ìˆìŠµë‹ˆë‹¤.";
        }
    }
</script>

</body>
</html>