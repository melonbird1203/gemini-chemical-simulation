<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¤‘2 ê³¼í•™: ì›ì†Œì˜ ë¶ˆê½ƒ ë°˜ì‘ ê°€ìƒ ì‹¤í—˜ì‹¤</title>
    <style>
        :root {
            --bg-color: #1a1a2e;
            --panel-color: #16213e;
            --text-color: #e94560;
            --accent-color: #0f3460;
            --white: #ffffff;
        }
        body {
            font-family: 'Malgun Gothic', sans-serif;
            background-color: var(--bg-color);
            color: var(--white);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        header {
            width: 100%;
            background-color: var(--panel-color);
            padding: 1rem;
            text-align: center;
            border-bottom: 3px solid var(--text-color);
        }
        h1 { margin: 0; font-size: 1.5rem; }
        .subtitle { font-size: 0.9rem; color: #ccc; margin-top: 5px; }

        /* Main Layout */
        .container {
            display: flex;
            flex-wrap: wrap;
            width: 95%;
            max-width: 1200px;
            margin-top: 20px;
            gap: 20px;
            justify-content: center;
        }

        /* Control Panel */
        .panel {
            background-color: var(--panel-color);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        .controls { flex: 1; min-width: 250px; }
        .experiment-stage { flex: 2; min-width: 300px; display: flex; flex-direction: column; align-items: center; position: relative; min-height: 400px; }
        .concept-view { flex: 1; min-width: 250px; }

        h2 { border-bottom: 2px solid var(--text-color); padding-bottom: 5px; font-size: 1.2rem; }

        /* Sample Buttons */
        .sample-btn {
            display: block;
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: 0.3s;
            text-align: left;
            font-size: 1rem;
        }
        .sample-btn:hover { background-color: var(--text-color); }
        .sample-btn.active { background-color: var(--text-color); font-weight: bold; border-left: 5px solid white; }

        /* Bunsen Burner & Flame */
        .burner-base {
            width: 60px;
            height: 100px;
            background: linear-gradient(90deg, #555, #999, #555);
            position: absolute;
            bottom: 20px;
            border-radius: 5px;
        }
        .flame {
            width: 60px;
            height: 120px;
            background: rgba(0, 100, 255, 0.4);
            border-radius: 50% 50% 20% 20%;
            position: absolute;
            bottom: 120px;
            filter: blur(5px);
            animation: flicker 0.5s infinite alternate;
            transition: background 0.5s, box-shadow 0.5s;
            box-shadow: 0 0 20px rgba(0, 100, 255, 0.6);
            display: flex;
            justify-content: center;
            align-items: flex-end;
        }
        .flame-core {
            width: 20px;
            height: 40px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            filter: blur(2px);
        }

        @keyframes flicker {
            0% { transform: scale(1); opacity: 0.9; }
            100% { transform: scale(1.05) skewX(2deg); opacity: 1; }
        }

        /* Wire Loop */
        .wire-loop {
            width: 300px;
            height: 10px;
            background-color: silver;
            position: absolute;
            right: -300px; /* Start outside */
            bottom: 180px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            transition: right 1s ease-in-out;
        }
        .wire-tip {
            width: 20px;
            height: 20px;
            background-color: #ccc;
            border-radius: 50%;
            margin-left: 10px;
            border: 2px solid #999;
        }

        /* Micro View (Electron Model) */
        .atom-container {
            width: 200px;
            height: 200px;
            position: relative;
            margin: 20px auto;
            border-radius: 50%;
            border: 1px dashed rgba(255,255,255,0.3);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .nucleus { width: 30px; height: 30px; background: red; border-radius: 50%; z-index: 2; text-align: center; line-height: 30px; font-size: 0.8rem; font-weight: bold;}
        .shell {
            position: absolute;
            border: 1px solid rgba(255,255,255,0.5);
            border-radius: 50%;
        }
        .shell-1 { width: 80px; height: 80px; }
        .shell-2 { width: 160px; height: 160px; }
        
        .electron {
            width: 10px;
            height: 10px;
            background: cyan;
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.5s;
            box-shadow: 0 0 5px cyan;
        }

        /* Result Text */
        #result-display {
            margin-top: 20px;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            min-height: 60px;
            text-align: center;
        }
        .highlight { color: #ffeb3b; font-weight: bold; font-size: 1.2rem; }

        /* Quiz Mode */
        .quiz-mode-btn {
            background-color: #e94560;
            width: 100%;
            padding: 15px;
            color: white;
            font-weight: bold;
            border: none;
            cursor: pointer;
            margin-top: 20px;
            border-radius: 5px;
        }
        .quiz-feedback { margin-top: 10px; font-weight: bold; min-height: 24px; text-align: center;}
        
        .spectrum-bar {
            width: 100%;
            height: 30px;
            background: black;
            margin-top: 10px;
            position: relative;
            display: none;
        }
        .spectral-line {
            position: absolute;
            height: 100%;
            width: 4px;
            background: white;
            top: 0;
            box-shadow: 0 0 5px white;
        }

    </style>
</head>
<body>

<header>
    <h1>ğŸ§ª ì›ì†Œì˜ ë¶ˆê½ƒ ë°˜ì‘ ì‹¤í—˜ì‹¤</h1>
    <div class="subtitle">ì¤‘í•™êµ 2í•™ë…„ ê³¼í•™ > ë¬¼ì§ˆì˜ êµ¬ì„± > ì›ì†Œì˜ í™•ì¸</div>
</header>

<div class="container">
    <div class="panel controls">
        <h2>1. ì‹œë£Œ ì„ íƒ (Sample)</h2>
        <p style="font-size:0.9rem; color:#aaa;">ë‹ˆí¬ë¡¬ì„ ì— ë¬»í ì‹œë£Œë¥¼ ì„ íƒí•˜ì„¸ìš”.</p>
        <div id="sample-list">
            <button class="sample-btn" onclick="selectSample('Li', 'ë¦¬íŠ¬', '#ff0000', 'ë¹¨ê°„ìƒ‰')">1. ì—¼í™” ë¦¬íŠ¬ (LiCl)</button>
            <button class="sample-btn" onclick="selectSample('Na', 'ë‚˜íŠ¸ë¥¨', '#ffdd00', 'ë…¸ë€ìƒ‰')">2. ì—¼í™” ë‚˜íŠ¸ë¥¨ (NaCl)</button>
            <button class="sample-btn" onclick="selectSample('K', 'ì¹¼ë¥¨', '#b866ff', 'ë³´ë¼ìƒ‰')">3. ì§ˆì‚° ì¹¼ë¥¨ (KNOâ‚ƒ)</button>
            <button class="sample-btn" onclick="selectSample('Cu', 'êµ¬ë¦¬', '#00ffaa', 'ì²­ë¡ìƒ‰')">4. í™©ì‚° êµ¬ë¦¬ (CuSOâ‚„)</button>
            <button class="sample-btn" onclick="selectSample('Sr', 'ìŠ¤íŠ¸ë¡ íŠ¬', '#dc143c', 'ì§™ì€ ë¹¨ê°„ìƒ‰')">5. ì§ˆì‚° ìŠ¤íŠ¸ë¡ íŠ¬ (Sr(NOâ‚ƒ)â‚‚)</button>
        </div>

        <button class="quiz-mode-btn" onclick="startQuiz()">â“ ë¯¸ì§€ ì‹œë£Œ ë§ì¶”ê¸° (í€´ì¦ˆ)</button>
        <div id="quiz-options" style="display:none; margin-top:10px;">
            </div>
        <div class="quiz-feedback" id="quiz-feedback"></div>
    </div>

    <div class="panel experiment-stage">
        <h2>2. ê°€ìƒ ì‹¤í—˜ëŒ€</h2>
        
        <div id="result-display">
            ì‹œë£Œë¥¼ ì„ íƒí•˜ë©´ ì‹¤í—˜ì´ ì‹œì‘ë©ë‹ˆë‹¤.
        </div>

        <div class="flame" id="flame">
            <div class="flame-core"></div>
        </div>
        <div class="burner-base"></div>
        
        <div class="wire-loop" id="wire-loop">
            <div style="flex:1;"></div>
            <div class="wire-tip" id="wire-tip"></div>
        </div>
    </div>

    <div class="panel concept-view">
        <h2>3. ì›ë¦¬ íƒêµ¬ (Micro View)</h2>
        <p style="font-size:0.8rem; line-height:1.4;">
            ë¶ˆê½ƒì˜ ì—´ì—ë„ˆì§€ë¥¼ ë°›ìœ¼ë©´ ì „ìê°€ <span style="color:#ff6b6b">ë“¤ëœ¬ìƒíƒœ</span>ê°€ ë˜ê³ ,
            ë‹¤ì‹œ <span style="color:#4ecdc4">ë°”ë‹¥ìƒíƒœ</span>ë¡œ ëŒì•„ì˜¬ ë•Œ íŠ¹ìœ ì˜ ë¹›ì„ ëƒ…ë‹ˆë‹¤.
        </p>

        <div class="atom-container">
            <div class="shell shell-1"></div>
            <div class="shell shell-2"></div>
            <div class="nucleus" id="nucleus">Nucleus</div>
            <div class="electron" id="electron"></div>
        </div>

        <div id="energy-text" style="text-align:center; font-size:0.9rem; color:#aaa;">ìƒíƒœ: ëŒ€ê¸° ì¤‘</div>
        
        <div style="margin-top:20px;">
            <h3>ìŠ¤í™íŠ¸ëŸ¼ (ë¹›ì˜ íŒŒì¥)</h3>
            <div class="spectrum-bar" id="spectrum-bar">
                </div>
            <p id="spectrum-desc" style="font-size:0.8rem; color:#ccc; display:none;">
                * ë¦¬íŠ¬ê³¼ ìŠ¤íŠ¸ë¡ íŠ¬ì€ ëˆˆìœ¼ë¡œ ë³´ê¸°ì— ë¹„ìŠ·í•˜ì§€ë§Œ ìŠ¤í™íŠ¸ëŸ¼ì€ ë‹¤ë¦…ë‹ˆë‹¤.
            </p>
        </div>
    </div>
</div>

<script>
    let currentSample = null;
    let isQuizMode = false;
    let quizAnswer = null;

    const samples = {
        'Li': { name: 'ë¦¬íŠ¬', colorCode: 'rgba(255, 0, 0, 0.8)', glow: 'rgba(255, 0, 0, 1)', desc: 'ë¹¨ê°„ìƒ‰', lines: [10, 20, 80] },
        'Na': { name: 'ë‚˜íŠ¸ë¥¨', colorCode: 'rgba(255, 221, 0, 0.8)', glow: 'rgba(255, 221, 0, 1)', desc: 'ë…¸ë€ìƒ‰', lines: [45, 46] },
        'K': { name: 'ì¹¼ë¥¨', colorCode: 'rgba(184, 102, 255, 0.8)', glow: 'rgba(184, 102, 255, 1)', desc: 'ë³´ë¼ìƒ‰', lines: [5, 90] },
        'Cu': { name: 'êµ¬ë¦¬', colorCode: 'rgba(0, 255, 170, 0.8)', glow: 'rgba(0, 255, 170, 1)', desc: 'ì²­ë¡ìƒ‰', lines: [30, 35, 60] },
        'Sr': { name: 'ìŠ¤íŠ¸ë¡ íŠ¬', colorCode: 'rgba(220, 20, 60, 0.8)', glow: 'rgba(220, 20, 60, 1)', desc: 'ì§™ì€ ë¹¨ê°„ìƒ‰', lines: [15, 25, 75, 85] }
    };

    function resetExperiment() {
        const flame = document.getElementById('flame');
        const wireLoop = document.getElementById('wire-loop');
        const wireTip = document.getElementById('wire-tip');
        const resultText = document.getElementById('result-display');
        
        // ì´ˆê¸°í™”
        flame.style.background = 'rgba(0, 100, 255, 0.4)';
        flame.style.boxShadow = '0 0 20px rgba(0, 100, 255, 0.6)';
        wireLoop.style.right = '-300px';
        wireTip.style.backgroundColor = '#ccc';
        
        stopElectronAnimation();
        
        // ìŠ¤í™íŠ¸ëŸ¼ ìˆ¨ê¹€
        document.getElementById('spectrum-bar').style.display = 'none';
        document.getElementById('spectrum-desc').style.display = 'none';

        if(!isQuizMode) {
            resultText.innerHTML = "ì‹œë£Œë¥¼ ì„ íƒí•˜ì—¬ ì‹¤í—˜ì„ ì‹œì‘í•˜ì„¸ìš”.";
        }
    }

    function selectSample(code, name, hexColor, desc) {
        if(isQuizMode) return; // í€´ì¦ˆ ëª¨ë“œì¼ ë• ì‘ë™ ì•ˆ í•¨

        // ë²„íŠ¼ í™œì„±í™” ìŠ¤íƒ€ì¼
        document.querySelectorAll('.sample-btn').forEach(btn => btn.classList.remove('active'));
        event.target.classList.add('active');

        currentSample = samples[code];
        runExperiment(currentSample, false);
    }

    function runExperiment(sampleData, isHidden) {
        const wireLoop = document.getElementById('wire-loop');
        const wireTip = document.getElementById('wire-tip');
        const flame = document.getElementById('flame');
        const resultText = document.getElementById('result-display');
        const nucleus = document.getElementById('nucleus');

        // 1. ë‹ˆí¬ë¡¬ì„  ì´ë™ ì• ë‹ˆë©”ì´ì…˜
        wireTip.style.backgroundColor = '#fff'; // ì‹œë£Œ ë¬»ìŒ
        wireLoop.style.right = '50px'; // ë¶ˆê½ƒ ì¤‘ì•™ìœ¼ë¡œ ì´ë™

        resultText.innerHTML = "ê°€ì—´ ì¤‘... ë¶ˆê½ƒ ìƒ‰ ë³€í™”ë¥¼ ê´€ì°°í•˜ì„¸ìš”.";

        // 2. ë¶ˆê½ƒ ë°˜ì‘ (1ì´ˆ ë”œë ˆì´ í›„ ìƒ‰ ë³€í™”)
        setTimeout(() => {
            flame.style.background = sampleData.colorCode;
            flame.style.boxShadow = `0 0 40px ${sampleData.glow}`;
            
            if(!isHidden) {
                resultText.innerHTML = `ê²€ì¶œëœ ì›ì†Œ: <span class="highlight">${sampleData.name}</span><br>ë¶ˆê½ƒìƒ‰: <span class="highlight" style="color:${sampleData.glow}">${sampleData.desc}</span>`;
                nucleus.innerText = Object.keys(samples).find(key => samples[key] === sampleData);
                drawSpectrum(sampleData.lines, sampleData.glow);
            } else {
                resultText.innerHTML = `ì´ ë¶ˆê½ƒìƒ‰ì„ ë‚˜íƒ€ë‚´ëŠ” ì›ì†ŒëŠ” ë¬´ì—‡ì¼ê¹Œìš”?<br><span class="highlight" style="color:${sampleData.glow}">???</span>`;
                nucleus.innerText = "?";
            }

            // ì „ì ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
            animateElectron();

        }, 1000);

        // 3. ì‹¤í—˜ ì¢…ë£Œ (5ì´ˆ í›„ ë³µê·€)
        setTimeout(() => {
            if(!isQuizMode || isHidden) { // í€´ì¦ˆ ì¤‘ ì •ë‹µ ê³µê°œ ì „ì—ëŠ” ë¦¬ì…‹ ì•ˆí•¨
               // resetExperiment(); // ìë™ ë¦¬ì…‹ì„ ì›í•˜ë©´ ì£¼ì„ í•´ì œ
            }
        }, 6000);
    }

    // ì „ì ì „ì´ ì• ë‹ˆë©”ì´ì…˜
    function animateElectron() {
        const electron = document.getElementById('electron');
        const label = document.getElementById('energy-text');

        // ë°”ë‹¥ ìƒíƒœ (ì•ˆìª½ ê»ì§ˆ)
        electron.style.transform = 'translate(-50%, -50%) translate(40px, 0)'; 
        
        let cycle = 0;
        const interval = setInterval(() => {
            cycle++;
            if(cycle % 2 !== 0) {
                // ë“¤ëœ¬ ìƒíƒœ (ë°”ê¹¥ ê»ì§ˆë¡œ ì í”„ + ì—´ ì—ë„ˆì§€ í¡ìˆ˜)
                electron.style.transition = 'all 0.3s ease-out';
                electron.style.transform = 'translate(-50%, -50%) translate(80px, 0)'; 
                electron.style.background = 'white';
                label.innerHTML = "ğŸ”¥ ì—´ í¡ìˆ˜ â†’ <span style='color:#ff6b6b'>ë“¤ëœ¬ ìƒíƒœ</span> (ì—ë„ˆì§€â†‘)";
            } else {
                // ë°”ë‹¥ ìƒíƒœ ë³µê·€ (ë¹› ë°©ì¶œ)
                electron.style.transition = 'all 0.8s ease-in';
                electron.style.transform = 'translate(-50%, -50%) translate(40px, 0)';
                electron.style.background = currentSample ? currentSample.glow : 'cyan';
                label.innerHTML = "âœ¨ ë¹› ë°©ì¶œ â†’ <span style='color:#4ecdc4'>ë°”ë‹¥ ìƒíƒœ</span> (ì—ë„ˆì§€â†“)";
            }
        }, 1500);

        window.electronInterval = interval;
    }

    function stopElectronAnimation() {
        clearInterval(window.electronInterval);
        const electron = document.getElementById('electron');
        const label = document.getElementById('energy-text');
        electron.style.transform = 'translate(-50%, -50%) translate(40px, 0)'; // ë°”ë‹¥ìƒíƒœ ìœ„ì¹˜
        electron.style.background = 'cyan';
        label.innerText = "ìƒíƒœ: ëŒ€ê¸° ì¤‘";
    }

    // ìŠ¤í™íŠ¸ëŸ¼ ê·¸ë¦¬ê¸°
    function drawSpectrum(lines, color) {
        const bar = document.getElementById('spectrum-bar');
        const desc = document.getElementById('spectrum-desc');
        bar.style.display = 'block';
        desc.style.display = 'block';
        bar.innerHTML = ''; // ì´ˆê¸°í™”

        lines.forEach(pos => {
            const line = document.createElement('div');
            line.className = 'spectral-line';
            line.style.left = pos + '%';
            line.style.background = color;
            line.style.boxShadow = `0 0 5px ${color}`;
            bar.appendChild(line);
        });
    }

    // --- í€´ì¦ˆ ë¡œì§ ---
    function startQuiz() {
        resetExperiment();
        isQuizMode = true;
        document.getElementById('sample-list').style.display = 'none';
        document.getElementById('quiz-options').style.display = 'block';
        document.getElementById('quiz-feedback').innerText = "ì‹¤í—˜ëŒ€ ìœ„ ë¶ˆê½ƒìƒ‰ì„ ë³´ê³  ì›ì†Œë¥¼ ë§í˜€ë³´ì„¸ìš”!";

        // ëœë¤ ì‹œë£Œ ì„ ì •
        const keys = Object.keys(samples);
        const randomKey = keys[Math.floor(Math.random() * keys.length)];
        currentSample = samples[randomKey];
        quizAnswer = randomKey;

        // í€´ì¦ˆ ë³´ê¸° ë²„íŠ¼ ìƒì„±
        const quizContainer = document.getElementById('quiz-options');
        quizContainer.innerHTML = '';
        keys.forEach(key => {
            const btn = document.createElement('button');
            btn.className = 'sample-btn';
            btn.innerText = samples[key].name;
            btn.onclick = () => checkAnswer(key);
            quizContainer.appendChild(btn);
        });

        // ì‹¤í—˜ ì‹¤í–‰ (ì´ë¦„ ìˆ¨ê¹€)
        runExperiment(currentSample, true);
    }

    function checkAnswer(userKey) {
        const feedback = document.getElementById('quiz-feedback');
        const resultText = document.getElementById('result-display');

        if(userKey === quizAnswer) {
            feedback.innerHTML = "âœ… ì •ë‹µì…ë‹ˆë‹¤! ì°¸ ì˜í–ˆì–´ìš”.";
            feedback.style.color = "#4ecdc4";
            resultText.innerHTML = `ì •ë‹µ! ì´ ì›ì†ŒëŠ” <span class="highlight">${samples[quizAnswer].name}</span>ì…ë‹ˆë‹¤.`;
            
            // 2ì´ˆ í›„ ì¼ë°˜ ëª¨ë“œë¡œ ë³µê·€
            setTimeout(() => {
                endQuiz();
            }, 3000);
        } else {
            feedback.innerHTML = "âŒ ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”. ë¶ˆê½ƒìƒ‰ì„ ì˜ ê´€ì°°í•´ë³´ì„¸ìš”!";
            feedback.style.color = "#ff6b6b";
        }
    }

    function endQuiz() {
        isQuizMode = false;
        resetExperiment();
        document.getElementById('sample-list').style.display = 'block';
        document.getElementById('quiz-options').style.display = 'none';
        document.getElementById('quiz-feedback').innerText = "";
    }

</script>

</body>
</html>