<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ê°€ìƒ ì‹¤í—˜ì‹¤: ë³´ì¼ ë²•ì¹™ ì‹œë®¬ë ˆì´ì…˜</title>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; background-color: #f4f7f9; margin: 0; padding: 20px; color: #333; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #2c3e50; }
        .lab-bench { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; margin-top: 20px; }
        
        /* ì œì–´ íŒ¨ë„ */
        .controls { flex: 1; min-width: 300px; padding: 20px; background: #eef2f5; border-radius: 10px; }
        .slider-group { margin-bottom: 20px; }
        label { font-weight: bold; display: block; margin-bottom: 10px; }
        input[type=range] { width: 100%; cursor: pointer; }
        .data-display { background: white; padding: 10px; border-radius: 5px; margin-top: 10px; }
        .value-box { font-size: 1.2em; font-weight: bold; color: #2980b9; }

        /* ì‹œê°í™” íŒ¨ë„ */
        .visualization { flex: 1; min-width: 300px; text-align: center; }
        canvas { border: 2px solid #bdc3c7; background: #fff; border-radius: 5px; margin-bottom: 10px; }
        
        /* ë°ì´í„° í…Œì´ë¸” */
        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.9em; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        th { background-color: #34495e; color: white; }

        .note { font-size: 0.9em; color: #e74c3c; margin-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ”¬ ë³´ì¼ ë²•ì¹™ ê°€ìƒ ì‹¤í—˜ (Boyle's Law)</h1>
    <p style="text-align: center;">ìŠ¬ë¼ì´ë”ë¥¼ ì›€ì§ì—¬ í”¼ìŠ¤í†¤ì„ ëˆ„ë¥´ê³ (ì••ë ¥ ì¦ê°€), ì…ìì˜ ì›€ì§ì„ê³¼ ë¶€í”¼ ë³€í™”ë¥¼ ê´€ì°°í•˜ì„¸ìš”.</p>
    
    <div class="lab-bench">
        <div class="controls">
            <div class="slider-group">
                <label for="pressureRange">ê°€í•´ì§€ëŠ” ì••ë ¥ (ê¸°ì••, atm)</label>
                <input type="range" id="pressureRange" min="0.5" max="3.0" step="0.5" value="1.0">
                <div class="data-display">
                    í˜„ì¬ ì••ë ¥(P): <span id="pressureVal" class="value-box">1.0</span> ê¸°ì••
                </div>
            </div>

            <div class="data-display">
                ê¸°ì²´ì˜ ë¶€í”¼(V): <span id="volumeVal" class="value-box">60.0</span> mL
            </div>
            
            <div class="data-display" style="background-color: #fff3cd;">
                ë³´ì¼ ë²•ì¹™ ìƒìˆ˜ (P Ã— V): <span id="constantVal" class="value-box">60.0</span>
            </div>

            <p class="note">ğŸ“¢ íŒ: ì˜¨ë„ê°€ ì¼ì •í•  ë•Œ, ì…ìì˜ ì†ë ¥ì€ ë³€í•˜ì§€ ì•Šì§€ë§Œ ì¢ì€ ê³µê°„ì—ì„œ ë²½ë©´ì— ë” ìì£¼ ë¶€ë”ªí™ë‹ˆë‹¤!</p>

            <h3>ğŸ“Š ì‹¤í—˜ ë°ì´í„° ê¸°ë¡</h3>
            <table id="dataTable">
                <thead>
                    <tr>
                        <th>ì••ë ¥ (P)</th>
                        <th>ë¶€í”¼ (V)</th>
                        <th>P Ã— V</th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
        </div>

        <div class="visualization">
            <h3>ğŸ§ª ì…ì ëª¨í˜• ì‹œë®¬ë ˆì´ì…˜</h3>
            <canvas id="simCanvas" width="300" height="400"></canvas>
            <h3>ğŸ“ˆ P-V ê·¸ë˜í”„</h3>
            <canvas id="graphCanvas" width="300" height="200"></canvas>
        </div>
    </div>
</div>

<script>
    // ë³€ìˆ˜ ì„¤ì •
    const pressureSlider = document.getElementById('pressureRange');
    const pressureDisplay = document.getElementById('pressureVal');
    const volumeDisplay = document.getElementById('volumeVal');
    const constantDisplay = document.getElementById('constantVal');
    const dataTable = document.getElementById('dataTable').querySelector('tbody');
    
    const simCanvas = document.getElementById('simCanvas');
    const simCtx = simCanvas.getContext('2d');
    const graphCanvas = document.getElementById('graphCanvas');
    const graphCtx = graphCanvas.getContext('2d');

    const K = 60; // ë³´ì¼ ë²•ì¹™ ìƒìˆ˜ (P=1ì¼ ë•Œ V=60)
    let pressure = 1.0;
    let volume = 60.0;
    
    // ì…ì ì„¤ì • (20ê°œ)
    const particles = [];
    for(let i=0; i<30; i++) {
        particles.push({
            x: Math.random() * simCanvas.width,
            y: Math.random() * 300,
            vx: (Math.random() - 0.5) * 4,
            vy: (Math.random() - 0.5) * 4,
            radius: 4,
            color: '#e74c3c'
        });
    }

    // ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    function init() {
        updateSimulation();
        drawGraph();
        updateTable();
    }

    pressureSlider.addEventListener('input', (e) => {
        pressure = parseFloat(e.target.value);
        // ë³´ì¼ ë²•ì¹™: V = K / P
        volume = (K / pressure).toFixed(1);
        
        pressureDisplay.textContent = pressure.toFixed(1);
        volumeDisplay.textContent = volume;
        constantDisplay.textContent = (pressure * volume).toFixed(1);
        
        updateTable(); // ê°’ì´ ë°”ë€” ë•Œë§ˆë‹¤ í…Œì´ë¸” ì—…ë°ì´íŠ¸ (ì¤‘ë³µ ë°©ì§€ ë¡œì§ í•„ìš”ì‹œ ì¶”ê°€)
    });

    // ë°ì´í„° í…Œì´ë¸” ì—…ë°ì´íŠ¸ (ë‹¨ìˆœí™”: í˜„ì¬ ê°’ë§Œ í•˜ì´ë¼ì´íŠ¸í•˜ê±°ë‚˜ ëª©ë¡ì— ì¶”ê°€)
    // ì—¬ê¸°ì„œëŠ” ê¹”ë”í•˜ê²Œ í˜„ì¬ ìƒíƒœì— ëŒ€í•œ ì£¼ìš” ì§€ì ì„ ë¯¸ë¦¬ ë³´ì—¬ì£¼ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„
    function updateTable() {
        dataTable.innerHTML = ""; 
        const steps = [0.5, 1.0, 1.5, 2.0, 2.5, 3.0];
        
        steps.forEach(p => {
            let v = (K / p).toFixed(1);
            let pv = (p * v).toFixed(1);
            let row = document.createElement('tr');
            if (p === pressure) row.style.backgroundColor = "#dff9fb"; // í˜„ì¬ ì„ íƒëœ ê°’ ê°•ì¡°
            
            row.innerHTML = `<td>${p}</td><td>${v}</td><td>${pv}</td>`;
            dataTable.appendChild(row);
        });
    }

    // ì‹œë®¬ë ˆì´ì…˜ ë£¨í”„ (ì• ë‹ˆë©”ì´ì…˜)
    function animate() {
        updateSimulation();
        requestAnimationFrame(animate);
    }

    function updateSimulation() {
        simCtx.clearRect(0, 0, simCanvas.width, simCanvas.height);

        // 1. ì£¼ì‚¬ê¸° ê·¸ë¦¬ê¸°
        // ë¶€í”¼ 60mLë¥¼ í”½ì…€ ë†’ì´ 300pxë¡œ ë§¤í•‘í•œë‹¤ê³  ê°€ì • (ë¹„ë¡€ì‹)
        // ìµœëŒ€ ë¶€í”¼ 120 (0.5ê¸°ì••) -> ë†’ì´ 360px ì •ë„
        // í˜„ì¬ ë¶€í”¼ volumeì— ë¹„ë¡€í•˜ëŠ” í”½ì…€ ë†’ì´ ê³„ì‚°
        // V=60 -> H=200px (ê¸°ì¤€)
        const pistonHeight = volume * 3.33; // 60mL * 3.33 = 200px
        const cylinderBase = 380; // ë°”ë‹¥ ìœ„ì¹˜
        const pistonY = cylinderBase - pistonHeight;

        // ì‹¤ë¦°ë”
        simCtx.strokeStyle = "#34495e";
        simCtx.lineWidth = 5;
        simCtx.strokeRect(50, 20, 200, 360); // ì™¸ë²½

        // í”¼ìŠ¤í†¤ (ëˆ„ë¥´ëŠ” íŒ)
        simCtx.fillStyle = "#95a5a6";
        simCtx.fillRect(52, pistonY, 196, 20); 
        
        // í”¼ìŠ¤í†¤ ë§‰ëŒ€
        simCtx.fillStyle = "#7f8c8d";
        simCtx.fillRect(140, 20, 20, pistonY - 20);

        // ê¸°ì²´ ì˜ì—­ í‘œì‹œ
        simCtx.fillStyle = "rgba(52, 152, 219, 0.1)";
        simCtx.fillRect(52, pistonY + 20, 196, cylinderBase - (pistonY + 20));

        // 2. ì…ì ê·¸ë¦¬ê¸° ë° ì´ë™
        const bottomLimit = cylinderBase;
        const topLimit = pistonY + 20;

        particles.forEach(p => {
            // ìœ„ì¹˜ ì—…ë°ì´íŠ¸
            p.x += p.vx;
            p.y += p.vy;

            // ë²½ ì¶©ëŒ (Xì¶•)
            if (p.x <= 55 || p.x >= 245) p.vx *= -1;

            // í”¼ìŠ¤í†¤ ë° ë°”ë‹¥ ì¶©ëŒ (Yì¶•)
            // ì…ìê°€ í”¼ìŠ¤í†¤ ìœ„ë¡œ ì˜¬ë¼ê°”ë‹¤ë©´ ê°•ì œë¡œ ì•„ë˜ë¡œ ë‚´ë¦¼ (ì••ì¶• ì‹œ)
            if (p.y < topLimit) {
                p.y = topLimit + 2; 
                p.vy = Math.abs(p.vy); // ì•„ë˜ë¡œ íŠ•ê¹€
            }
            if (p.y > bottomLimit) {
                p.y = bottomLimit - 2;
                p.vy = -Math.abs(p.vy); // ìœ„ë¡œ íŠ•ê¹€
            }

            // ì…ì ê·¸ë¦¬ê¸°
            simCtx.beginPath();
            simCtx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
            simCtx.fillStyle = p.color;
            simCtx.fill();
        });
        
        drawGraph();
    }

    function drawGraph() {
        graphCtx.clearRect(0, 0, graphCanvas.width, graphCanvas.height);
        
        // ì¶• ê·¸ë¦¬ê¸°
        graphCtx.beginPath();
        graphCtx.moveTo(40, 10);
        graphCtx.lineTo(40, 180); // Yì¶• (ë¶€í”¼)
        graphCtx.lineTo(280, 180); // Xì¶• (ì••ë ¥)
        graphCtx.strokeStyle = "#333";
        graphCtx.lineWidth = 2;
        graphCtx.stroke();

        // ë¼ë²¨
        graphCtx.font = "12px Arial";
        graphCtx.fillStyle = "#333";
        graphCtx.fillText("V", 25, 20);
        graphCtx.fillText("P", 280, 195);

        // ê³¡ì„  ê·¸ë¦¬ê¸° (ì´ë¡ ê°’)
        graphCtx.beginPath();
        graphCtx.strokeStyle = "#e74c3c";
        graphCtx.lineWidth = 2;
        for (let x = 0.5; x <= 3.0; x += 0.1) {
            let plotX = 40 + (x - 0.5) * (240 / 2.5); // 0.5~3.0 ë§¤í•‘
            let plotY = 180 - ((K/x) / 120 * 160); // ë¶€í”¼ ìµœëŒ€ 120 ê¸°ì¤€
            if (x === 0.5) graphCtx.moveTo(plotX, plotY);
            else graphCtx.lineTo(plotX, plotY);
        }
        graphCtx.stroke();

        // í˜„ì¬ ìœ„ì¹˜ ì  ì°ê¸°
        let currentX = 40 + (pressure - 0.5) * (240 / 2.5);
        let currentY = 180 - (volume / 120 * 160);
        
        graphCtx.beginPath();
        graphCtx.arc(currentX, currentY, 5, 0, Math.PI * 2);
        graphCtx.fillStyle = "#2980b9";
        graphCtx.fill();
    }

    init();
    animate();
</script>

</body>
</html>