<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‹¤ë‹ˆì—˜ ì „ì§€ ê°€ìƒ ì‹¤í—˜ì‹¤</title>
    <style>
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #f5a623;
            --bg-color: #f0f4f8;
            --text-color: #333;
        }
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1 { margin-bottom: 10px; color: #2c3e50; }
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            max-width: 1000px;
            width: 100%;
        }
        
        /* ì‹¤í—˜ ì˜ì—­ */
        .lab-bench {
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 20px;
            position: relative;
            width: 600px;
            height: 400px;
            display: flex;
            justify-content: space-around;
            align-items: flex-end;
        }

        /* ë¹„ì»¤ ë° ìš©ì•¡ */
        .beaker {
            width: 150px;
            height: 200px;
            border: 3px solid #ccc;
            border-top: none;
            border-radius: 0 0 10px 10px;
            position: relative;
            background: rgba(255,255,255,0.5);
            overflow: hidden;
        }
        .solution {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 80%;
            transition: opacity 0.5s;
        }
        .zn-sol { background-color: rgba(200, 200, 200, 0.2); } /* íˆ¬ëª…/íšŒìƒ‰ */
        .cu-sol { background-color: rgba(0, 0, 255, 0.3); } /* í‘¸ë¥¸ìƒ‰ */

        /* ì „ê·¹ */
        .electrode {
            width: 40px;
            height: 160px;
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 5px;
            transition: all 0.5s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px black;
        }
        .zn-plate { background: linear-gradient(90deg, #999, #bbb); border: 1px solid #666; }
        .cu-plate { background: linear-gradient(90deg, #b87333, #d4986a); border: 1px solid #8b4513; }

        /* ì—¼ë‹¤ë¦¬ */
        .salt-bridge {
            position: absolute;
            top: 150px;
            left: 50%;
            transform: translateX(-50%);
            width: 180px;
            height: 60px;
            border: 10px solid rgba(255, 255, 255, 0.6);
            border-bottom: none;
            border-radius: 20px 20px 0 0;
            background: rgba(255, 255, 200, 0.5); /* KCl */
            z-index: 5;
            display: none; /* ì´ˆê¸°ì—” ìˆ¨ê¹€ */
        }
        .salt-bridge.active { display: block; }

        /* ë„ì„  ë° ì „ì••ê³„ */
        .wire-path {
            position: absolute;
            top: 50px;
            left: 125px; /* Zn center approx */
            width: 350px; /* Distance to Cu */
            height: 2px;
            background: #333;
            z-index: 10;
        }
        .voltmeter {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #222;
            color: #0f0;
            padding: 10px 20px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 1.5rem;
            border: 2px solid #555;
            width: 100px;
            text-align: center;
            z-index: 20;
        }

        /* ì „ì ì• ë‹ˆë©”ì´ì…˜ */
        .electron {
            width: 10px;
            height: 10px;
            background-color: #ffeb3b;
            border-radius: 50%;
            position: absolute;
            top: -4px;
            box-shadow: 0 0 5px yellow;
            display: none;
        }
        @keyframes flowRight {
            0% { left: 0; }
            100% { left: 100%; }
        }
        .flowing {
            display: block;
            animation: flowRight 2s linear infinite;
        }

        /* í…ìŠ¤íŠ¸ ë¼ë²¨ */
        .label {
            position: absolute;
            bottom: -30px;
            width: 100%;
            text-align: center;
            font-weight: bold;
        }
        
        /* ì œì–´ íŒ¨ë„ */
        .controls {
            background: white;
            padding: 20px;
            border-radius: 15px;
            width: 300px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .control-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input[type="range"] { width: 100%; }
        button {
            width: 100%;
            padding: 10px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            margin-bottom: 10px;
            transition: background 0.3s;
        }
        button:hover { background-color: #357abd; }
        button.reset { background-color: var(--secondary-color); }
        
        .feedback-box {
            margin-top: 10px;
            padding: 10px;
            background: #eef;
            border-left: 4px solid var(--primary-color);
            font-size: 0.9rem;
            min-height: 60px;
        }

        /* ë°˜ì‘ì‹ í‘œì‹œ */
        .reactions {
            position: absolute;
            top: 80px;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 50px;
            box-sizing: border-box;
            font-size: 0.8rem;
            color: #555;
            font-style: italic;
            pointer-events: none;
        }
    </style>
</head>
<body>

    <h1>ğŸ”‹ ë‹¤ë‹ˆì—˜ ì „ì§€ ê°€ìƒ ì‹¤í—˜</h1>

    <div class="container">
        <div class="lab-bench">
            <div class="voltmeter" id="voltmeter">0.00 V</div>
            
            <div class="wire-path">
                <div class="electron" id="electron1" style="animation-delay: 0s;"></div>
                <div class="electron" id="electron2" style="animation-delay: 0.6s;"></div>
                <div class="electron" id="electron3" style="animation-delay: 1.2s;"></div>
            </div>

            <div class="reactions">
                <div id="anode-rxn">(-)ê·¹: ì‚°í™”</div>
                <div id="cathode-rxn">(+)ê·¹: í™˜ì›</div>
            </div>

            <div class="salt-bridge" id="saltBridge"></div>

            <div class="beaker">
                <div class="solution zn-sol" id="znSolution"></div>
                <div class="electrode zn-plate" id="znPlate">Zn</div>
                <div class="label">ì•„ì—° ë°˜ìª½ ì „ì§€<br>(ZnSOâ‚„)</div>
            </div>

            <div class="beaker">
                <div class="solution cu-sol" id="cuSolution"></div>
                <div class="electrode cu-plate" id="cuPlate">Cu</div>
                <div class="label">êµ¬ë¦¬ ë°˜ìª½ ì „ì§€<br>(CuSOâ‚„)</div>
            </div>
        </div>

        <div class="controls">
            <div class="control-group">
                <label>ğŸ› ï¸ ì‹¤í—˜ ì„¤ì •</label>
                <button id="toggleSaltBridge">ì—¼ë‹¤ë¦¬ ì„¤ì¹˜/ì œê±°</button>
            </div>

            <div class="control-group">
                <label>ğŸ§ª ë†ë„ ì¡°ì ˆ (M)</label>
                <label for="znConc">ZnÂ²âº ë†ë„: <span id="znVal">1.0</span> M</label>
                <input type="range" id="znConc" min="0.1" max="2.0" step="0.1" value="1.0">
                
                <label for="cuConc" style="margin-top:10px;">CuÂ²âº ë†ë„: <span id="cuVal">1.0</span> M</label>
                <input type="range" id="cuConc" min="0.1" max="2.0" step="0.1" value="1.0">
            </div>

            <div class="control-group">
                <button id="startBtn">ì‹¤í—˜ ì‹œì‘ (ìŠ¤ìœ„ì¹˜ ON)</button>
                <button class="reset" id="resetBtn">ì´ˆê¸°í™”</button>
            </div>

            <div class="feedback-box" id="feedback">
                ì‹¤í—˜ ì¤€ë¹„ ì™„ë£Œ. ì—¼ë‹¤ë¦¬ë¥¼ ì„¤ì¹˜í•˜ê³  ë†ë„ë¥¼ ì„¤ì •í•œ ë’¤ ì‹œì‘í•˜ì„¸ìš”.
            </div>
        </div>
    </div>

    <script>
        // ë³€ìˆ˜ ì„¤ì •
        const STANDARD_VOLTAGE = 1.10; // 25ë„ì”¨ í‘œì¤€ ìƒíƒœ
        let isRunning = false;
        let hasSaltBridge = false;
        let znC = 1.0;
        let cuC = 1.0;
        let timer = null;

        // DOM ìš”ì†Œ
        const voltmeter = document.getElementById('voltmeter');
        const saltBridge = document.getElementById('saltBridge');
        const electrons = document.querySelectorAll('.electron');
        const znPlate = document.getElementById('znPlate');
        const cuPlate = document.getElementById('cuPlate');
        const feedback = document.getElementById('feedback');
        const cuSolution = document.getElementById('cuSolution');
        const anodeRxn = document.getElementById('anode-rxn');
        const cathodeRxn = document.getElementById('cathode-rxn');

        // ì´ˆê¸° ìƒíƒœ
        function init() {
            updateVoltageDisplay();
        }

        // ì „ì•• ê³„ì‚° (ë„¤ë¥¸ìŠ¤íŠ¸ ì‹ì˜ ë‹¨ìˆœí™”ëœ ì‹œë®¬ë ˆì´ì…˜ ì ìš©)
        // E = E0 - (0.0592/n) * log(Q)
        // Q = [Zn2+] / [Cu2+]
        function calculateVoltage() {
            if (!hasSaltBridge) return 0;
            
            // ë†ë„ê°€ 0ì— ê°€ê¹Œìš°ë©´ ë¡œê·¸ ì˜¤ë¥˜ ë°©ì§€
            let z = Math.max(znC, 0.001);
            let c = Math.max(cuC, 0.001);
            
            // ìƒìš©ë¡œê·¸ ì‚¬ìš©, n=2
            let voltage = STANDARD_VOLTAGE - (0.0592 / 2) * Math.log10(z / c);
            return Math.max(0, voltage); // ìŒìˆ˜ ì „ì•• ë°©ì§€ (ì—­ë°˜ì‘ ê³ ë ¤ X)
        }

        function updateVoltageDisplay() {
            const v = isRunning ? calculateVoltage() : 0;
            voltmeter.innerText = v.toFixed(3) + " V";
            voltmeter.style.color = v > 0 ? "#0f0" : "#555";
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        document.getElementById('toggleSaltBridge').addEventListener('click', () => {
            hasSaltBridge = !hasSaltBridge;
            saltBridge.classList.toggle('active');
            updateVoltageDisplay();
            feedback.innerHTML = hasSaltBridge 
                ? "ì—¼ë‹¤ë¦¬ê°€ ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì˜¨ì´ ì´ë™í•  í†µë¡œê°€ ìƒê²¼ìŠµë‹ˆë‹¤." 
                : "ì—¼ë‹¤ë¦¬ê°€ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤. íšŒë¡œê°€ ëŠì–´ì¡ŒìŠµë‹ˆë‹¤.";
            
            if (!hasSaltBridge && isRunning) stopExperiment();
        });

        document.getElementById('znConc').addEventListener('input', (e) => {
            znC = parseFloat(e.target.value);
            document.getElementById('znVal').innerText = znC;
            if(isRunning) updateVoltageDisplay();
        });

        document.getElementById('cuConc').addEventListener('input', (e) => {
            cuC = parseFloat(e.target.value);
            document.getElementById('cuVal').innerText = cuC;
            // êµ¬ë¦¬ ë†ë„ê°€ ë†’ìœ¼ë©´ ìš©ì•¡ ìƒ‰ì´ ì§„í•´ì§
            cuSolution.style.backgroundColor = `rgba(0, 0, 255, ${0.1 + (cuC * 0.2)})`;
            if(isRunning) updateVoltageDisplay();
        });

        document.getElementById('startBtn').addEventListener('click', () => {
            if (!hasSaltBridge) {
                feedback.innerHTML = "âš ï¸ ì£¼ì˜: ì—¼ë‹¤ë¦¬ê°€ ì—°ê²°ë˜ì§€ ì•Šì•„ ì „ë¥˜ê°€ íë¥¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!";
                return;
            }
            if (!isRunning) startExperiment();
            else stopExperiment();
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            stopExperiment();
            znPlate.style.transform = "translateX(-50%) scale(1)";
            cuPlate.style.transform = "translateX(-50%) scale(1)";
            znC = 1.0; cuC = 1.0;
            document.getElementById('znConc').value = 1.0;
            document.getElementById('cuConc').value = 1.0;
            document.getElementById('znVal').innerText = "1.0";
            document.getElementById('cuVal').innerText = "1.0";
            hasSaltBridge = false;
            saltBridge.classList.remove('active');
            feedback.innerHTML = "ì‹¤í—˜ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.";
            anodeRxn.innerText = "(-)ê·¹: ì‚°í™”";
            cathodeRxn.innerText = "(+)ê·¹: í™˜ì›";
            updateVoltageDisplay();
        });

        function startExperiment() {
            isRunning = true;
            document.getElementById('startBtn').innerText = "ì‹¤í—˜ ì¤‘ì§€ (ìŠ¤ìœ„ì¹˜ OFF)";
            
            // ì „ì íë¦„ ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
            electrons.forEach(el => el.classList.add('flowing'));
            updateVoltageDisplay();

            // ë°˜ì‘ì‹ ì—…ë°ì´íŠ¸
            anodeRxn.innerHTML = "<b>(-)ê·¹ (ì‚°í™”):</b><br>Zn â†’ ZnÂ²âº + 2eâ»";
            cathodeRxn.innerHTML = "<b>(+)ê·¹ (í™˜ì›):</b><br>CuÂ²âº + 2eâ» â†’ Cu";

            feedback.innerHTML = `
                âš¡ ì „ë¥˜ê°€ íë¥´ê³  ìˆìŠµë‹ˆë‹¤!<br>
                - ì „ìëŠ” <b>ì•„ì—°(Zn)</b>ì—ì„œ <b>êµ¬ë¦¬(Cu)</b>ë¡œ ì´ë™í•©ë‹ˆë‹¤.<br>
                - ì „ì••: <b>${calculateVoltage().toFixed(3)}V</b>
            `;

            // ì „ê·¹ ë³€í™” ì‹œë®¬ë ˆì´ì…˜ ë£¨í”„
            let scaleFactor = 0;
            timer = setInterval(() => {
                scaleFactor += 0.005;
                // ì•„ì—°íŒ: ì‚°í™”ë˜ì–´ ë…¹ìŒ (ì‘ì•„ì§)
                znPlate.style.transform = `translateX(-50%) scaleX(${1 - scaleFactor * 0.5}) scaleY(${1 - scaleFactor * 0.1})`;
                // êµ¬ë¦¬íŒ: í™˜ì›ë˜ì–´ ì„ì¶œë¨ (ì»¤ì§)
                cuPlate.style.transform = `translateX(-50%) scaleX(${1 + scaleFactor * 0.5}) scaleY(${1 + scaleFactor * 0.1})`;
                
                if (scaleFactor > 0.5) { // ì¼ì • ì‹œê°„ í›„ ìë™ ì¤‘ì§€ (ì•ˆì „ ì¥ì¹˜)
                    stopExperiment();
                    feedback.innerHTML += "<br>(ë°˜ì‘ì´ ë§ì´ ì§„í–‰ë˜ì–´ ì‹¤í—˜ì„ ì¼ì‹œ ì •ì§€í•©ë‹ˆë‹¤)";
                }
            }, 100);
        }

        function stopExperiment() {
            isRunning = false;
            document.getElementById('startBtn').innerText = "ì‹¤í—˜ ì‹œì‘ (ìŠ¤ìœ„ì¹˜ ON)";
            electrons.forEach(el => el.classList.remove('flowing'));
            clearInterval(timer);
            updateVoltageDisplay();
        }

        init();
    </script>
</body>
</html>