<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì•„ì„¸í†¤ ê¸°í™” ì‹¤í—˜ ê°€ìƒì‹¤í—˜ì‹¤</title>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; background-color: #f0f4f8; text-align: center; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h1 { color: #2c3e50; }
        .lab-bench { display: flex; justify-content: space-around; align-items: flex-start; margin-top: 20px; flex-wrap: wrap; }
        .view-box { border: 2px solid #ddd; border-radius: 10px; padding: 10px; margin: 10px; background: #fff; }
        canvas { background-color: #eef; border-radius: 5px; }
        .controls { margin: 20px 0; padding: 15px; background-color: #e8f0fe; border-radius: 10px; }
        button { padding: 10px 20px; font-size: 16px; cursor: pointer; background-color: #4CAF50; color: white; border: none; border-radius: 5px; margin: 5px; transition: 0.3s; }
        button:hover { background-color: #45a049; }
        button.reset { background-color: #f44336; }
        button:disabled { background-color: #cccccc; cursor: not-allowed; }
        .status-display { display: flex; justify-content: space-around; font-size: 1.2em; font-weight: bold; color: #333; margin-bottom: 15px; }
        .highlight { color: #e91e63; }
        .explanation { text-align: left; background: #fff3cd; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 5px solid #ffc107; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ§ª ì•„ì„¸í†¤ ê¸°í™” ì‹¤í—˜: ì§ˆëŸ‰ê³¼ ë¶€í”¼ ë³€í™”</h1>
    
    <div class="status-display">
        <div>ìƒíƒœ: <span id="stateText" class="highlight">ì•¡ì²´ (Liquid)</span></div>
        <div>ì§ˆëŸ‰: <span id="massText">0.00</span> g</div>
        <div>ë¶€í”¼: <span id="volText">ì‘ìŒ</span></div>
    </div>

    <div class="controls">
        <label>ì•„ì„¸í†¤ ì–‘: 
            <select id="amountSelect">
                <option value="5">5 mL</option>
                <option value="10">10 mL</option>
                <option value="20">20 mL</option>
            </select>
        </label>
        <button id="heatBtn" onclick="startHeating()">ğŸ”¥ ê°€ì—´ ì‹œì‘ (ê¸°í™”)</button>
        <button id="coolBtn" onclick="startCooling()" disabled>â„ï¸ ëƒ‰ê° (ì•¡í™”)</button>
        <button class="reset" onclick="resetExp()">ğŸ”„ ì‹¤í—˜ ì´ˆê¸°í™”</button>
    </div>

    <div class="lab-bench">
        <div class="view-box">
            <h3>ğŸ‘ï¸ ì‹¤í—˜ ê´€ì°° (ê±°ì‹œì )</h3>
            <canvas id="macroCanvas" width="300" height="350"></canvas>
        </div>

        <div class="view-box">
            <h3>ğŸ”¬ ì…ì í˜„ë¯¸ê²½ (ë¯¸ì‹œì )</h3>
            <canvas id="microCanvas" width="300" height="350"></canvas>
        </div>
    </div>

    <div class="explanation" id="guideText">
        ğŸ’¡ <strong>ì‹¤í—˜ ê°€ì´ë“œ:</strong> ì•„ì„¸í†¤ì˜ ì–‘ì„ ì„ íƒí•˜ê³  'ê°€ì—´ ì‹œì‘' ë²„íŠ¼ì„ ëˆŒëŸ¬ë³´ì„¸ìš”. ì €ìš¸ì˜ ëˆˆê¸ˆ(ì§ˆëŸ‰)ê³¼ ë¹„ë‹ë´‰ì§€ì˜ í¬ê¸°(ë¶€í”¼) ë³€í™”ë¥¼ ìœ ì‹¬íˆ ê´€ì°°í•˜ì„¸ìš”!
    </div>
</div>

<script>
    const macroCanvas = document.getElementById('macroCanvas');
    const macroCtx = macroCanvas.getContext('2d');
    const microCanvas = document.getElementById('microCanvas');
    const microCtx = microCanvas.getContext('2d');
    
    let amount = 5;
    let isGas = false;
    let heatingProgress = 0; // 0 to 100
    let animationId;
    let particles = [];
    
    // ì´ˆê¸°í™”
    function init() {
        resetExp();
        animate();
    }

    function resetExp() {
        amount = parseInt(document.getElementById('amountSelect').value);
        isGas = false;
        heatingProgress = 0;
        document.getElementById('heatBtn').disabled = false;
        document.getElementById('coolBtn').disabled = true;
        document.getElementById('amountSelect').disabled = false;
        document.getElementById('stateText').innerText = "ì•¡ì²´ (Liquid)";
        document.getElementById('volText').innerText = "ì‘ìŒ";
        document.getElementById('guideText').innerHTML = "ğŸ’¡ <strong>ì‹¤í—˜ ê°€ì´ë“œ:</strong> ì•„ì„¸í†¤ì˜ ì–‘ì„ ì„ íƒí•˜ê³  'ê°€ì—´ ì‹œì‘' ë²„íŠ¼ì„ ëˆŒëŸ¬ë³´ì„¸ìš”. ì§ˆëŸ‰ì€ ë³€í• ê¹Œìš”?";
        
        updateMass();
        createParticles();
    }

    function updateMass() {
        // ì•„ì„¸í†¤ ë°€ë„ ì•½ 0.79 g/mL, í”Œë¼ìŠ¤í¬+ë´‰ì§€ ë¬´ê²Œ ì•½ 50g ê°€ì •
        let liquidMass = amount * 0.79;
        let totalMass = 50 + liquidMass;
        document.getElementById('massText').innerText = totalMass.toFixed(2);
    }

    function createParticles() {
        particles = [];
        // ì…ì ê°œìˆ˜ëŠ” ì–‘ì— ë¹„ë¡€ (ì‹œê°í™”ë¥¼ ìœ„í•´ ì ë‹¹íˆ ì¡°ì ˆ)
        let particleCount = amount * 5; 
        
        for(let i=0; i<particleCount; i++) {
            particles.push({
                x: Math.random() * 200 + 50,
                y: Math.random() * 50 + 250, // ë°”ë‹¥ì— ê¹”ë¦¼
                vx: Math.random() - 0.5,
                vy: Math.random() - 0.5,
                size: 6 // ì…ì í¬ê¸°ëŠ” ì¼ì •!
            });
        }
    }

    function startHeating() {
        document.getElementById('heatBtn').disabled = true;
        document.getElementById('amountSelect').disabled = true;
        let progress = 0;
        const interval = setInterval(() => {
            progress += 2;
            heatingProgress = progress;
            
            if (progress >= 100) {
                clearInterval(interval);
                isGas = true;
                document.getElementById('coolBtn').disabled = false;
                document.getElementById('stateText').innerText = "ê¸°ì²´ (Gas)";
                document.getElementById('volText').innerText = "ë§¤ìš° í¼ (íŒ½ì°½)";
                document.getElementById('guideText').innerHTML = "âœ… <strong>ê²°ê³¼ ë¶„ì„:</strong> ë¹„ë‹ë´‰ì§€ê°€ ë¹µë¹µí•´ì¡ŒìŠµë‹ˆë‹¤(ë¶€í”¼ ì¦ê°€). í•˜ì§€ë§Œ ì§ˆëŸ‰(g)ì€ ê·¸ëŒ€ë¡œì£ ? ì…ìì˜ ê°œìˆ˜ëŠ” ë³€í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤!";
            }
        }, 50);
    }

    function startCooling() {
        document.getElementById('coolBtn').disabled = true;
        isGas = false; // ì¦‰ì‹œ ìƒíƒœ ë³€ê²½ í”Œë˜ê·¸
        let progress = 100;
        const interval = setInterval(() => {
            progress -= 2;
            heatingProgress = progress;
            
            if (progress <= 0) {
                clearInterval(interval);
                document.getElementById('heatBtn').disabled = false;
                document.getElementById('stateText').innerText = "ì•¡ì²´ (Liquid)";
                document.getElementById('volText').innerText = "ì‘ìŒ";
                document.getElementById('amountSelect').disabled = false;
                document.getElementById('guideText').innerHTML = "â„ï¸ ë‹¤ì‹œ ì•¡ì²´ë¡œ ëŒì•„ì™”ìŠµë‹ˆë‹¤. ì…ìë“¤ì´ ë‹¤ì‹œ ì˜¹ê¸°ì¢…ê¸° ëª¨ì˜€ë„¤ìš”.";
            }
        }, 50);
    }

    function drawMacro() {
        macroCtx.clearRect(0, 0, macroCanvas.width, macroCanvas.height);
        
        // ì €ìš¸ ê·¸ë¦¬ê¸°
        macroCtx.fillStyle = "#ddd";
        macroCtx.fillRect(50, 300, 200, 40);
        macroCtx.fillStyle = "#000";
        macroCtx.font = "20px Arial";
        macroCtx.fillText(document.getElementById('massText').innerText + " g", 100, 327);

        // í”Œë¼ìŠ¤í¬ ê·¸ë¦¬ê¸°
        macroCtx.strokeStyle = "#333";
        macroCtx.lineWidth = 2;
        macroCtx.beginPath();
        macroCtx.moveTo(110, 150);
        macroCtx.lineTo(110, 250); // ëª©
        macroCtx.lineTo(70, 300);  // ë°”ë‹¥ ì™¼ìª½
        macroCtx.lineTo(230, 300); // ë°”ë‹¥ ì˜¤ë¥¸ìª½
        macroCtx.lineTo(190, 250); // ëª© ì˜¤ë¥¸ìª½
        macroCtx.lineTo(190, 150);
        macroCtx.stroke();

        // ë¹„ë‹ë´‰ì§€ ê·¸ë¦¬ê¸° (íŒ½ì°½ ì• ë‹ˆë©”ì´ì…˜)
        let balloonScale = 1 + (heatingProgress / 100) * 1.5; // ìµœëŒ€ 2.5ë°° ì»¤ì§
        macroCtx.beginPath();
        macroCtx.strokeStyle = "rgba(200, 200, 255, 0.8)";
        macroCtx.fillStyle = "rgba(200, 200, 255, 0.3)";
        // ê°„ë‹¨í•œ ì›í˜•/íƒ€ì›í˜• ë´‰ì§€
        macroCtx.ellipse(150, 150 - (heatingProgress * 0.8), 60 * balloonScale, 70 * balloonScale, 0, 0, Math.PI * 2);
        macroCtx.fill();
        macroCtx.stroke();

        // ì•„ì„¸í†¤ ì•¡ì²´ (ê¸°í™”ë˜ë©´ íˆ¬ëª…í•´ì§/ì‚¬ë¼ì§)
        if (heatingProgress < 100) {
            macroCtx.fillStyle = "rgba(173, 216, 230, " + (1 - heatingProgress/100) + ")";
            macroCtx.beginPath();
            macroCtx.moveTo(75, 295);
            macroCtx.lineTo(225, 295);
            macroCtx.lineTo(200, 260);
            macroCtx.lineTo(100, 260);
            macroCtx.fill();
        }
    }

    function drawMicro() {
        microCtx.clearRect(0, 0, microCanvas.width, microCanvas.height);
        
        // ê²½ê³„ì„  (í”Œë¼ìŠ¤í¬/ë´‰ì§€ ë‚´ë¶€)
        microCtx.strokeStyle = "#aaa";
        microCtx.strokeRect(10, 10, 280, 330);
        microCtx.fillStyle = "#666";
        microCtx.fillText("ì…ì ëª¨í˜• (í™•ëŒ€)", 20, 30);

        // ì…ì ê·¸ë¦¬ê¸°
        particles.forEach(p => {
            microCtx.beginPath();
            microCtx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
            
            // ìƒ‰ìƒ: ì…ì ì¢…ë¥˜ëŠ” ì•ˆ ë³€í•¨ (ë¹¨ê°„ìƒ‰ ê³ ì •)
            microCtx.fillStyle = "#ff5722";
            microCtx.fill();
            
            // ì›€ì§ì„ ë¡œì§
            if (heatingProgress < 50) {
                // ì•¡ì²´ ìƒíƒœ: ë°”ë‹¥ì—ì„œ ë­‰ì³ìˆê³  ì§„ë™
                let targetY = 300 - Math.random() * 50; 
                let speed = 0.5 + (heatingProgress/50); // ê°€ì—´í• ìˆ˜ë¡ í™œë°œ
                
                // ìœ„ì¹˜ ì œí•œ (ë°”ë‹¥)
                if(p.y < 250) p.y += 2;
                
                p.x += (Math.random() - 0.5) * speed;
                p.y += (Math.random() - 0.5) * speed;
                
                // ë²½ ì¶©ëŒ (ê°„ë‹¨í•˜ê²Œ)
                if(p.x < 20) p.x = 20;
                if(p.x > 280) p.x = 280;
                if(p.y > 330) p.y = 330;

            } else {
                // ê¸°ì²´ ìƒíƒœ: ììœ ë¡­ê²Œ ë‚ ì•„ë‹¤ë‹˜
                let speed = 3 + (heatingProgress - 50) / 10;
                
                p.x += p.vx * speed;
                p.y += p.vy * speed;

                // ë²½ íŠ•ê¸°ê¸°
                if(p.x < 20 || p.x > 280) p.vx *= -1;
                if(p.y < 20 || p.y > 330) p.vy *= -1;
            }
        });
    }

    function animate() {
        drawMacro();
        drawMicro();
        requestAnimationFrame(animate);
    }

    // ë³€ê²½ ê°ì§€
    document.getElementById('amountSelect').addEventListener('change', resetExp);

    init();
</script>

</body>
</html>