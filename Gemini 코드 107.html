<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°€ìƒ í™”í•™ ì‹¤í—˜ì‹¤: pH ì¸¡ì • ë° ì˜ˆì¸¡</title>
    <style>
        :root {
            --primary-color: #4A90E2;
            --accent-color: #FF6B6B;
            --bg-color: #F7F9FC;
            --text-color: #333;
        }
        body {
            font-family: 'Malgun Gothic', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        header {
            text-align: center;
            margin-bottom: 20px;
        }
        h1 { margin: 0; color: var(--primary-color); }
        .subtitle { font-size: 0.9em; color: #666; }
        
        .main-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            max-width: 1000px;
            width: 100%;
            justify-content: center;
        }

        /* Control Panel */
        .panel {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            flex: 1;
            min-width: 300px;
        }
        
        .control-group { margin-bottom: 15px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; }
        select, button {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ddd;
            font-size: 1rem;
            margin-bottom: 5px;
            cursor: pointer;
        }
        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            transition: background 0.3s;
        }
        button:hover { background-color: #357ABD; }
        button.reset { background-color: var(--accent-color); }

        /* Experiment Area */
        .lab-bench {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 300px;
            position: relative;
        }

        .beaker {
            width: 150px;
            height: 200px;
            border: 3px solid #ccc;
            border-top: none;
            border-radius: 0 0 20px 20px;
            position: relative;
            background: rgba(255,255,255,0.5);
            overflow: hidden;
            box-shadow: inset 0 -10px 20px rgba(0,0,0,0.05);
        }

        .solution {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 70%;
            background-color: #E0F7FA; /* Default Water */
            transition: background-color 1s ease, height 1s ease;
        }

        .ph-meter {
            width: 120px;
            background: #333;
            color: #0f0;
            padding: 10px;
            text-align: center;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 1.5rem;
            margin-bottom: 10px;
            border: 2px solid #555;
            box-shadow: 0 0 10px rgba(0,255,0,0.2);
        }

        .ph-strip {
            width: 40px;
            height: 100px;
            background: #fff;
            border: 1px solid #ccc;
            margin-top: 10px;
            transition: background-color 1s;
            position: absolute;
            right: -60px;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            writing-mode: vertical-rl;
            font-size: 0.8em;
        }

        /* Info & Quiz */
        .info-panel p { margin: 5px 0; }
        .formula {
            background: #eee;
            padding: 5px;
            border-radius: 4px;
            text-align: center;
            font-style: italic;
        }
        
        .quiz-section {
            margin-top: 20px;
            border-top: 2px dashed #ddd;
            padding-top: 10px;
        }
        .feedback {
            margin-top: 10px;
            font-weight: bold;
            padding: 10px;
            border-radius: 5px;
        }
        .feedback.correct { background-color: #d4edda; color: #155724; }
        .feedback.wrong { background-color: #f8d7da; color: #721c24; }

    </style>
</head>
<body>

<header>
    <h1>ğŸ§ª ê°€ìƒ í™”í•™ ì‹¤í—˜ì‹¤: pH ì¸¡ì •</h1>
    <div class="subtitle">ê³ ë“±í•™êµ í™”í•™â…  - ì‚°ê³¼ ì—¼ê¸°</div>
</header>

<div class="main-container">
    <div class="panel">
        <h3>1. ì‹¤í—˜ ì„¤ì •</h3>
        <div class="control-group">
            <label for="chemical">ìš©ì•¡ ì„ íƒ:</label>
            <select id="chemical">
                <option value="water">ìˆœìˆ˜í•œ ë¬¼ (Hâ‚‚O)</option>
                <option value="HCl">ì—¼ì‚° (HCl) - ê°•ì‚°</option>
                <option value="NaOH">ìˆ˜ì‚°í™”ë‚˜íŠ¸ë¥¨ (NaOH) - ê°•ì—¼ê¸°</option>
            </select>
        </div>
        <div class="control-group">
            <label for="concentration">ì´ˆê¸° ë†ë„ (ëª° ë†ë„):</label>
            <select id="concentration">
                <option value="0.1">0.1 M</option>
                <option value="0.01">0.01 M</option>
            </select>
        </div>
        <div class="control-group">
            <button onclick="measurePH()">ğŸ”¬ pH ì¸¡ì •í•˜ê¸°</button>
            <button onclick="dilute()">ğŸ’§ ì¦ë¥˜ìˆ˜ ì¶”ê°€ (10ë°° í¬ì„)</button>
            <button class="reset" onclick="resetExperiment()">ğŸ”„ ì‹¤í—˜ ì´ˆê¸°í™”</button>
        </div>
        
        <div class="quiz-section">
            <h3>ğŸ“ ê°œë… í€´ì¦ˆ</h3>
            <p id="quiz-question">ìš©ì•¡ì„ ì„ íƒí•˜ê³  ì¸¡ì •í•´ë³´ì„¸ìš”.</p>
            <div id="quiz-options"></div>
            <div id="quiz-feedback" class="feedback" style="display:none;"></div>
        </div>
    </div>

    <div class="panel lab-bench">
        <h3>2. ì‹¤í—˜ ê´€ì°°</h3>
        <div class="ph-meter" id="ph-display">--.--</div>
        <div class="beaker">
            <div class="solution" id="solution-visual"></div>
        </div>
        <div class="ph-strip" id="ph-strip">ì‹œí—˜ì§€</div>
        <p style="margin-top:10px; font-size:0.8em; color:#666;">* ì‹¤ì œ ì‹¤í—˜ì‹¤ì—ì„œëŠ” ë³´ì•ˆê²½ì„ ê¼­ ì°©ìš©í•˜ì„¸ìš”!</p>
    </div>

    <div class="panel info-panel">
        <h3>3. ê²°ê³¼ ë° ì´ë¡  ë¶„ì„</h3>
        <p><strong>í˜„ì¬ ìš©ì•¡:</strong> <span id="current-sol">--</span></p>
        <p><strong>í˜„ì¬ ë†ë„:</strong> <span id="current-conc">--</span> M</p>
        <div class="formula">pH = -log[Hâº]</div>
        <hr>
        <p><strong>ê³„ì‚°ëœ [Hâº]:</strong> <span id="calc-h">--</span> M</p>
        <p><strong>ì´ë¡ ì  pH:</strong> <span id="calc-ph">--</span></p>
        <hr>
        <p><strong>ğŸ’¡ í•µì‹¬ í¬ì¸íŠ¸:</strong></p>
        <ul style="font-size: 0.9em; padding-left: 20px;">
            <li>pHê°€ 1 ê°ì†Œí•˜ë©´ [Hâº]ëŠ” 10ë°° ì¦ê°€í•©ë‹ˆë‹¤.</li>
            <li>pH + pOH = 14 (25â„ƒ ê¸°ì¤€)</li>
            <li>ë¬¼ì€ ìë™ ì´ì˜¨í™”í•˜ì—¬ pH 7ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</li>
        </ul>
    </div>
</div>

<script>
    let currentPh = 7.0;
    let currentConc = 0;
    let currentChemical = 'water';
    let isDiluted = false;

    const phColors = {
        1: '#EE3E32', 2: '#F37D33', 3: '#F8B635', 4: '#F6D338', 5: '#CAD93F',
        6: '#9ACD32', 7: '#4DB748', 8: '#2EAE63', 9: '#00A388', 10: '#0097A7',
        11: '#0079C1', 12: '#1D4E89', 13: '#4B367C', 14: '#662D91'
    };

    function getPhColor(ph) {
        let roundedPh = Math.round(ph);
        if (roundedPh < 1) roundedPh = 1;
        if (roundedPh > 14) roundedPh = 14;
        return phColors[roundedPh];
    }

    function calculatePH(chem, conc) {
        if (chem === 'water') return 7.0;
        
        // Strong Acid: [H+] = conc
        if (chem === 'HCl') {
            return -Math.log10(conc);
        }
        
        // Strong Base: [OH-] = conc => pOH = -log[OH-], pH = 14 - pOH
        if (chem === 'NaOH') {
            let pOH = -Math.log10(conc);
            return 14.0 - pOH;
        }
        return 7.0;
    }

    function measurePH() {
        const chemSelect = document.getElementById('chemical');
        const concSelect = document.getElementById('concentration');
        
        currentChemical = chemSelect.options[chemSelect.selectedIndex].text;
        let baseConc = parseFloat(concSelect.value);
        
        // Apply dilution if active
        currentConc = isDiluted ? baseConc / 10 : baseConc;
        
        // Calculate theoretical pH
        let chemicalType = chemSelect.value;
        currentPh = calculatePH(chemicalType, currentConc);

        updateVisuals(chemicalType);
        updateInfo(chemicalType);
        generateQuiz(chemicalType, currentPh);
    }

    function dilute() {
        if (isDiluted) {
            alert("ì´ë¯¸ í¬ì„ë˜ì—ˆìŠµë‹ˆë‹¤. ì‹¤í—˜ì„ ì´ˆê¸°í™”í•˜ì„¸ìš”.");
            return;
        }
        isDiluted = true;
        measurePH(); // Re-measure with new concentration
        document.getElementById('solution-visual').style.height = '90%'; // Increase volume visual
    }

    function resetExperiment() {
        isDiluted = false;
        document.getElementById('ph-display').innerText = "--.--";
        document.getElementById('solution-visual').style.backgroundColor = '#E0F7FA';
        document.getElementById('solution-visual').style.height = '70%';
        document.getElementById('ph-strip').style.backgroundColor = '#fff';
        document.getElementById('current-sol').innerText = "--";
        document.getElementById('current-conc').innerText = "--";
        document.getElementById('calc-h').innerText = "--";
        document.getElementById('calc-ph').innerText = "--";
        document.getElementById('quiz-feedback').style.display = 'none';
        document.getElementById('quiz-question').innerText = "ìš©ì•¡ì„ ì„ íƒí•˜ê³  ì¸¡ì •í•´ë³´ì„¸ìš”.";
        document.getElementById('quiz-options').innerHTML = "";
    }

    function updateVisuals(chemType) {
        // Meter Animation
        let display = document.getElementById('ph-display');
        let targetPh = currentPh;
        let tempPh = (Math.random() * 14).toFixed(2);
        
        let interval = setInterval(() => {
            display.innerText = (Math.random() * 14).toFixed(2);
        }, 50);

        setTimeout(() => {
            clearInterval(interval);
            display.innerText = targetPh.toFixed(2);
            
            // Color Change
            let color = getPhColor(targetPh);
            if(chemType === 'water') color = '#E0F7FA'; // Keep water looking like water unless indicated
            
            // However, for pH strip, always show color
            document.getElementById('ph-strip').style.backgroundColor = getPhColor(targetPh);
            
            // Solution tint (subtle)
            document.getElementById('solution-visual').style.backgroundColor = color + '88'; // Add transparency
        }, 800);
    }

    function updateInfo(chemType) {
        document.getElementById('current-sol').innerText = currentChemical;
        document.getElementById('current-conc').innerText = currentConc; // Floating point precision might need handling
        
        let hConc;
        if (chemType === 'water') hConc = 1e-7;
        else if (chemType === 'HCl') hConc = currentConc;
        else if (chemType === 'NaOH') hConc = Math.pow(10, -currentPh);
        
        // Format scientific notation
        document.getElementById('calc-h').innerText = hConc.toExponential(1);
        document.getElementById('calc-ph').innerText = currentPh.toFixed(2);
    }

    function generateQuiz(chemType, ph) {
        const qSection = document.getElementById('quiz-question');
        const oSection = document.getElementById('quiz-options');
        const fSection = document.getElementById('quiz-feedback');
        
        fSection.style.display = 'none';
        oSection.innerHTML = '';

        let question = "";
        let answers = [];
        let correctIndex = 0;

        if (chemType === 'water') {
            question = "ìˆœìˆ˜í•œ ë¬¼ì˜ pHê°€ 7ì¸ ì´ìœ ëŠ” ë¬´ì—‡ì¼ê¹Œìš”?";
            answers = ["ì´ì˜¨ì´ ì „í˜€ ì—†ì–´ì„œ", "Hâºì™€ OHâ»ì˜ ë†ë„ê°€ ê°™ì•„ì„œ", "ì‚°ì„±ì´ê¸° ë•Œë¬¸ì—"];
            correctIndex = 1;
        } else if (isDiluted) {
            question = `ìš©ì•¡ì„ 10ë°° í¬ì„í–ˆì„ ë•Œ pHëŠ” ì–´ë–»ê²Œ ë³€í–ˆë‚˜ìš”?`;
            if (ph < 7) { // Acid
                answers = ["1ë§Œí¼ ì¦ê°€í–ˆë‹¤", "1ë§Œí¼ ê°ì†Œí–ˆë‹¤", "ë³€í•˜ì§€ ì•Šì•˜ë‹¤"];
                correctIndex = 0;
            } else { // Base
                answers = ["1ë§Œí¼ ì¦ê°€í–ˆë‹¤", "1ë§Œí¼ ê°ì†Œí–ˆë‹¤", "ë³€í•˜ì§€ ì•Šì•˜ë‹¤"];
                correctIndex = 1;
            }
        } else {
            question = `í˜„ì¬ ë†ë„(${currentConc}M)ì—ì„œ pHê°€ ${ph}ì¸ ì´ìœ ëŠ”?`;
            answers = ["ë†ë„ì™€ pHëŠ” ê´€ê³„ì—†ë‹¤", `ë¡œê·¸ ê³„ì‚° ê²°ê³¼ -log(${currentConc}) ê°’ì´ë‹¤`, "ì˜¨ë„ê°€ ë†’ì•„ì„œ ê·¸ë ‡ë‹¤"];
            correctIndex = 1;
        }

        qSection.innerText = question;

        answers.forEach((ans, idx) => {
            let btn = document.createElement('button');
            btn.innerText = ans;
            btn.style.marginTop = '5px';
            btn.style.backgroundColor = '#fff';
            btn.style.color = '#333';
            btn.onclick = () => checkAnswer(idx, correctIndex);
            oSection.appendChild(btn);
        });
    }

    function checkAnswer(selected, correct) {
        const fSection = document.getElementById('quiz-feedback');
        fSection.style.display = 'block';
        if (selected === correct) {
            fSection.className = 'feedback correct';
            fSection.innerText = "âœ… ì •ë‹µì…ë‹ˆë‹¤! ê°œë…ì„ ì •í™•íˆ ì´í•´í–ˆë„¤ìš”.";
        } else {
            fSection.className = 'feedback wrong';
            fSection.innerText = "âŒ ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”. pHëŠ” ìˆ˜ì†Œ ì´ì˜¨ ë†ë„ì˜ ë¡œê·¸ í•¨ìˆ˜ì…ë‹ˆë‹¤.";
        }
    }
</script>

</body>
</html>