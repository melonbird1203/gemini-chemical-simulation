<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°€ìƒ ì‹¤í—˜: ë¬¼ì§ˆì˜ ìš©í•´ë„ì™€ ì˜¨ë„</title>
    <style>
        :root { --primary: #4A90E2; --accent: #FF6B6B; --bg: #F0F4F8; }
        body { font-family: 'Malgun Gothic', sans-serif; background: var(--bg); margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        h1 { color: #333; margin-bottom: 10px; font-size: 1.5rem; }
        .container { display: flex; flex-wrap: wrap; gap: 20px; max-width: 1000px; width: 100%; justify-content: center; }
        
        /* ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        .controls { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); flex: 1; min-width: 280px; }
        .control-group { margin-bottom: 20px; }
        label { display: block; font-weight: bold; margin-bottom: 8px; color: #555; }
        select, button { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 1rem; cursor: pointer; }
        button { background: var(--primary); color: white; border: none; transition: 0.2s; margin-bottom: 5px;}
        button:hover { background: #357ABD; }
        button.reset { background: #718096; }
        input[type=range] { width: 100%; }
        .value-display { font-size: 1.2rem; color: var(--primary); font-weight: bold; text-align: right; }

        /* ë¹„ì»¤ ì‹œê°í™” */
        .visualization { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); flex: 1; min-width: 280px; display: flex; flex-direction: column; align-items: center; }
        .beaker-container { position: relative; width: 200px; height: 250px; border: 3px solid #aaa; border-top: none; border-radius: 0 0 15px 15px; margin-top: 20px; background: linear-gradient(to bottom, rgba(255,255,255,0.2), rgba(200,230,255,0.4)); overflow: hidden; }
        .water { position: absolute; bottom: 0; width: 100%; height: 80%; background: rgba(74, 144, 226, 0.3); transition: height 0.5s; }
        .particle { position: absolute; width: 6px; height: 6px; border-radius: 50%; background: var(--primary); opacity: 0.8; transition: top 0.5s, left 0.5s; }
        .precipitate { position: absolute; bottom: 5px; width: 100%; height: 0; background: #ddd; transition: height 0.3s; display: flex; justify-content: center; align-items: flex-end; font-size: 0.8rem; color: #666; }
        .pile { width: 8px; height: 8px; background: #8B4513; border-radius: 50%; position: absolute; bottom: 2px; }

        /* ê·¸ë˜í”„ ë° ìƒíƒœ */
        .status-panel { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); flex: 1; min-width: 280px; }
        .status-item { display: flex; justify-content: space-between; margin-bottom: 10px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
        .status-alert { margin-top: 10px; padding: 10px; border-radius: 6px; font-weight: bold; text-align: center; display: none; }
        .alert-sat { background: #FFF3CD; color: #856404; }
        .alert-precip { background: #F8D7DA; color: #721C24; }

        /* ê°„ë‹¨í•œ ê·¸ë˜í”„ ë°” */
        .bar-chart { margin-top: 20px; }
        .bar-bg { background: #eee; height: 20px; border-radius: 10px; overflow: hidden; position: relative; }
        .bar-fill { height: 100%; background: var(--primary); width: 0%; transition: width 0.3s; }
        .bar-limit { position: absolute; top: 0; bottom: 0; width: 2px; background: var(--accent); z-index: 10; }
        .bar-label { font-size: 0.8rem; color: #666; margin-top: 5px; display: flex; justify-content: space-between; }

    </style>
</head>
<body>

    <h1>âš—ï¸ ê°€ìƒ ì‹¤í—˜: ë¬¼ì§ˆì˜ ìš©í•´ë„ ë¹„êµ</h1>
    
    <div class="container">
        <div class="controls">
            <div class="control-group">
                <label>ğŸ§ª ìš©ì§ˆ ì„ íƒ (ë¬¼ 100g ê¸°ì¤€)</label>
                <select id="substanceSelect" onchange="resetExperiment()">
                    <option value="kno3">ì§ˆì‚°ì¹¼ë¥¨ (ì˜¨ë„ ì˜í–¥ í¼)</option>
                    <option value="nano3">ì§ˆì‚°ë‚˜íŠ¸ë¥¨ (ì˜¨ë„ ì˜í–¥ ì¤‘ê°„)</option>
                    <option value="nacl">ì—¼í™”ë‚˜íŠ¸ë¥¨ (ì˜¨ë„ ì˜í–¥ ì‘ìŒ)</option>
                </select>
            </div>

            <div class="control-group">
                <label>ğŸŒ¡ï¸ ë¬¼ì˜ ì˜¨ë„: <span id="tempDisplay" class="value-display">20</span>â„ƒ</label>
                <input type="range" id="tempRange" min="0" max="100" step="10" value="20" oninput="updateExperiment()">
            </div>

            <div class="control-group">
                <label>â• ìš©ì§ˆ ì¶”ê°€ (í˜„ì¬: <span id="amountDisplay" class="value-display">0</span>g)</label>
                <div style="display:flex; gap:5px;">
                    <button onclick="addSolute(1)">+1g ë„£ê¸°</button>
                    <button onclick="addSolute(10)">+10g ë„£ê¸°</button>
                    <button onclick="addSolute(50)">+50g ë„£ê¸°</button>
                </div>
                <button class="reset" onclick="resetExperiment()">ğŸ”„ ë¹„ì»¤ ë¹„ìš°ê¸° (ì´ˆê¸°í™”)</button>
            </div>
        </div>

        <div class="visualization">
            <h3>ğŸ”¬ ë¹„ì»¤ ê´€ì°°</h3>
            <div class="beaker-container" id="beaker">
                <div class="water"></div>
                <div id="particleContainer"></div>
                <div id="precipitatePile" class="precipitate"></div>
            </div>
            <p style="font-size: 0.9rem; color: #666; margin-top: 10px;">íŒŒë€ ì : ë…¹ì€ ì…ì | ê°ˆìƒ‰ ë°”ë‹¥: ë…¹ì§€ ì•ŠìŒ(ì„ì¶œ)</p>
        </div>

        <div class="status-panel">
            <h3>ğŸ“Š ì‹¤í—˜ ë°ì´í„°</h3>
            <div class="status-item"><span>í˜„ì¬ ì˜¨ë„ì—ì„œì˜ ìµœëŒ€ ìš©í•´ë„:</span> <strong id="maxSolVal">0g</strong></div>
            <div class="status-item"><span>ì‹¤ì œ ë…¹ì€ ì–‘:</span> <strong id="dissolvedVal">0g</strong></div>
            <div class="status-item"><span>ë…¹ì§€ ì•Šê³  ë‚¨ì€ ì–‘(ì„ì¶œ):</span> <strong id="precipVal" style="color:var(--accent)">0g</strong></div>

            <div id="satAlert" class="status-alert alert-sat">âš ï¸ í¬í™” ìƒíƒœì…ë‹ˆë‹¤! ë” ì´ìƒ ë…¹ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>
            <div id="precipAlert" class="status-alert alert-precip">â„ï¸ ì˜¨ë„ê°€ ë‚®ì•„ì ¸ ê²°ì •ì´ ì„ì¶œë˜ì—ˆìŠµë‹ˆë‹¤!</div>

            <div class="bar-chart">
                <label>ìš©í•´ ìƒíƒœ ê·¸ë˜í”„</label>
                <div class="bar-bg">
                    <div id="barFill" class="bar-fill"></div>
                </div>
                <div class="bar-label">
                    <span>0g</span>
                    <span id="graphMaxLabel">Max</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ìš©í•´ë„ ë°ì´í„° (ê·¼ì‚¬ì¹˜, g/100g ë¬¼)
        // ì˜¨ë„: 0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100
        const solubilityData = {
            kno3:  [13, 22, 32, 46, 64, 85, 110, 138, 169, 202, 246], 
            nano3: [73, 80, 88, 96, 104, 114, 124, 136, 148, 162, 180], 
            nacl:  [35.7, 35.8, 36.0, 36.3, 36.6, 37.0, 37.3, 37.8, 38.4, 39.0, 39.8] 
        };

        let currentAmount = 0;

        function getSolubility(substance, temp) {
            const index = Math.floor(temp / 10);
            const data = solubilityData[substance];
            if (!data) return 0;
            // ê°„ë‹¨í•œ ì„ í˜• ë³´ê°„
            const lower = data[index];
            const upper = index < 10 ? data[index+1] : data[index];
            const ratio = (temp % 10) / 10;
            return Math.round((lower + (upper - lower) * ratio) * 10) / 10;
        }

        function updateExperiment() {
            const substance = document.getElementById('substanceSelect').value;
            const temp = parseInt(document.getElementById('tempRange').value);
            
            document.getElementById('tempDisplay').innerText = temp;
            
            const maxSol = getSolubility(substance, temp);
            
            // ìƒíƒœ ê³„ì‚°
            let dissolved = 0;
            let precipitate = 0;

            if (currentAmount <= maxSol) {
                dissolved = currentAmount;
                precipitate = 0;
            } else {
                dissolved = maxSol;
                precipitate = currentAmount - maxSol;
            }

            // UI ì—…ë°ì´íŠ¸
            document.getElementById('amountDisplay').innerText = currentAmount;
            document.getElementById('maxSolVal').innerText = maxSol + "g";
            document.getElementById('dissolvedVal').innerText = dissolved + "g";
            document.getElementById('precipVal').innerText = precipitate.toFixed(1) + "g";

            // ì•Œë¦¼ í‘œì‹œ
            const satAlert = document.getElementById('satAlert');
            const precipAlert = document.getElementById('precipAlert');
            
            satAlert.style.display = (currentAmount >= maxSol && precipitate === 0) ? 'block' : 'none';
            precipAlert.style.display = (precipitate > 0) ? 'block' : 'none';

            // ê·¸ë˜í”„ ì—…ë°ì´íŠ¸
            const barFill = document.getElementById('barFill');
            const graphMax = Math.max(200, maxSol + 50); // ê·¸ë˜í”„ ìµœëŒ€ ìŠ¤ì¼€ì¼ ë™ì  ì¡°ì •
            document.getElementById('graphMaxLabel').innerText = graphMax + "g";
            
            const fillPercent = (dissolved / graphMax) * 100;
            barFill.style.width = fillPercent + "%";
            
            if (precipitate > 0) {
                barFill.style.backgroundColor = "#FF6B6B"; // ì„ì¶œ ì‹œ ë¶‰ì€ìƒ‰ ê²½ê³ 
            } else {
                barFill.style.backgroundColor = "#4A90E2";
            }

            // ì‹œê°í™” (ì…ì)
            renderParticles(dissolved, precipitate);
        }

        function addSolute(amount) {
            currentAmount += amount;
            updateExperiment();
        }

        function resetExperiment() {
            currentAmount = 0;
            updateExperiment();
        }

        function renderParticles(dissolved, precipitate) {
            const container = document.getElementById('particleContainer');
            const pile = document.getElementById('precipitatePile');
            
            // ì„±ëŠ¥ì„ ìœ„í•´ ì…ì ìˆ˜ëŠ” ìŠ¤ì¼€ì¼ ë‹¤ìš´ (1g ë‹¹ 1ê°œëŠ” ë„ˆë¬´ ë§ìŒ -> 5g ë‹¹ 1ê°œë¡œ ì‹œê°í™”)
            const visualCount = Math.min(100, Math.floor(dissolved / 3)); 
            
            // ê¸°ì¡´ ì…ì ìˆ˜ ì¡°ì • (ê°„ë‹¨íˆ innerHTML ì´ˆê¸°í™” í›„ ì¬ìƒì„± - ìµœì í™”ë³´ë‹¤ëŠ” ëª…ë£Œí•¨ ìš°ì„ )
            container.innerHTML = '';
            
            for(let i=0; i<visualCount; i++) {
                const p = document.createElement('div');
                p.className = 'particle';
                // ë¹„ì»¤ ë‚´ë¶€ ëœë¤ ìœ„ì¹˜ (ë¬¼ ì˜ì—­ ë‚´)
                p.style.left = (Math.random() * 180 + 10) + 'px'; 
                p.style.top = (Math.random() * 150 + 50) + 'px';
                
                // ê°„ë‹¨í•œ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼
                p.style.animation = `float ${2 + Math.random()}s infinite alternate`;
                container.appendChild(p);
            }

            // ì„ì¶œë¬¼ ì‹œê°í™”
            if (precipitate > 0) {
                const pileHeight = Math.min(60, precipitate); // ìµœëŒ€ ë†’ì´ ì œí•œ
                pile.style.height = pileHeight + 'px';
                pile.style.backgroundColor = '#8B4513';
                pile.innerHTML = 'â›°ï¸'; // ê°€ë¼ì•‰ì€ ë”ë¯¸ ì•„ì´ì½˜
            } else {
                pile.style.height = '0px';
                pile.innerHTML = '';
            }
        }

        // ì´ˆê¸° ì‹¤í–‰
        updateExperiment();
    </script>
</body>
</html>