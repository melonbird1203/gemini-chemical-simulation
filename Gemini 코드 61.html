<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¤‘2 ê³¼í•™: íš¨ê³¼ì ì¸ ë‹¨ì—´ ë°©ë²• íƒìƒ‰</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #4CAF50;
            --secondary-color: #2196F3;
            --bg-color: #f4f7f6;
            --panel-bg: #ffffff;
        }
        body {
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--bg-color);
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
        }
        header {
            grid-column: 1 / -1;
            text-align: center;
            margin-bottom: 20px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        h1 { margin: 0; color: var(--secondary-color); font-size: 1.5rem; }
        p { margin: 5px 0 0; color: #666; font-size: 0.9rem; }

        /* ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        .controls {
            background: var(--panel-bg);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            height: fit-content;
        }
        .control-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: bold; font-size: 0.9rem; }
        select, input[type="range"], button {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-bottom: 5px;
        }
        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
            font-size: 1rem;
            transition: background 0.3s;
        }
        button:hover { background-color: #45a049; }
        button.reset { background-color: #ff9800; margin-top: 10px; }
        
        /* ì‹œê°í™” ë° ê·¸ë˜í”„ ì˜ì—­ */
        .simulation-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .visual-display {
            background: var(--panel-bg);
            border-radius: 15px;
            height: 300px;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .graph-container {
            background: var(--panel-bg);
            padding: 15px;
            border-radius: 15px;
            height: 300px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        /* ì»µ ì‹œê°í™” ìŠ¤íƒ€ì¼ */
        .cup-container {
            position: relative;
            width: 150px;
            height: 200px;
            display: flex;
            justify-content: center;
            align-items: flex-end;
        }
        .insulation-layer {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 100%;
            border-radius: 10px 10px 20px 20px;
            background-color: rgba(200, 200, 200, 0.3);
            border: 2px dashed #999;
            transition: all 0.3s ease;
            z-index: 1;
        }
        .cup-inner {
            width: 80%;
            height: 90%;
            background: linear-gradient(to top, #ff4d4d, #ff9999);
            border-radius: 5px 5px 15px 15px;
            z-index: 2;
            position: relative;
            margin-bottom: 10px;
            transition: background 0.5s;
        }
        .lid {
            position: absolute;
            top: -10px;
            width: 120%;
            left: -10%;
            height: 20px;
            background-color: #555;
            border-radius: 5px;
            z-index: 3;
            display: none;
        }
        .heat-arrows {
            position: absolute;
            top: -40px;
            width: 100%;
            text-align: center;
            font-size: 24px;
            animation: floatUp 1.5s infinite;
            opacity: 0;
            color: orange;
        }
        
        @keyframes floatUp {
            0% { transform: translateY(10px); opacity: 1; }
            100% { transform: translateY(-20px); opacity: 0; }
        }

        .status-board {
            margin-top: 10px;
            padding: 10px;
            background: #eef;
            border-radius: 8px;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸ§ª ê°€ìƒ ì‹¤í—˜: ìš°ë¦¬ì§‘ ë³´ì˜¨ë³‘ ë§Œë“¤ê¸°</h1>
        <p>ì–´ë–¤ ì¬ë£Œì™€ êµ¬ì¡°ê°€ ì—´ì„ ê°€ì¥ ì˜ ê°€ë‘ì–´ ë‘˜ê¹Œìš”? ì§ì ‘ ì„¤ê³„í•´ ë³´ì„¸ìš”!</p>
    </header>

    <aside class="controls">
        <h3>ğŸ› ï¸ ì‹¤í—˜ ì„¤ê³„</h3>
        
        <div class="control-group">
            <label for="material">1. ë‹¨ì—´ì¬ ì¢…ë¥˜ (ì „ë„ ì°¨ë‹¨)</label>
            <select id="material">
                <option value="none">ì—†ìŒ (ë‹¨ì—´ì¬ ì—†ìŒ)</option>
                <option value="cotton">ì†œ (ê³µê¸°ì¸µ ë§ìŒ)</option>
                <option value="styrofoam">ìŠ¤í‹°ë¡œí¼ (ê³µê¸°ì¸µ ë§¤ìš° ë§ìŒ)</option>
                <option value="foil">ì•Œë£¨ë¯¸ëŠ„ í˜¸ì¼ (ë³µì‚¬ ì°¨ë‹¨)</option>
                <option value="newspaper">ì‹ ë¬¸ì§€</option>
            </select>
        </div>

        <div class="control-group">
            <label for="thickness">2. ë‹¨ì—´ì¬ ë‘ê»˜: <span id="thickVal">1</span>cm</label>
            <input type="range" id="thickness" min="0" max="5" value="1" step="1">
        </div>

        <div class="control-group">
            <label>3. ëšœê»‘ ìœ ë¬´ (ëŒ€ë¥˜ ì°¨ë‹¨)</label>
            <div style="display: flex; gap: 10px;">
                <input type="checkbox" id="hasLid"> <label for="hasLid" style="display:inline;">ëšœê»‘ ë®ê¸°</label>
            </div>
        </div>

        <div class="control-group">
            <label for="initTemp">4. ì´ˆê¸° ë¬¼ ì˜¨ë„</label>
            <select id="initTemp">
                <option value="60">60â„ƒ (ë”°ëœ»í•¨)</option>
                <option value="80" selected>80â„ƒ (ëœ¨ê±°ì›€)</option>
                <option value="100">100â„ƒ (ë“ëŠ” ë¬¼)</option>
            </select>
        </div>

        <button onclick="startExperiment()">ğŸ”¥ ì‹¤í—˜ ì‹œì‘</button>
        <button class="reset" onclick="resetExperiment()">ğŸ”„ ì´ˆê¸°í™”</button>

        <div class="status-board">
            <strong>í˜„ì¬ ì˜¨ë„:</strong> <span id="currentTempDisplay">--</span>â„ƒ<br>
            <strong>ê²½ê³¼ ì‹œê°„:</strong> <span id="timeDisplay">0</span>ë¶„
        </div>
    </aside>

    <main class="simulation-area">
        <div class="visual-display">
            <div class="cup-container">
                <div class="heat-arrows" id="heatVisual">â™¨ï¸</div>
                <div class="lid" id="lidVisual"></div>
                <div class="cup-inner" id="waterVisual"></div>
                <div class="insulation-layer" id="insulationVisual"></div>
            </div>
            <div style="position: absolute; right: 20px; top: 20px; width: 150px; font-size: 0.8rem; color: #555;">
                <p>ğŸ’¡ <strong>ì‹œê°í™” ê°€ì´ë“œ</strong></p>
                <ul style="padding-left: 20px; margin: 0;">
                    <li>ë¹¨ê°„ìƒ‰: ëœ¨ê±°ì›€</li>
                    <li>íŒŒë€ìƒ‰: ì°¨ê°€ì›€</li>
                    <li>â™¨ï¸: ì—´ ì†ì‹¤(ëŒ€ë¥˜/ì¦ë°œ)</li>
                    <li>í…Œë‘ë¦¬: ë‹¨ì—´ì¬ ë‘ê»˜</li>
                </ul>
            </div>
        </div>

        <div class="graph-container">
            <canvas id="tempChart"></canvas>
        </div>
    </main>
</div>

<script>
    // ë³€ìˆ˜ ì„ ì–¸
    let chart;
    let timer;
    let time = 0;
    let currentTemp;
    let isRunning = false;
    
    // í™˜ê²½ ì˜¨ë„
    const ROOM_TEMP = 20;

    // ë‹¨ì—´ì¬ë³„ ì—´ì „ë„ìœ¨ íŒ©í„° (ë‚®ì„ìˆ˜ë¡ ë‹¨ì—´ ì˜ë¨)
    // 1.0 = ê¸°ì¤€(ì—†ìŒ), ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ
    const materials = {
        'none': { k: 1.0, color: 'transparent', name: 'ì—†ìŒ' },
        'cotton': { k: 0.4, color: '#f0f0f0', name: 'ì†œ' }, // ì „ë„ ì–µì œ
        'styrofoam': { k: 0.2, color: '#e3f2fd', name: 'ìŠ¤í‹°ë¡œí¼' }, // ì „ë„ ë§¤ìš° ì–µì œ
        'foil': { k: 0.7, color: '#d7ccc8', name: 'í˜¸ì¼' }, // ì „ë„ëŠ” ì˜ ë˜ì§€ë§Œ ë³µì‚¬ ì°¨ë‹¨(ì—¬ê¸°ì„  ë‹¨ìˆœ ëª¨ë¸ë§)
        'newspaper': { k: 0.5, color: '#fff3e0', name: 'ì‹ ë¬¸ì§€' }
    };

    // ì´ˆê¸°í™”
    window.onload = function() {
        initChart();
        updateVisuals();
    };

    // ì…ë ¥ê°’ ë³€ê²½ ì‹œ ì‹œê°í™” ì—…ë°ì´íŠ¸
    document.getElementById('material').addEventListener('change', updateVisuals);
    document.getElementById('thickness').addEventListener('input', function() {
        document.getElementById('thickVal').innerText = this.value;
        updateVisuals();
    });
    document.getElementById('hasLid').addEventListener('change', updateVisuals);
    document.getElementById('initTemp').addEventListener('change', function() {
        document.getElementById('currentTempDisplay').innerText = this.value;
    });

    function updateVisuals() {
        const mat = document.getElementById('material').value;
        const thick = document.getElementById('thickness').value;
        const hasLid = document.getElementById('hasLid').checked;

        const insulationDiv = document.getElementById('insulationVisual');
        const lidDiv = document.getElementById('lidVisual');

        // ë‹¨ì—´ì¬ ìŠ¤íƒ€ì¼
        insulationDiv.style.backgroundColor = materials[mat].color;
        if(mat === 'none') {
            insulationDiv.style.border = 'none';
        } else {
            insulationDiv.style.border = '2px dashed #999';
        }

        // ë‘ê»˜ ì‹œê°í™” (íŒ¨ë”©ìœ¼ë¡œ í‘œí˜„)
        const padding = mat === 'none' ? 0 : (thick * 4); 
        insulationDiv.style.padding = `${padding}px`;
        insulationDiv.style.left = `-${padding}px`;
        insulationDiv.style.bottom = `-${padding}px`;
        insulationDiv.style.width = `calc(100% + ${padding*2}px)`;

        // ëšœê»‘ ì‹œê°í™”
        lidDiv.style.display = hasLid ? 'block' : 'none';
    }

    function initChart() {
        const ctx = document.getElementById('tempChart').getContext('2d');
        chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: 'ì˜¨ë„ ë³€í™” (â„ƒ)',
                    borderColor: '#ff5722',
                    backgroundColor: 'rgba(255, 87, 34, 0.2)',
                    data: [],
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { title: { display: true, text: 'ì‹œê°„ (ë¶„)' } },
                    y: { title: { display: true, text: 'ì˜¨ë„ (â„ƒ)' }, min: 0, max: 100 }
                },
                animation: { duration: 0 }
            }
        });
    }

    function startExperiment() {
        if (isRunning) return;
        isRunning = true;
        
        // ì´ˆê¸°ê°’ ì„¤ì •
        const initTemp = parseFloat(document.getElementById('initTemp').value);
        currentTemp = initTemp;
        time = 0;
        
        // ì°¨íŠ¸ ì´ˆê¸°í™”
        chart.data.labels = [0];
        chart.data.datasets[0].data = [initTemp];
        chart.update();

        // ì‹œë®¬ë ˆì´ì…˜ ë£¨í”„
        timer = setInterval(simulateStep, 500); // 0.5ì´ˆë§ˆë‹¤ 1ë¶„ ê²½ê³¼ë¡œ ê°€ì •
    }

    function simulateStep() {
        if (time >= 20) { // 20ë¶„ê°„ ì‹¤í—˜
            stopExperiment();
            analyzeResult();
            return;
        }

        time++;
        
        // ë¬¼ë¦¬ ì—”ì§„ (ë‰´í„´ì˜ ëƒ‰ê° ë²•ì¹™ ë‹¨ìˆœí™”)
        // Rate = k * (T_curr - T_env)
        
        const matType = document.getElementById('material').value;
        const thickness = parseFloat(document.getElementById('thickness').value);
        const hasLid = document.getElementById('hasLid').checked;

        let k_base = 0.15; // ê¸°ë³¸ ëƒ‰ê° ìƒìˆ˜
        
        // 1. ì¬ë£Œ íŒ©í„°
        let k_mat = materials[matType].k;
        
        // 2. ë‘ê»˜ íŒ©í„° (ë‘êº¼ìš¸ìˆ˜ë¡ ëƒ‰ê° ì†ë„ ê°ì†Œ, ë‹¨ ì¬ë£Œê°€ ì—†ì„ ë• íš¨ê³¼ ì—†ìŒ)
        let k_thick = (matType === 'none') ? 1 : (1 / (1 + thickness * 0.5));

        // 3. ëšœê»‘ íŒ©í„° (ëŒ€ë¥˜/ì¦ë°œì— ê°€ì¥ í° ì˜í–¥)
        let k_lid = hasLid ? 0.3 : 1.0; 

        // ì¢…í•© ëƒ‰ê° ìƒìˆ˜
        let k_total = k_base * k_mat * k_thick * k_lid;

        // ì˜¨ë„ ê³„ì‚°
        let tempDiff = currentTemp - ROOM_TEMP;
        let tempDrop = tempDiff * k_total;
        currentTemp -= tempDrop;

        // UI ì—…ë°ì´íŠ¸
        document.getElementById('timeDisplay').innerText = time;
        document.getElementById('currentTempDisplay').innerText = currentTemp.toFixed(1);
        
        // ë¬¼ ìƒ‰ìƒ ë³€ê²½ (ì˜¨ë„ì— ë”°ë¼)
        const redIntensity = Math.max(0, Math.min(255, (currentTemp - 20) * 3));
        document.getElementById('waterVisual').style.background = `linear-gradient(to top, rgb(${redIntensity}, 50, 50), rgb(255, 100, 100))`;

        // ì—´ê¸° ì• ë‹ˆë©”ì´ì…˜ (ì˜¨ë„ê°€ ë†’ê³  ëšœê»‘ì´ ì—†ìœ¼ë©´ í™œë°œ)
        const heatVisual = document.getElementById('heatVisual');
        if (!hasLid && currentTemp > 40) {
            heatVisual.style.opacity = 1;
            heatVisual.style.animationDuration = `${2000 / (currentTemp)}s`; // ì˜¨ë„ê°€ ë†’ìœ¼ë©´ ë¹¨ë¦¬ ì›€ì§ì„
        } else {
            heatVisual.style.opacity = 0;
        }

        // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
        chart.data.labels.push(time);
        chart.data.datasets[0].data.push(currentTemp);
        chart.update();
    }

    function stopExperiment() {
        clearInterval(timer);
        isRunning = false;
        document.getElementById('heatVisual').style.opacity = 0;
    }

    function resetExperiment() {
        stopExperiment();
        time = 0;
        document.getElementById('timeDisplay').innerText = '0';
        document.getElementById('currentTempDisplay').innerText = '--';
        chart.data.labels = [];
        chart.data.datasets[0].data = [];
        chart.update();
    }

    function analyzeResult() {
        const finalTemp = chart.data.datasets[0].data[chart.data.datasets[0].data.length - 1];
        const hasLid = document.getElementById('hasLid').checked;
        const matType = document.getElementById('material').value;

        let feedback = "";
        
        if (finalTemp > 65) {
            feedback = "ğŸ† ëŒ€ë‹¨í•´ìš”! ì™„ë²½í•œ ë‹¨ì—´ ì„¤ê³„ë¥¼ í•˜ì…¨êµ°ìš”. ì—´ì´ ê±°ì˜ ë¹ ì ¸ë‚˜ê°€ì§€ ëª»í–ˆì–´ìš”.";
        } else if (finalTemp > 45) {
            feedback = "ğŸ‘ ì¢‹ì€ ì‹œë„ì…ë‹ˆë‹¤! í•˜ì§€ë§Œ ì¡°ê¸ˆ ë” ì—´ì„ ì˜ ê°€ë‘˜ ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ìˆì„ ê±°ì˜ˆìš”.";
        } else {
            feedback = "ì•—, ë¬¼ì´ ê¸ˆë°© ì‹ì–´ë²„ë ¸ë„¤ìš”. ğŸŒ¡ï¸ ì—´ì´ ì–´ë””ë¡œ ê°€ì¥ ë§ì´ ë„ë§ê°”ì„ê¹Œìš”?";
        }

        // êµ¬ì²´ì ì¸ í”¼ë“œë°± ì¶”ê°€
        if (!hasLid) {
            feedback += "\nğŸ’¡ íŒ: ëšœê»‘ì´ ì—†ìœ¼ë©´ ëœ¨ê±°ìš´ ê³µê¸°ê°€ ìœ„ë¡œ ë‚ ì•„ê°€ ë²„ë ¤ìš”(ëŒ€ë¥˜). ëšœê»‘ì„ ë®ì–´ë³´ì„¸ìš”!";
        } else if (matType === 'none' || matType === 'foil') {
            feedback += "\nğŸ’¡ íŒ: ì»µì˜ ë²½ì„ í†µí•´ ì—´ì´ ì§ì ‘ ì „ë‹¬ë˜ëŠ” ê²ƒ(ì „ë„)ì„ ë§‰ìœ¼ë ¤ë©´ ê³µê¸°ì¸µì´ ë§ì€ ì¬ë£Œ(ìŠ¤í‹°ë¡œí¼, ì†œ)ë¥¼ ì‚¬ìš©í•´ë³´ì„¸ìš”.";
        }

        alert(`ì‹¤í—˜ ì¢…ë£Œ! \nìµœì¢… ì˜¨ë„: ${finalTemp.toFixed(1)}â„ƒ\n\n[ë¶„ì„ ê²°ê³¼]\n${feedback}`);
    }
</script>
</body>
</html>