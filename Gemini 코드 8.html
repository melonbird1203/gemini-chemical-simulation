<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°€ìƒ ì‹¤í—˜ì‹¤: ê¸°ì²´ì˜ ì••ë ¥ê³¼ ë¶€í”¼ (ë³´ì¼ì˜ ë²•ì¹™)</title>
    <style>
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #50e3c2;
            --bg-color: #f4f7f6;
            --text-color: #333;
            --danger-color: #ff6b6b;
        }
        body {
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1 { margin-bottom: 10px; color: #2c3e50; }
        .experiment-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            max-width: 1200px;
            width: 100%;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        /* ì™¼ìª½: ì»¨íŠ¸ë¡¤ ë° ì‹œë®¬ë ˆì´ì…˜ */
        .simulation-panel {
            flex: 1;
            min-width: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .canvas-wrapper {
            position: relative;
            border: 2px solid #ccc;
            border-radius: 10px;
            background: #fff;
            margin-bottom: 20px;
            overflow: hidden;
        }
        canvas { display: block; }
        
        .controls {
            width: 100%;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
        }
        .slider-group { margin-bottom: 15px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; }
        input[type=range] { width: 100%; cursor: pointer; }
        .value-display { font-size: 1.2rem; color: var(--primary-color); font-weight: bold; }
        
        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s;
            margin: 5px;
        }
        button:hover { background-color: #357abd; }
        button.reset { background-color: var(--danger-color); }
        
        /* ì˜¤ë¥¸ìª½: ë°ì´í„° ë° ê·¸ë˜í”„ */
        .data-panel {
            flex: 1;
            min-width: 300px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .graph-area {
            height: 250px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: white;
            position: relative;
            padding: 10px;
        }
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }
        .data-table th, .data-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        .data-table th { background-color: #f1f1f1; }

        /* í€´ì¦ˆ ë° ê°€ì´ë“œ ëª¨ë‹¬ */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            text-align: center;
            position: relative;
        }
        .close-btn {
            position: absolute; top: 10px; right: 15px;
            font-size: 24px; cursor: pointer;
        }
        .quiz-feedback { margin-top: 15px; font-weight: bold; }
        
        .info-box {
            margin-top: 20px;
            padding: 15px;
            background-color: #e8f4fd;
            border-left: 5px solid var(--primary-color);
            border-radius: 5px;
            font-size: 0.95rem;
        }
        
        /* Safety Note */
        .safety-note {
            font-size: 0.8rem; color: #777; margin-top: 10px; text-align: center;
        }
    </style>
</head>
<body>

    <h1>âš—ï¸ ê°€ìƒ ì‹¤í—˜: ì••ë ¥ê³¼ ê¸°ì²´ì˜ ë¶€í”¼ (ë³´ì¼ì˜ ë²•ì¹™)</h1>
    <p>í”¼ìŠ¤í†¤ì„ ëˆŒëŸ¬ ì••ë ¥ì„ ë³€í™”ì‹œí‚¤ë©° <b>ì…ìì˜ ì›€ì§ì„</b>ê³¼ <b>ë¶€í”¼ ë³€í™”</b>ë¥¼ ê´€ì°°í•´ë³´ì„¸ìš”.</p>

    <div class="experiment-container">
        <div class="simulation-panel">
            <div class="canvas-wrapper">
                <canvas id="simCanvas" width="400" height="400"></canvas>
            </div>
            
            <div class="controls">
                <div class="slider-group">
                    <label>ğŸ‘‡ ëˆ„ë¥´ëŠ” ì••ë ¥ (ê¸°ì••, atm)</label>
                    <input type="range" id="pressureSlider" min="0.5" max="3.0" step="0.1" value="1.0">
                    <div class="value-display">í˜„ì¬ ì••ë ¥: <span id="pressureVal">1.0</span> atm</div>
                </div>
                
                <div class="slider-group">
                    <label>ğŸ§ª ê¸°ì²´ ì¢…ë¥˜ (ì…ì ìƒ‰ìƒ)</label>
                    <select id="gasType" style="padding: 5px;">
                        <option value="oxygen">ì‚°ì†Œ (ë¹¨ê°•)</option>
                        <option value="nitrogen">ì§ˆì†Œ (íŒŒë‘)</option>
                        <option value="helium">í—¬ë¥¨ (ë³´ë¼)</option>
                    </select>
                </div>

                <button onclick="recordData()">ğŸ“ í˜„ì¬ ìƒíƒœ ê¸°ë¡</button>
                <button class="reset" onclick="resetExperiment()">ğŸ”„ ì‹¤í—˜ ì´ˆê¸°í™”</button>
                <button onclick="showQuiz()">â“ í€´ì¦ˆ í’€ê¸°</button>
                <button onclick="showRealLife()">ğŸŒ ì‹¤ìƒí™œ ì˜ˆì‹œ</button>
            </div>
            <div class="safety-note">â€» ì£¼ì˜: ì‹¤ì œ ì‹¤í—˜ì‹¤ì—ì„œ ì£¼ì‚¬ê¸° ì…êµ¬ë¥¼ ë§‰ê³  ë„ˆë¬´ ì„¸ê²Œ ëˆ„ë¥´ë©´ ìœ„í—˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
        </div>

        <div class="data-panel">
            <div class="graph-area" id="graphArea">
                <svg width="100%" height="100%" viewBox="0 0 300 200" style="overflow: visible;">
                    <line x1="30" y1="10" x2="30" y2="170" stroke="black" stroke-width="2"/>
                    <line x1="30" y1="170" x2="290" y2="170" stroke="black" stroke-width="2"/>
                    <text x="150" y="195" text-anchor="middle" font-size="12">ì••ë ¥ (P)</text>
                    <text x="10" y="100" text-anchor="middle" font-size="12" transform="rotate(-90 10,100)">ë¶€í”¼ (V)</text>
                    <path id="graphPath" d="" fill="none" stroke="var(--primary-color)" stroke-width="3"/>
                    <circle id="currentPoint" cx="0" cy="0" r="5" fill="red" display="none"/>
                </svg>
            </div>

            <div class="info-box">
                <b>ğŸ’¡ ê´€ì°° í¬ì¸íŠ¸:</b><br>
                1. ì••ë ¥ì´ ì»¤ì§€ë©´ ì…ì ì‚¬ì´ì˜ ê±°ë¦¬ê°€ ì–´ë–»ê²Œ ë³€í•˜ë‚˜ìš”?<br>
                2. ì…ìì˜ í¬ê¸°ë‚˜ ê°œìˆ˜ëŠ” ë³€í•˜ì§€ ì•ŠìŒì„ í™•ì¸í•˜ì„¸ìš”.
            </div>

            <table class="data-table">
                <thead>
                    <tr>
                        <th>ìˆœì„œ</th>
                        <th>ì••ë ¥ (P)</th>
                        <th>ë¶€í”¼ (V)</th>
                        <th>P Ã— V</th>
                    </tr>
                </thead>
                <tbody id="dataTableBody">
                    </tbody>
            </table>
        </div>
    </div>

    <div id="quizModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('quizModal')">&times;</span>
            <h3>ğŸ§  ê°œë… í™•ì¸ í€´ì¦ˆ</h3>
            <p>í˜„ì¬ ì••ë ¥ì´ 1ê¸°ì••ì¼ ë•Œ ë¶€í”¼ê°€ 10Lì…ë‹ˆë‹¤.<br>ì••ë ¥ì„ <b>2ê¸°ì••</b>ìœ¼ë¡œ ë†’ì´ë©´ ë¶€í”¼ëŠ” ì–¼ë§ˆê°€ ë ê¹Œìš”?</p>
            <div style="margin: 20px 0;">
                <button onclick="checkAnswer(5)">5L</button>
                <button onclick="checkAnswer(10)">10L</button>
                <button onclick="checkAnswer(20)">20L</button>
            </div>
            <div id="quizFeedback" class="quiz-feedback"></div>
        </div>
    </div>

    <div id="lifeModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('lifeModal')">&times;</span>
            <h3>ğŸŒ ì‹¤ìƒí™œ ì† ë³´ì¼ì˜ ë²•ì¹™</h3>
            <ul style="text-align: left; padding-left: 20px;">
                <li><b>ğŸ”ï¸ ì‚° ì •ìƒì˜ ê³¼ì ë´‰ì§€:</b> ë†’ì´ ì˜¬ë¼ê°€ë©´ ëŒ€ê¸°ì••ì´ ë‚®ì•„ì ¸ ë´‰ì§€ ì•ˆ ê¸°ì²´ ë¶€í”¼ê°€ ëŠ˜ì–´ë‚˜ ë¹µë¹µí•´ì§‘ë‹ˆë‹¤.</li>
                <li><b>ğŸ‘Ÿ ìš´ë™í™” ì—ì–´ì¿ ì…˜:</b> ë°œì„ ë””ëŒ ì••ë ¥ì„ ê°€í•˜ë©´ ê³µê¸° ì£¼ë¨¸ë‹ˆ ë¶€í”¼ê°€ ì¤„ì–´ë“¤ë©° ì¶©ê²©ì„ í¡ìˆ˜í•©ë‹ˆë‹¤.</li>
                <li><b>ğŸ«§ ì ìˆ˜ë¶€ì˜ ê³µê¸°ë°©ìš¸:</b> ë¬¼ ìœ„ë¡œ ì˜¬ë¼ì˜¬ìˆ˜ë¡ ìˆ˜ì••ì´ ë‚®ì•„ì ¸ ê³µê¸° ë°©ìš¸ì´ ì ì  ì»¤ì§‘ë‹ˆë‹¤.</li>
            </ul>
        </div>
    </div>

    <script>
        // --- ìƒìˆ˜ ë° ë³€ìˆ˜ ì„¤ì • ---
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        const pressureSlider = document.getElementById('pressureSlider');
        const pressureDisplay = document.getElementById('pressureVal');
        const dataTableBody = document.getElementById('dataTableBody');
        const graphPath = document.getElementById('graphPath');
        const currentPoint = document.getElementById('currentPoint');
        
        // ì‹œë®¬ë ˆì´ì…˜ ìƒíƒœ
        const K = 200; // PV ìƒìˆ˜ (ì„ì˜ê°’)
        let pressure = 1.0;
        let volume = K / pressure; // í”½ì…€ ë†’ì´ë¡œ í™˜ì‚°í•˜ì—¬ ì‚¬ìš©
        let particles = [];
        const numParticles = 40;
        let recordCount = 0;
        let particleColor = '#ff6b6b'; // ê¸°ë³¸ ì‚°ì†Œ(ë¹¨ê°•)

        // --- ì…ì í´ë˜ìŠ¤ ---
        class Particle {
            constructor() {
                this.r = 4; // ì…ì ë°˜ì§€ë¦„
                this.reset();
            }
            
            reset() {
                this.x = Math.random() * (canvas.width - 20) + 10;
                this.y = Math.random() * (volume - 20) + (canvas.height - volume + 10);
                this.vx = (Math.random() - 0.5) * 4; // ì†ë„ëŠ” ì˜¨ë„(ì¼ì •)
                this.vy = (Math.random() - 0.5) * 4;
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;

                // ë²½ ì¶©ëŒ (ì¢Œìš°)
                if (this.x - this.r < 0 || this.x + this.r > canvas.width) {
                    this.vx *= -1;
                    this.x = Math.max(this.r, Math.min(canvas.width - this.r, this.x));
                }

                // ë²½ ì¶©ëŒ (ìƒí•˜ - í”¼ìŠ¤í†¤ ë†’ì´ ê³ ë ¤)
                const containerTop = canvas.height - volume;
                const containerBottom = canvas.height;

                if (this.y - this.r < containerTop) {
                    this.vy = Math.abs(this.vy); // ì•„ë˜ë¡œ íŠ•ê¹€
                    this.y = containerTop + this.r;
                } else if (this.y + this.r > containerBottom) {
                    this.vy = -Math.abs(this.vy); // ìœ„ë¡œ íŠ•ê¹€
                    this.y = containerBottom - this.r;
                }
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.r, 0, Math.PI * 2);
                ctx.fillStyle = particleColor;
                ctx.fill();
                ctx.closePath();
            }
        }

        // --- ì´ˆê¸°í™” ---
        function init() {
            particles = [];
            for (let i = 0; i < numParticles; i++) {
                particles.push(new Particle());
            }
            updateSimulation();
            loop();
        }

        // --- ë©”ì¸ ë£¨í”„ ---
        function loop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // 1. ìš©ê¸°(í”¼ìŠ¤í†¤) ê·¸ë¦¬ê¸°
            const containerTop = canvas.height - volume;
            
            // ì‹¤ë¦°ë” ë‚´ë¶€ ë°°ê²½
            ctx.fillStyle = '#f0f8ff';
            ctx.fillRect(0, containerTop, canvas.width, volume);
            
            // í”¼ìŠ¤í†¤ í—¤ë“œ
            ctx.fillStyle = '#bdc3c7';
            ctx.fillRect(0, containerTop - 20, canvas.width, 20);
            
            // í”¼ìŠ¤í†¤ ì†ì¡ì´
            ctx.fillStyle = '#7f8c8d';
            ctx.fillRect(canvas.width/2 - 10, containerTop - 100, 20, 80);
            ctx.fillRect(canvas.width/2 - 40, containerTop - 100, 80, 10);
            
            // ëˆ„ë¥´ëŠ” ì¶” (ì••ë ¥ ì‹œê°í™”)
            const weights = Math.round(pressure * 2); // 0.5atm ë‹¹ ì¶” 1ê°œ ëŠë‚Œ
            for(let i=0; i<weights; i++) {
                ctx.fillStyle = '#34495e';
                ctx.fillRect(canvas.width/2 - 30, containerTop - 20 - (i+1)*15, 60, 10);
            }

            // 2. ì…ì ê·¸ë¦¬ê¸°
            particles.forEach(p => {
                p.update();
                p.draw();
            });

            // 3. ê·¸ë˜í”„ ì—…ë°ì´íŠ¸
            updateGraphPoint();

            requestAnimationFrame(loop);
        }

        // --- ì´ë²¤íŠ¸ ë° ë¡œì§ ---
        pressureSlider.addEventListener('input', (e) => {
            pressure = parseFloat(e.target.value);
            pressureDisplay.innerText = pressure.toFixed(1);
            
            // ë³´ì¼ì˜ ë²•ì¹™: P * V = K  => V = K / P
            // ì‹œê°ì  ë¶€í”¼ ê³„ì‚° (í™”ë©´ ë¹„ìœ¨ì— ë§ì¶¤)
            // Kê°€ 200ì¼ë•Œ P=1ì´ë©´ V=200í”½ì…€. P=2ì´ë©´ V=100í”½ì…€.
            // ì‹¤ì œ ìˆ˜ì¹˜(L)ì™€ ì‹œê°ì  í”½ì…€ì„ ë§¤í•‘
            volume = (K / pressure) * 1.5; // 1.5ëŠ” í™”ë©´ í¬ê¸° ë³´ì • ê³„ìˆ˜
            
            // ë„ˆë¬´ ì‘ê±°ë‚˜ ì»¤ì§€ì§€ ì•Šê²Œ ì œí•œ
            volume = Math.max(50, Math.min(350, volume));
            
            // ì…ìê°€ ê°‘ìê¸° íŠ€ì–´ë‚˜ê°€ì§€ ì•Šê²Œ ìœ„ì¹˜ ì¡°ì •
            const containerTop = canvas.height - volume;
            particles.forEach(p => {
                if (p.y < containerTop) p.y = containerTop + 10;
            });
        });

        document.getElementById('gasType').addEventListener('change', (e) => {
            const type = e.target.value;
            if(type === 'oxygen') particleColor = '#ff6b6b';
            else if(type === 'nitrogen') particleColor = '#4a90e2';
            else if(type === 'helium') particleColor = '#9b59b6';
        });

        function recordData() {
            recordCount++;
            const currentVolDisplay = (10 / pressure).toFixed(1); // 1ê¸°ì••ì¼ë•Œ 10L ê°€ì •
            const pvConstant = (pressure * currentVolDisplay).toFixed(1);
            
            const row = `<tr>
                <td>${recordCount}</td>
                <td>${pressure} atm</td>
                <td>${currentVolDisplay} L</td>
                <td>${pvConstant}</td>
            </tr>`;
            dataTableBody.innerHTML += row;
        }

        function resetExperiment() {
            pressure = 1.0;
            pressureSlider.value = 1.0;
            pressureDisplay.innerText = "1.0";
            volume = (K / pressure) * 1.5;
            dataTableBody.innerHTML = "";
            recordCount = 0;
            init();
        }

        // --- ê·¸ë˜í”„ ë¡œì§ (SVG) ---
        function updateGraphPoint() {
            // ê·¸ë˜í”„ ì¢Œí‘œ ë§¤í•‘ (30,170)ì´ ì›ì 
            // Xì¶•: ì••ë ¥ (0 ~ 3.5), Yì¶•: ë¶€í”¼ (0 ~ 25)
            const x = 30 + (pressure * 70); // 1atm -> 100px ìœ„ì¹˜
            const currentVolDisplay = 10 / pressure;
            const y = 170 - (currentVolDisplay * 6); // 10L -> 60px ë†’ì´
            
            currentPoint.setAttribute('cx', x);
            currentPoint.setAttribute('cy', y);
            currentPoint.style.display = 'block';

            // ì´ë¡ ì  ê³¡ì„  ê·¸ë¦¬ê¸° (ìµœì´ˆ 1íšŒ í˜¹ì€ ê³„ì†)
            // P * V = 10 ê³¡ì„ 
            let d = "M ";
            for(let p = 0.5; p <= 3.0; p += 0.1) {
                const px = 30 + (p * 70);
                const vol = 10 / p;
                const py = 170 - (vol * 6);
                d += `${px},${py} `;
            }
            graphPath.setAttribute('d', d);
        }

        // --- ëª¨ë‹¬ ë¡œì§ ---
        function showQuiz() { document.getElementById('quizModal').style.display = 'flex'; }
        function showRealLife() { document.getElementById('lifeModal').style.display = 'flex'; }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; document.getElementById('quizFeedback').innerText = ""; }
        
        function checkAnswer(ans) {
            const feedback = document.getElementById('quizFeedback');
            if (ans === 5) {
                feedback.innerHTML = "<span style='color:green'>âœ… ì •ë‹µì…ë‹ˆë‹¤!</span><br>ì••ë ¥ì´ 2ë°°ê°€ ë˜ë©´ ë¶€í”¼ëŠ” 1/2ë°°ë¡œ ì¤„ì–´ë“­ë‹ˆë‹¤.";
            } else {
                feedback.innerHTML = "<span style='color:red'>âŒ ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”.</span><br>ì••ë ¥ì´ ì„¸ì§€ë©´ ì…ìë“¤ì´ ìˆì„ ê³µê°„ì´ ë” ì¢ì•„ì§€ê² ì£ ?";
            }
        }

        // ì‹œì‘
        init();
    </script>
</body>
</html>