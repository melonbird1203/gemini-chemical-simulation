<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°€ìƒ ì‹¤í—˜: í‘œë©´ ì¥ë ¥ ë¹„êµ</title>
    <style>
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #f5f6fa;
            --accent-color: #e74c3c;
            --text-color: #2c3e50;
        }
        body {
            font-family: 'Malgun Gothic', sans-serif;
            background-color: var(--secondary-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1 { color: var(--primary-color); }
        
        /* Layout */
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            max-width: 1200px;
            width: 100%;
            justify-content: center;
        }
        .lab-panel, .control-panel, .data-panel {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        /* Visualizer Area */
        .lab-panel {
            flex: 2;
            min-width: 300px;
            text-align: center;
            position: relative;
        }
        canvas {
            border-bottom: 5px solid #bdc3c7;
            background: radial-gradient(circle at center, #ffffff 0%, #f0f0f0 100%);
        }
        .molecule-view {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 120px;
            height: 120px;
            border: 2px solid var(--primary-color);
            border-radius: 50%;
            background: white;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: #7f8c8d;
        }
        
        /* Controls */
        .control-panel {
            flex: 1;
            min-width: 250px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        select, button {
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            font-size: 16px;
            cursor: pointer;
        }
        button.drop-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            font-weight: bold;
            font-size: 18px;
            transition: transform 0.1s;
        }
        button.drop-btn:active { transform: scale(0.95); }
        button.reset-btn { background-color: #95a5a6; color: white; border: none; }
        
        /* Data & Feedback */
        .data-panel {
            flex: 1;
            min-width: 250px;
        }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #bdc3c7; padding: 8px; text-align: center; }
        th { background-color: var(--primary-color); color: white; }
        
        .feedback-box {
            margin-top: 20px;
            padding: 15px;
            background-color: #fff3cd;
            border-left: 5px solid #ffc107;
            border-radius: 5px;
            display: none;
        }

        /* Animation Classes */
        .spilled { animation: shake 0.5s; }
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
    </style>
</head>
<body>

    <h1>ğŸ’§ í‘œë©´ ì¥ë ¥ ë¹„êµ ì‹¤í—˜ì‹¤</h1>
    <p>ìŠ¤í¬ì´íŠ¸ë¥¼ ëˆŒëŸ¬ ë™ì „ ìœ„ì— ì•¡ì²´ë¥¼ ë–¨ì–´ëœ¨ë¦¬ê³ , ì–¸ì œ ë„˜ì¹˜ëŠ”ì§€ ê´€ì°°í•´ë³´ì„¸ìš”.</p>

    <div class="container">
        <div class="lab-panel" id="labArea">
            <div class="molecule-view" id="moleculeView">
                <p>ë¶„ì ë³´ê¸°</p>
            </div>
            <canvas id="simCanvas" width="400" height="300"></canvas>
            <div id="dropCountDisplay" style="font-size: 24px; font-weight: bold; margin-top: 10px;">ë°©ìš¸ ìˆ˜: 0</div>
        </div>

        <div class="control-panel">
            <h3>ğŸ›ï¸ ì‹¤í—˜ ì„¤ì •</h3>
            <label for="liquidSelect">ì•¡ì²´ ì¢…ë¥˜ ì„ íƒ:</label>
            <select id="liquidSelect" onchange="resetExperiment()">
                <option value="water">ë¬¼ (Hâ‚‚O)</option>
                <option value="ethanol">ì—íƒ„ì˜¬ (Câ‚‚Hâ‚…OH)</option>
                <option value="glycerol">ê¸€ë¦¬ì„¸ë¡¤ (Câ‚ƒHâ‚ˆOâ‚ƒ)</option>
            </select>

            <button class="drop-btn" onclick="addDrop()">ğŸ’§ í•œ ë°©ìš¸ ë–¨ì–´ëœ¨ë¦¬ê¸°</button>
            <button class="reset-btn" onclick="resetExperiment()">ğŸ”„ ì´ˆê¸°í™”</button>
            
            <div style="margin-top: 20px;">
                <strong>í˜„ì¬ ìƒíƒœ:</strong> <span id="statusText">ì¤€ë¹„ë¨</span>
            </div>
        </div>

        <div class="data-panel">
            <h3>ğŸ“Š ì‹¤í—˜ ê²°ê³¼ ê¸°ë¡</h3>
            <table id="resultTable">
                <thead>
                    <tr>
                        <th>ì•¡ì²´</th>
                        <th>ì‹œë„</th>
                        <th>ìµœëŒ€ ë°©ìš¸ ìˆ˜</th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
            
            <div id="feedback" class="feedback-box">
                </div>
        </div>
    </div>

    <script>
        // --- ì„¤ì • ë° ë³€ìˆ˜ ---
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        const moleculeView = document.getElementById('moleculeView');
        
        let currentLiquid = 'water';
        let dropCount = 0;
        let isSpilled = false;
        let liquidProperties = {
            'water': { 
                name: 'ë¬¼', 
                color: 'rgba(52, 152, 219, 0.6)', 
                maxDropsBase: 45, // í‰ê· ì ìœ¼ë¡œ ë¬¼ì´ ê°€ì¥ ë§ì´ ìŒ“ì„
                variance: 5,
                tensionMsg: "ë†’ìŒ (ìˆ˜ì†Œê²°í•©)",
                moleculeImg: "â­•â­• (ê°•í•œ ê²°í•©)" 
            },
            'ethanol': { 
                name: 'ì—íƒ„ì˜¬', 
                color: 'rgba(231, 76, 60, 0.6)', 
                maxDropsBase: 20, // ë¬¼ë³´ë‹¤ í›¨ì”¬ ì ìŒ
                variance: 3,
                tensionMsg: "ë‚®ìŒ (ì•½í•œ ì¸ë ¥)",
                moleculeImg: "âšª (ì•½í•œ ê²°í•©)"
            },
            'glycerol': { 
                name: 'ê¸€ë¦¬ì„¸ë¡¤', 
                color: 'rgba(241, 196, 15, 0.6)', 
                maxDropsBase: 35, // ì ì„±ì´ ë†’ìœ¼ë‚˜ í‘œë©´ì¥ë ¥ì€ ë¬¼ë³´ë‹¤ ì•½ê°„ ë‚®ìŒ
                variance: 4,
                tensionMsg: "ì¤‘ê°„ (ì ì„± ë†’ìŒ)",
                moleculeImg: "â° (ë³µì¡í•œ êµ¬ì¡°)"
            }
        };

        let currentThreshold = 0;
        let experimentHistory = [];

        // --- ì´ˆê¸°í™” ë° ê·¸ë¦¬ê¸° í•¨ìˆ˜ ---
        function init() {
            resetExperiment();
            draw();
        }

        function resetExperiment() {
            currentLiquid = document.getElementById('liquidSelect').value;
            dropCount = 0;
            isSpilled = false;
            document.getElementById('dropCountDisplay').innerText = `ë°©ìš¸ ìˆ˜: ${dropCount}`;
            document.getElementById('statusText').innerText = "ì¤€ë¹„ë¨";
            document.getElementById('feedback').style.display = "none";
            document.getElementById('labArea').classList.remove('spilled');
            
            // ë¶„ì ë·° ì—…ë°ì´íŠ¸ (ê°„ë‹¨í•œ í…ìŠ¤íŠ¸/ì´ëª¨ì§€ ì‹œê°í™”)
            moleculeView.innerHTML = `<div style='text-align:center'>${liquidProperties[currentLiquid].moleculeImg}<br><small>${liquidProperties[currentLiquid].tensionMsg}</small></div>`;

            // ì„ê³„ê°’ ëœë¤ ì„¤ì • (ì‹¤ì œ ì‹¤í—˜ì²˜ëŸ¼ ë§¤ë²ˆ ì¡°ê¸ˆì”© ë‹¤ë¥´ê²Œ)
            const base = liquidProperties[currentLiquid].maxDropsBase;
            const vari = liquidProperties[currentLiquid].variance;
            currentThreshold = base + Math.floor(Math.random() * vari * 2) - vari;
            
            draw();
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // 1. ë™ì „ ê·¸ë¦¬ê¸° (íšŒìƒ‰ íƒ€ì›)
            ctx.beginPath();
            ctx.ellipse(200, 250, 100, 30, 0, 0, 2 * Math.PI);
            ctx.fillStyle = '#95a5a6';
            ctx.fill();
            ctx.strokeStyle = '#7f8c8d';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            // ë™ì „ ì˜†ë©´ (ì…ì²´ê°)
            ctx.beginPath();
            ctx.moveTo(100, 250);
            ctx.quadraticCurveTo(200, 280, 300, 250);
            ctx.lineTo(300, 260);
            ctx.quadraticCurveTo(200, 290, 100, 260);
            ctx.fillStyle = '#7f8c8d';
            ctx.fill();

            // 2. ì•¡ì²´ ë°©ìš¸ ê·¸ë¦¬ê¸°
            if (dropCount > 0) {
                const maxRadius = 90;
                // ë°©ìš¸ ìˆ˜ì— ë”°ë¼ ë†’ì´ì™€ í¼ì§ ì •ë„ ê³„ì‚°
                let progress = Math.min(dropCount / currentThreshold, 1.2); // 1.0 ë„˜ì–´ê°€ë©´ ë„˜ì¹¨
                
                if (isSpilled) {
                    drawSpilledLiquid();
                } else {
                    drawDome(progress);
                }
            }
        }

        function drawDome(progress) {
            ctx.beginPath();
            // ë² ì§€ì–´ ê³¡ì„ ìœ¼ë¡œ ë” í˜•íƒœ ê·¸ë¦¬ê¸°
            // progressê°€ ì»¤ì§ˆìˆ˜ë¡ ë†’ì´(control point Y)ê°€ ì˜¬ë¼ê°
            // ë¬¼ì€ ë™ê·¸ë—ê²Œ(ì ‘ì´‰ê° í¼), ì—íƒ„ì˜¬ì€ ë‚©ì‘í•˜ê²Œ í¼ì§(ì ‘ì´‰ê° ì‘ìŒ) ì‹œê°í™” ë¡œì§
            
            let spread = 80 + (progress * 20); // ì˜†ìœ¼ë¡œ í¼ì§
            let height = 30 + (progress * 100); // ìœ„ë¡œ ì†ŸìŒ (í‘œë©´ì¥ë ¥ ì‹œê°í™”)
            
            // ì•¡ì²´ íŠ¹ì„±ì— ë”°ë¥¸ ë†’ì´ ë³´ì • (ë¬¼ì€ ë” ë†’ê²Œ ìŒ“ì„)
            if (currentLiquid === 'ethanol') height *= 0.6; 

            ctx.moveTo(200 - spread, 250);
            // ì œì–´ì (Control Point)ì´ ìœ„ë¡œ ì˜¬ë¼ê°€ë©° ë³¼ë¡í•´ì§
            ctx.quadraticCurveTo(200, 250 - height, 200 + spread, 250);
            
            ctx.fillStyle = liquidProperties[currentLiquid].color;
            ctx.fill();
            
            // ê´‘íƒ íš¨ê³¼
            ctx.beginPath();
            ctx.ellipse(180, 250 - (height/2.5), 10, 5, -0.5, 0, 2*Math.PI);
            ctx.fillStyle = 'rgba(255,255,255,0.7)';
            ctx.fill();
        }

        function drawSpilledLiquid() {
            // ë„˜ì¹œ ëª¨ì–‘ (ë¶ˆê·œì¹™í•œ ì›…ë©ì´)
            ctx.beginPath();
            ctx.moveTo(90, 260);
            ctx.bezierCurveTo(50, 280, 150, 300, 200, 290);
            ctx.bezierCurveTo(250, 300, 350, 280, 310, 260);
            ctx.lineTo(300, 250);
            ctx.lineTo(100, 250);
            ctx.fillStyle = liquidProperties[currentLiquid].color;
            ctx.fill();
            
            // ë™ì „ ìœ„ ì”ì—¬ë¬¼
            ctx.beginPath();
            ctx.ellipse(200, 250, 90, 20, 0, 0, 2 * Math.PI);
            ctx.fillStyle = liquidProperties[currentLiquid].color;
            ctx.fill();
        }

        // --- ìƒí˜¸ì‘ìš© í•¨ìˆ˜ ---
        function addDrop() {
            if (isSpilled) return;

            dropCount++;
            document.getElementById('dropCountDisplay').innerText = `ë°©ìš¸ ìˆ˜: ${dropCount}`;
            document.getElementById('statusText').innerText = "ì‹¤í—˜ ì§„í–‰ ì¤‘...";

            // ì„ê³„ê°’ ì´ˆê³¼ ì²´í¬
            if (dropCount > currentThreshold) {
                spill();
            } else {
                draw();
            }
        }

        function spill() {
            isSpilled = true;
            document.getElementById('statusText').innerText = "âš ï¸ ì•¡ì²´ê°€ ë„˜ì³¤ìŠµë‹ˆë‹¤!";
            document.getElementById('labArea').classList.add('spilled');
            draw();
            recordResult();
            provideFeedback();
        }

        function recordResult() {
            const table = document.getElementById('resultTable').querySelector('tbody');
            const row = table.insertRow();
            const attemptNum = table.rows.length; // í˜„ì¬ í–‰ ê°œìˆ˜ = ì‹œë„ íšŸìˆ˜
            
            row.innerHTML = `
                <td>${liquidProperties[currentLiquid].name}</td>
                <td>${attemptNum}íšŒ</td>
                <td>${dropCount - 1}ë°©ìš¸</td>
            `; // ë„˜ì¹˜ê¸° ì§ì „ ê°œìˆ˜ê°€ ê¸°ë¡ë¨
        }

        function provideFeedback() {
            const fbBox = document.getElementById('feedback');
            fbBox.style.display = 'block';
            
            let msg = "";
            if (currentLiquid === 'water') {
                msg = `<strong>ğŸ’¡ ë¶„ì„:</strong> ë¬¼ì€ ë¶„ì ê°„ì— ê°•í•œ <strong>ìˆ˜ì†Œ ê²°í•©</strong>ì„ í•˜ê³  ìˆì–´ ì„œë¡œ ê½‰ ì¡ì•„ë‹¹ê¹ë‹ˆë‹¤. ì´ ë•Œë¬¸ì— í‘œë©´ ì¥ë ¥ì´ ë§¤ìš° ì»¤ì„œ ë™ì „ ìœ„ì— ë‘¥ê¸€ê²Œ ë§ì´ ìŒ“ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

[Image of hydrogen bonding in water]
`;
            } else if (currentLiquid === 'ethanol') {
                msg = `<strong>ğŸ’¡ ë¶„ì„:</strong> ì—íƒ„ì˜¬ì€ ë¬¼ë³´ë‹¤ ë¶„ì ê°„ ì¸ë ¥ì´ ì•½í•©ë‹ˆë‹¤. ì„œë¡œ ì¡ì•„ë‹¹ê¸°ëŠ” í˜ì´ ì•½í•´ í‘œë©´ì„ ìµœì†Œí™”í•˜ë ¤ëŠ” ì„±ì§ˆ(í‘œë©´ ì¥ë ¥)ì´ ì‘ì•„, ë¬¼ë³´ë‹¤ í›¨ì”¬ ë¹¨ë¦¬ ë¬´ë„ˆì ¸ ë‚´ë¦½ë‹ˆë‹¤.`;
            } else {
                msg = `<strong>ğŸ’¡ ë¶„ì„:</strong> ê¸€ë¦¬ì„¸ë¡¤ì€ ì ì„±ì´ í¬ê³  ë¶„ì ê°„ í˜ë„ ê°•í•˜ì§€ë§Œ, ë¬¼ë³´ë‹¤ëŠ” ì•½ê°„ ì ì€ ë°©ìš¸ ìˆ˜ë¥¼ ë³´ì…ë‹ˆë‹¤.`;
            }
            
            fbBox.innerHTML = msg;
        }

        // ì‹œì‘
        init();
    </script>
</body>
</html>